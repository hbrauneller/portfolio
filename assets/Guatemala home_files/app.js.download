/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */

//     Underscore.js 1.9.1
//     http://underscorejs.org
//     (c) 2009-2018 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */

!function(){var t,e,i;!function(o){function s(t,e){return w.call(t,e)}function n(t,e){var i,o,s,n,r,a,h,l,u,c,d,p,f=e&&e.split("/"),m=g.map,_=m&&m["*"]||{};if(t){for(t=t.split("/"),r=t.length-1,g.nodeIdCompat&&S.test(t[r])&&(t[r]=t[r].replace(S,"")),"."===t[0].charAt(0)&&f&&(p=f.slice(0,f.length-1),t=p.concat(t)),u=0;u<t.length;u++)if("."===(d=t[u]))t.splice(u,1),u-=1;else if(".."===d){if(0===u||1===u&&".."===t[2]||".."===t[u-1])continue;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}if((f||_)&&m){for(i=t.split("/"),u=i.length;u>0;u-=1){if(o=i.slice(0,u).join("/"),f)for(c=f.length;c>0;c-=1)if((s=m[f.slice(0,c).join("/")])&&(s=s[o])){n=s,a=u;break}if(n)break;!h&&_&&_[o]&&(h=_[o],l=u)}!n&&h&&(n=h,a=l),n&&(i.splice(0,a,n),t=i.join("/"))}return t}function r(t,e){return function(){var i=k.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),f.apply(o,i.concat([t,e]))}}function a(t){return function(e){return n(e,t)}}function h(t){return function(e){y[t]=e}}function l(t){if(s(v,t)){var e=v[t];delete v[t],b[t]=!0,p.apply(o,e)}if(!s(y,t)&&!s(b,t))throw new Error("No "+t);return y[t]}function u(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function c(t){return t?u(t):[]}function d(t){return function(){return g&&g.config&&g.config[t]||{}}}var p,f,m,_,y={},v={},g={},b={},w=Object.prototype.hasOwnProperty,k=[].slice,S=/\.js$/;m=function(t,e){var i,o=u(t),s=o[0],r=e[1];return t=o[1],s&&(s=n(s,r),i=l(s)),s?t=i&&i.normalize?i.normalize(t,a(r)):n(t,r):(t=n(t,r),o=u(t),s=o[0],t=o[1],s&&(i=l(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:i}},_={require:function(t){return r(t)},exports:function(t){var e=y[t];return void 0!==e?e:y[t]={}},module:function(t){return{id:t,uri:"",exports:y[t],config:d(t)}}},p=function(t,e,i,n){var a,u,d,p,f,g,w,k=[],S=typeof i;if(n=n||t,g=c(n),"undefined"===S||"function"===S){for(e=!e.length&&i.length?["require","exports","module"]:e,f=0;f<e.length;f+=1)if(p=m(e[f],g),"require"===(u=p.f))k[f]=_.require(t);else if("exports"===u)k[f]=_.exports(t),w=!0;else if("module"===u)a=k[f]=_.module(t);else if(s(y,u)||s(v,u)||s(b,u))k[f]=l(u);else{if(!p.p)throw new Error(t+" missing "+u);p.p.load(p.n,r(n,!0),h(u),{}),k[f]=y[u]}d=i?i.apply(y[t],k):void 0,t&&(a&&a.exports!==o&&a.exports!==y[t]?y[t]=a.exports:d===o&&w||(y[t]=d))}else t&&(y[t]=i)},t=e=f=function(t,e,i,s,n){if("string"==typeof t)return _[t]?_[t](e):l(m(t,c(e)).f);if(!t.splice){if(g=t,g.deps&&f(g.deps,g.callback),!e)return;e.splice?(t=e,e=i,i=null):t=o}return e=e||function(){},"function"==typeof i&&(i=s,s=n),s?p(o,t,e,i):setTimeout(function(){p(o,t,e,i)},4),f},f.config=function(t){return f(t)},t._defined=y,i=function(t,e,i){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(i=e,e=[]),s(y,t)||s(v,t)||(v[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("../bower_components/almond/almond",function(){}),function(){function t(t,e,i,o){this.name=t,this.entryType=e,this.startTime=i,this.duration=o}function e(t){for(var e,i={},o=[],s=0,n=a.length;s<n;s++)e=a[s],e.entryType!==t&&(i[e.name]=e,o.push(e));r=i,a=o}function i(t,e){window.performance[t]||("getEntries"===t&&(s=function(){return a}),window.performance[t]=e)}function o(t,i){if(void 0===i)e(t);else{for(var o,s=[],n=0;n<a.length;n++)o=a[n],o.name===i&&o.entryType===t||s.push(o);a=s,o=r[i],o&&o.entryType===t&&(r[i]=void 0)}}window.performance||(window.performance={});var s,n=(new Date).getTime(),r={},a=[],h={navigationStart:!0,unloadEventStart:!0,unloadEventEnd:!0,redirectStart:!0,redirectEnd:!0,fetchStart:!0,domainLookupStart:!0,domainLookupEnd:!0,connectStart:!0,connectEnd:!0,secureConnectionStart:!0,requestStart:!0,responseStart:!0,responseEnd:!0,domLoading:!0,domInteractive:!0,domContentLoadedEventStart:!0,domContentLoadedEventEnd:!0,domComplete:!0,loadEventStart:!0,loadEventEnd:!0};i("now",function(){return(new Date).getTime()-n}),i("mark",function(e){if(h[e])throw Error("'"+e+"' is part of the PerformanceTiming interface, and cannot be used as a mark name.");var i=new t(e,"mark",window.performance.now(),0);a.push(i),r[e]=i}),i("clearMarks",function(t){o("mark",t)}),i("measure",function(e,i,o){var s=void 0===i,n=void 0===o,h=window.performance.now(),l=0,u=0;if(s)l=0;else{if(!r[i])throw Error("The mark '"+i+"' does not exist.");l=r[i].startTime}if(n)u=h;else{if(!r[o])throw Error("The mark '"+o+"' does not exist.");u=r[o].startTime}var c=new t(e,"measure",h,u-l);a.push(c),r[e]=c}),i("clearMeasures",function(t){o("measure",t)}),i("getEntries",function(t){var e=s();if(void 0===t)return e;var i;return t.entryType?i=t.name?function(e){return e.entryType===t.entryType&&e.name===t.name}:function(e){return e.entryType===t.entryType}:t.name&&(i=function(e){return e.name===t.name}),e.filter(i)}),i("getEntriesByName",function(t,e){var i={name:t};return e&&(i.entryType=e),this.getEntries(i)}),i("getEntriesByType",function(t){return this.getEntries({entryType:t})})}(),i("polyfills/performance",function(){}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof i&&i.amd?i("moment/moment",e):t.moment=e()}(this,function(){"use strict";function t(){return Po.apply(null,arguments)}function i(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function o(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function s(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}function n(t){return void 0===t}function r(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function a(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function h(t,e){var i,o=[];for(i=0;i<t.length;++i)o.push(e(t[i],i));return o}function l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function u(t,e){for(var i in e)l(e,i)&&(t[i]=e[i]);return l(e,"toString")&&(t.toString=e.toString),l(e,"valueOf")&&(t.valueOf=e.valueOf),t}function c(t,e,i,o){return Me(t,e,i,o,!0).utc()}function d(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function p(t){return null==t._pf&&(t._pf=d()),t._pf}function f(t){if(null==t._isValid){var e=p(t),i=Eo.call(e.parsedDateParts,function(t){return null!=t}),o=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&i);if(t._strict&&(o=o&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return o;t._isValid=o}return t._isValid}function m(t){var e=c(NaN);return null!=t?u(p(e),t):p(e).userInvalidated=!0,e}function _(t,e){var i,o,s;if(n(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),n(e._i)||(t._i=e._i),n(e._f)||(t._f=e._f),n(e._l)||(t._l=e._l),n(e._strict)||(t._strict=e._strict),n(e._tzm)||(t._tzm=e._tzm),n(e._isUTC)||(t._isUTC=e._isUTC),n(e._offset)||(t._offset=e._offset),n(e._pf)||(t._pf=p(e)),n(e._locale)||(t._locale=e._locale),Ao.length>0)for(i=0;i<Ao.length;i++)o=Ao[i],s=e[o],n(s)||(t[o]=s);return t}function y(e){_(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Co&&(Co=!0,t.updateOffset(this),Co=!1)}function v(t){return t instanceof y||null!=t&&null!=t._isAMomentObject}function g(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function b(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=g(e)),i}function w(t,e,i){var o,s=Math.min(t.length,e.length),n=Math.abs(t.length-e.length),r=0;for(o=0;o<s;o++)(i&&t[o]!==e[o]||!i&&b(t[o])!==b(e[o]))&&r++;return r+n}function k(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function S(e,i){var o=!0;return u(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),o){for(var s,n=[],r=0;r<arguments.length;r++){if(s="","object"==typeof arguments[r]){s+="\n["+r+"] ";for(var a in arguments[0])s+=a+": "+arguments[0][a]+", ";s=s.slice(0,-2)}else s=arguments[r];n.push(s)}k(e+"\nArguments: "+Array.prototype.slice.call(n).join("")+"\n"+(new Error).stack),o=!1}return i.apply(this,arguments)},i)}function x(e,i){null!=t.deprecationHandler&&t.deprecationHandler(e,i),Yo[e]||(k(i),Yo[e]=!0)}function M(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function O(t){var e,i;for(i in t)e=t[i],M(e)?this[i]=e:this["_"+i]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function D(t,e){var i,s=u({},t);for(i in e)l(e,i)&&(o(t[i])&&o(e[i])?(s[i]={},u(s[i],t[i]),u(s[i],e[i])):null!=e[i]?s[i]=e[i]:delete s[i]);for(i in t)l(t,i)&&!l(e,i)&&o(t[i])&&(s[i]=u({},s[i]));return s}function T(t){null!=t&&this.set(t)}function L(t,e,i){var o=this._calendar[t]||this._calendar.sameElse;return M(o)?o.call(e,i):o}function j(t){var e=this._longDateFormat[t],i=this._longDateFormat[t.toUpperCase()];return e||!i?e:(this._longDateFormat[t]=i.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])}function P(){return this._invalidDate}function E(t){return this._ordinal.replace("%d",t)}function A(t,e,i,o){var s=this._relativeTime[i];return M(s)?s(t,e,i,o):s.replace(/%d/i,t)}function C(t,e){var i=this._relativeTime[t>0?"future":"past"];return M(i)?i(e):i.replace(/%s/i,e)}function Y(t,e){var i=t.toLowerCase();zo[i]=zo[i+"s"]=zo[e]=t}function F(t){return"string"==typeof t?zo[t]||zo[t.toLowerCase()]:void 0}function R(t){var e,i,o={};for(i in t)l(t,i)&&(e=F(i))&&(o[e]=t[i]);return o}function N(t,e){Wo[t]=e}function H(t){var e=[];for(var i in t)e.push({unit:i,priority:Wo[i]});return e.sort(function(t,e){return t.priority-e.priority}),e}function I(t,e,i){var o=""+Math.abs(t),s=e-o.length;return(t>=0?i?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+o}function z(t,e,i,o){var s=o;"string"==typeof o&&(s=function(){return this[o]()}),t&&(Go[t]=s),e&&(Go[e[0]]=function(){return I(s.apply(this,arguments),e[1],e[2])}),i&&(Go[i]=function(){return this.localeData().ordinal(s.apply(this,arguments),t)})}function W(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function U(t){var e,i,o=t.match(Uo);for(e=0,i=o.length;e<i;e++)Go[o[e]]?o[e]=Go[o[e]]:o[e]=W(o[e]);return function(e){var s,n="";for(s=0;s<i;s++)n+=M(o[s])?o[s].call(e,t):o[s];return n}}function q(t,e){return t.isValid()?(e=V(e,t.localeData()),Vo[e]=Vo[e]||U(e),Vo[e](t)):t.localeData().invalidDate()}function V(t,e){function i(t){return e.longDateFormat(t)||t}var o=5;for(qo.lastIndex=0;o>=0&&qo.test(t);)t=t.replace(qo,i),qo.lastIndex=0,o-=1;return t}function G(t,e,i){us[t]=M(e)?e:function(t,o){return t&&i?i:e}}function B(t,e){return l(us,t)?us[t](e._strict,e._locale):new RegExp(Z(t))}function Z(t){return X(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,o,s){return e||i||o||s}))}function X(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(t,e){var i,o=e;for("string"==typeof t&&(t=[t]),r(e)&&(o=function(t,i){i[e]=b(t)}),i=0;i<t.length;i++)cs[t[i]]=o}function $(t,e){Q(t,function(t,i,o,s){o._w=o._w||{},e(t,o._w,o,s)})}function K(t,e,i){null!=e&&l(cs,t)&&cs[t](e,i._a,i,t)}function J(t){return tt(t)?366:365}function tt(t){return t%4==0&&t%100!=0||t%400==0}function et(){return tt(this.year())}function it(e,i){return function(o){return null!=o?(st(this,e,o),t.updateOffset(this,i),this):ot(this,e)}}function ot(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function st(t,e,i){t.isValid()&&!isNaN(i)&&("FullYear"===e&&tt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](i,t.month(),ht(i,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](i))}function nt(t){return t=F(t),M(this[t])?this[t]():this}function rt(t,e){if("object"==typeof t){t=R(t);for(var i=H(t),o=0;o<i.length;o++)this[i[o].unit](t[i[o].unit])}else if(t=F(t),M(this[t]))return this[t](e);return this}function at(t,e){return(t%e+e)%e}function ht(t,e){if(isNaN(t)||isNaN(e))return NaN;var i=at(e,12);return t+=(e-i)/12,1===i?tt(t)?29:28:31-i%7%2}function lt(t,e){return t?i(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Ss).test(e)?"format":"standalone"][t.month()]:i(this._months)?this._months:this._months.standalone}function ut(t,e){return t?i(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Ss.test(e)?"format":"standalone"][t.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ct(t,e,i){var o,s,n,r=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],o=0;o<12;++o)n=c([2e3,o]),this._shortMonthsParse[o]=this.monthsShort(n,"").toLocaleLowerCase(),this._longMonthsParse[o]=this.months(n,"").toLocaleLowerCase();return i?"MMM"===e?(s=ws.call(this._shortMonthsParse,r),-1!==s?s:null):(s=ws.call(this._longMonthsParse,r),-1!==s?s:null):"MMM"===e?-1!==(s=ws.call(this._shortMonthsParse,r))?s:(s=ws.call(this._longMonthsParse,r),-1!==s?s:null):-1!==(s=ws.call(this._longMonthsParse,r))?s:(s=ws.call(this._shortMonthsParse,r),-1!==s?s:null)}function dt(t,e,i){var o,s,n;if(this._monthsParseExact)return ct.call(this,t,e,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++){if(s=c([2e3,o]),i&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),i||this._monthsParse[o]||(n="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[o]=new RegExp(n.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[o].test(t))return o;if(i&&"MMM"===e&&this._shortMonthsParse[o].test(t))return o;if(!i&&this._monthsParse[o].test(t))return o}}function pt(t,e){var i;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=b(e);else if(e=t.localeData().monthsParse(e),!r(e))return t;return i=Math.min(t.date(),ht(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t}function ft(e){return null!=e?(pt(this,e),t.updateOffset(this,!0),this):ot(this,"Month")}function mt(){return ht(this.year(),this.month())}function _t(t){return this._monthsParseExact?(l(this,"_monthsRegex")||vt.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=Os),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function yt(t){return this._monthsParseExact?(l(this,"_monthsRegex")||vt.call(this),t?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=Ds),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function vt(){function t(t,e){return e.length-t.length}var e,i,o=[],s=[],n=[];for(e=0;e<12;e++)i=c([2e3,e]),o.push(this.monthsShort(i,"")),s.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(o.sort(t),s.sort(t),n.sort(t),e=0;e<12;e++)o[e]=X(o[e]),s[e]=X(s[e]);for(e=0;e<24;e++)n[e]=X(n[e]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+o.join("|")+")","i")}function gt(t,e,i,o,s,n,r){var a;return t<100&&t>=0?(a=new Date(t+400,e,i,o,s,n,r),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,i,o,s,n,r),a}function bt(t){var e;if(t<100&&t>=0){var i=Array.prototype.slice.call(arguments);i[0]=t+400,e=new Date(Date.UTC.apply(null,i)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)}else e=new Date(Date.UTC.apply(null,arguments));return e}function wt(t,e,i){var o=7+e-i;return-(7+bt(t,0,o).getUTCDay()-e)%7+o-1}function kt(t,e,i,o,s){var n,r,a=(7+i-o)%7,h=wt(t,o,s),l=1+7*(e-1)+a+h;return l<=0?(n=t-1,r=J(n)+l):l>J(t)?(n=t+1,r=l-J(t)):(n=t,r=l),{year:n,dayOfYear:r}}function St(t,e,i){var o,s,n=wt(t.year(),e,i),r=Math.floor((t.dayOfYear()-n-1)/7)+1;return r<1?(s=t.year()-1,o=r+xt(s,e,i)):r>xt(t.year(),e,i)?(o=r-xt(t.year(),e,i),s=t.year()+1):(s=t.year(),o=r),{week:o,year:s}}function xt(t,e,i){var o=wt(t,e,i),s=wt(t+1,e,i);return(J(t)-o+s)/7}function Mt(t){return St(t,this._week.dow,this._week.doy).week}function Ot(){return this._week.dow}function Dt(){return this._week.doy}function Tt(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")}function Lt(t){var e=St(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")}function jt(t,e){return"string"!=typeof t?t:isNaN(t)?(t=e.weekdaysParse(t),"number"==typeof t?t:null):parseInt(t,10)}function Pt(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Et(t,e){return t.slice(e,7).concat(t.slice(0,e))}function At(t,e){var o=i(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?Et(o,this._week.dow):t?o[t.day()]:o}function Ct(t){return!0===t?Et(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Yt(t){return!0===t?Et(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Ft(t,e,i){var o,s,n,r=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],o=0;o<7;++o)n=c([2e3,1]).day(o),this._minWeekdaysParse[o]=this.weekdaysMin(n,"").toLocaleLowerCase(),this._shortWeekdaysParse[o]=this.weekdaysShort(n,"").toLocaleLowerCase(),this._weekdaysParse[o]=this.weekdays(n,"").toLocaleLowerCase();return i?"dddd"===e?(s=ws.call(this._weekdaysParse,r),-1!==s?s:null):"ddd"===e?(s=ws.call(this._shortWeekdaysParse,r),-1!==s?s:null):(s=ws.call(this._minWeekdaysParse,r),-1!==s?s:null):"dddd"===e?-1!==(s=ws.call(this._weekdaysParse,r))?s:-1!==(s=ws.call(this._shortWeekdaysParse,r))?s:(s=ws.call(this._minWeekdaysParse,r),-1!==s?s:null):"ddd"===e?-1!==(s=ws.call(this._shortWeekdaysParse,r))?s:-1!==(s=ws.call(this._weekdaysParse,r))?s:(s=ws.call(this._minWeekdaysParse,r),-1!==s?s:null):-1!==(s=ws.call(this._minWeekdaysParse,r))?s:-1!==(s=ws.call(this._weekdaysParse,r))?s:(s=ws.call(this._shortWeekdaysParse,r),-1!==s?s:null)}function Rt(t,e,i){var o,s,n;if(this._weekdaysParseExact)return Ft.call(this,t,e,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),o=0;o<7;o++){if(s=c([2e3,1]).day(o),i&&!this._fullWeekdaysParse[o]&&(this._fullWeekdaysParse[o]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[o]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[o]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[o]||(n="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[o]=new RegExp(n.replace(".",""),"i")),i&&"dddd"===e&&this._fullWeekdaysParse[o].test(t))return o;if(i&&"ddd"===e&&this._shortWeekdaysParse[o].test(t))return o;if(i&&"dd"===e&&this._minWeekdaysParse[o].test(t))return o;if(!i&&this._weekdaysParse[o].test(t))return o}}function Nt(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=jt(t,this.localeData()),this.add(t-e,"d")):e}function Ht(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")}function It(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=Pt(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7}function zt(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||qt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=Es),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Wt(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||qt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=As),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ut(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||qt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Cs),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function qt(){function t(t,e){return e.length-t.length}var e,i,o,s,n,r=[],a=[],h=[],l=[];for(e=0;e<7;e++)i=c([2e3,1]).day(e),o=this.weekdaysMin(i,""),s=this.weekdaysShort(i,""),n=this.weekdays(i,""),r.push(o),a.push(s),h.push(n),l.push(o),l.push(s),l.push(n);for(r.sort(t),a.sort(t),h.sort(t),l.sort(t),e=0;e<7;e++)a[e]=X(a[e]),h[e]=X(h[e]),l[e]=X(l[e]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Vt(){return this.hours()%12||12}function Gt(){return this.hours()||24}function Bt(t,e){z(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function Zt(t,e){return e._meridiemParse}function Xt(t){return"p"===(t+"").toLowerCase().charAt(0)}function Qt(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"}function $t(t){return t?t.toLowerCase().replace("_","-"):t}function Kt(t){for(var e,i,o,s,n=0;n<t.length;){for(s=$t(t[n]).split("-"),e=s.length,i=$t(t[n+1]),i=i?i.split("-"):null;e>0;){if(o=Jt(s.slice(0,e).join("-")))return o;if(i&&i.length>=e&&w(s,i,!0)>=e-1)break;e--}n++}return Ys}function Jt(t){var i=null;if(!Hs[t]&&"undefined"!=typeof module&&module&&module.exports)try{i=Ys._abbr;e("./locale/"+t),te(i)}catch(t){}return Hs[t]}function te(t,e){var i;return t&&(i=n(e)?oe(t):ee(t,e),i?Ys=i:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ys._abbr}function ee(t,e){if(null!==e){var i,o=Ns;if(e.abbr=t,null!=Hs[t])x("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=Hs[t]._config;else if(null!=e.parentLocale)if(null!=Hs[e.parentLocale])o=Hs[e.parentLocale]._config;else{if(null==(i=Jt(e.parentLocale)))return Is[e.parentLocale]||(Is[e.parentLocale]=[]),Is[e.parentLocale].push({name:t,config:e}),null;o=i._config}return Hs[t]=new T(D(o,e)),Is[t]&&Is[t].forEach(function(t){ee(t.name,t.config)}),te(t),Hs[t]}return delete Hs[t],null}function ie(t,e){if(null!=e){var i,o,s=Ns;o=Jt(t),null!=o&&(s=o._config),e=D(s,e),i=new T(e),i.parentLocale=Hs[t],Hs[t]=i,te(t)}else null!=Hs[t]&&(null!=Hs[t].parentLocale?Hs[t]=Hs[t].parentLocale:null!=Hs[t]&&delete Hs[t]);return Hs[t]}function oe(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ys;if(!i(t)){if(e=Jt(t))return e;t=[t]}return Kt(t)}function se(){return Fo(Hs)}function ne(t){var e,i=t._a;return i&&-2===p(t).overflow&&(e=i[ps]<0||i[ps]>11?ps:i[fs]<1||i[fs]>ht(i[ds],i[ps])?fs:i[ms]<0||i[ms]>24||24===i[ms]&&(0!==i[_s]||0!==i[ys]||0!==i[vs])?ms:i[_s]<0||i[_s]>59?_s:i[ys]<0||i[ys]>59?ys:i[vs]<0||i[vs]>999?vs:-1,p(t)._overflowDayOfYear&&(e<ds||e>fs)&&(e=fs),p(t)._overflowWeeks&&-1===e&&(e=gs),p(t)._overflowWeekday&&-1===e&&(e=bs),p(t).overflow=e),t}function re(t,e,i){return null!=t?t:null!=e?e:i}function ae(e){var i=new Date(t.now());return e._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function he(t){var e,i,o,s,n,r=[];if(!t._d){for(o=ae(t),t._w&&null==t._a[fs]&&null==t._a[ps]&&le(t),null!=t._dayOfYear&&(n=re(t._a[ds],o[ds]),(t._dayOfYear>J(n)||0===t._dayOfYear)&&(p(t)._overflowDayOfYear=!0),i=bt(n,0,t._dayOfYear),t._a[ps]=i.getUTCMonth(),t._a[fs]=i.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=r[e]=o[e];for(;e<7;e++)t._a[e]=r[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[ms]&&0===t._a[_s]&&0===t._a[ys]&&0===t._a[vs]&&(t._nextDay=!0,t._a[ms]=0),t._d=(t._useUTC?bt:gt).apply(null,r),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[ms]=24),t._w&&void 0!==t._w.d&&t._w.d!==s&&(p(t).weekdayMismatch=!0)}}function le(t){var e,i,o,s,n,r,a,h;if(e=t._w,null!=e.GG||null!=e.W||null!=e.E)n=1,r=4,i=re(e.GG,t._a[ds],St(Oe(),1,4).year),o=re(e.W,1),((s=re(e.E,1))<1||s>7)&&(h=!0);else{n=t._locale._week.dow,r=t._locale._week.doy;var l=St(Oe(),n,r);i=re(e.gg,t._a[ds],l.year),o=re(e.w,l.week),null!=e.d?((s=e.d)<0||s>6)&&(h=!0):null!=e.e?(s=e.e+n,(e.e<0||e.e>6)&&(h=!0)):s=n}o<1||o>xt(i,n,r)?p(t)._overflowWeeks=!0:null!=h?p(t)._overflowWeekday=!0:(a=kt(i,o,s,n,r),t._a[ds]=a.year,t._dayOfYear=a.dayOfYear)}function ue(t){var e,i,o,s,n,r,a=t._i,h=zs.exec(a)||Ws.exec(a);if(h){for(p(t).iso=!0,e=0,i=qs.length;e<i;e++)if(qs[e][1].exec(h[1])){s=qs[e][0],o=!1!==qs[e][2];break}if(null==s)return void(t._isValid=!1);if(h[3]){for(e=0,i=Vs.length;e<i;e++)if(Vs[e][1].exec(h[3])){n=(h[2]||" ")+Vs[e][0];break}if(null==n)return void(t._isValid=!1)}if(!o&&null!=n)return void(t._isValid=!1);if(h[4]){if(!Us.exec(h[4]))return void(t._isValid=!1);r="Z"}t._f=s+(n||"")+(r||""),ve(t)}else t._isValid=!1}function ce(t,e,i,o,s,n){var r=[de(t),Ms.indexOf(e),parseInt(i,10),parseInt(o,10),parseInt(s,10)];return n&&r.push(parseInt(n,10)),r}function de(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function pe(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function fe(t,e,i){if(t){if(js.indexOf(t)!==new Date(e[0],e[1],e[2]).getDay())return p(i).weekdayMismatch=!0,i._isValid=!1,!1}return!0}function me(t,e,i){if(t)return Zs[t];if(e)return 0;var o=parseInt(i,10),s=o%100;return(o-s)/100*60+s}function _e(t){var e=Bs.exec(pe(t._i));if(e){var i=ce(e[4],e[3],e[2],e[5],e[6],e[7]);if(!fe(e[1],i,t))return;t._a=i,t._tzm=me(e[8],e[9],e[10]),t._d=bt.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),p(t).rfc2822=!0}else t._isValid=!1}function ye(e){var i=Gs.exec(e._i);if(null!==i)return void(e._d=new Date(+i[1]));ue(e),!1===e._isValid&&(delete e._isValid,_e(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e)))}function ve(e){if(e._f===t.ISO_8601)return void ue(e);if(e._f===t.RFC_2822)return void _e(e);e._a=[],p(e).empty=!0;var i,o,s,n,r,a=""+e._i,h=a.length,l=0;for(s=V(e._f,e._locale).match(Uo)||[],i=0;i<s.length;i++)n=s[i],o=(a.match(B(n,e))||[])[0],o&&(r=a.substr(0,a.indexOf(o)),r.length>0&&p(e).unusedInput.push(r),a=a.slice(a.indexOf(o)+o.length),l+=o.length),Go[n]?(o?p(e).empty=!1:p(e).unusedTokens.push(n),K(n,o,e)):e._strict&&!o&&p(e).unusedTokens.push(n);p(e).charsLeftOver=h-l,a.length>0&&p(e).unusedInput.push(a),e._a[ms]<=12&&!0===p(e).bigHour&&e._a[ms]>0&&(p(e).bigHour=void 0),p(e).parsedDateParts=e._a.slice(0),p(e).meridiem=e._meridiem,e._a[ms]=ge(e._locale,e._a[ms],e._meridiem),he(e),ne(e)}function ge(t,e,i){var o;return null==i?e:null!=t.meridiemHour?t.meridiemHour(e,i):null!=t.isPM?(o=t.isPM(i),o&&e<12&&(e+=12),o||12!==e||(e=0),e):e}function be(t){var e,i,o,s,n;if(0===t._f.length)return p(t).invalidFormat=!0,void(t._d=new Date(NaN));for(s=0;s<t._f.length;s++)n=0,e=_({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[s],ve(e),f(e)&&(n+=p(e).charsLeftOver,n+=10*p(e).unusedTokens.length,p(e).score=n,(null==o||n<o)&&(o=n,i=e));u(t,i||e)}function we(t){if(!t._d){var e=R(t._i);t._a=h([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),he(t)}}function ke(t){var e=new y(ne(Se(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Se(t){var e=t._i,o=t._f;return t._locale=t._locale||oe(t._l),null===e||void 0===o&&""===e?m({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),v(e)?new y(ne(e)):(a(e)?t._d=e:i(o)?be(t):o?ve(t):xe(t),f(t)||(t._d=null),t))}function xe(e){var s=e._i;n(s)?e._d=new Date(t.now()):a(s)?e._d=new Date(s.valueOf()):"string"==typeof s?ye(e):i(s)?(e._a=h(s.slice(0),function(t){return parseInt(t,10)}),he(e)):o(s)?we(e):r(s)?e._d=new Date(s):t.createFromInputFallback(e)}function Me(t,e,n,r,a){var h={};return!0!==n&&!1!==n||(r=n,n=void 0),(o(t)&&s(t)||i(t)&&0===t.length)&&(t=void 0),h._isAMomentObject=!0,h._useUTC=h._isUTC=a,h._l=n,h._i=t,h._f=e,h._strict=r,ke(h)}function Oe(t,e,i,o){return Me(t,e,i,o,!1)}function De(t,e){var o,s;if(1===e.length&&i(e[0])&&(e=e[0]),!e.length)return Oe();for(o=e[0],s=1;s<e.length;++s)e[s].isValid()&&!e[s][t](o)||(o=e[s]);return o}function Te(){return De("isBefore",[].slice.call(arguments,0))}function Le(){return De("isAfter",[].slice.call(arguments,0))}function je(t){for(var e in t)if(-1===ws.call(Ks,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var i=!1,o=0;o<Ks.length;++o)if(t[Ks[o]]){if(i)return!1;parseFloat(t[Ks[o]])!==b(t[Ks[o]])&&(i=!0)}return!0}function Pe(){return this._isValid}function Ee(){return $e(NaN)}function Ae(t){var e=R(t),i=e.year||0,o=e.quarter||0,s=e.month||0,n=e.week||e.isoWeek||0,r=e.day||0,a=e.hour||0,h=e.minute||0,l=e.second||0,u=e.millisecond||0;this._isValid=je(e),this._milliseconds=+u+1e3*l+6e4*h+1e3*a*60*60,this._days=+r+7*n,this._months=+s+3*o+12*i,this._data={},this._locale=oe(),this._bubble()}function Ce(t){return t instanceof Ae}function Ye(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function Fe(t,e){z(t,0,0,function(){var t=this.utcOffset(),i="+";return t<0&&(t=-t,i="-"),i+I(~~(t/60),2)+e+I(~~t%60,2)})}function Re(t,e){var i=(e||"").match(t);if(null===i)return null;var o=i[i.length-1]||[],s=(o+"").match(Js)||["-",0,0],n=60*s[1]+b(s[2]);return 0===n?0:"+"===s[0]?n:-n}function Ne(e,i){var o,s;return i._isUTC?(o=i.clone(),s=(v(e)||a(e)?e.valueOf():Oe(e).valueOf())-o.valueOf(),o._d.setTime(o._d.valueOf()+s),t.updateOffset(o,!1),o):Oe(e).local()}function He(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Ie(e,i,o){var s,n=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Re(as,e)))return this}else Math.abs(e)<16&&!o&&(e*=60);return!this._isUTC&&i&&(s=He(this)),this._offset=e,this._isUTC=!0,null!=s&&this.add(s,"m"),n!==e&&(!i||this._changeInProgress?ii(this,$e(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?n:He(this)}function ze(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function We(t){return this.utcOffset(0,t)}function Ue(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(He(this),"m")),this}function qe(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=Re(rs,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Ve(t){return!!this.isValid()&&(t=t?Oe(t).utcOffset():0,(this.utcOffset()-t)%60==0)}function Ge(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Be(){if(!n(this._isDSTShifted))return this._isDSTShifted;var t={};if(_(t,this),t=Se(t),t._a){var e=t._isUTC?c(t._a):Oe(t._a);this._isDSTShifted=this.isValid()&&w(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ze(){return!!this.isValid()&&!this._isUTC}function Xe(){return!!this.isValid()&&this._isUTC}function Qe(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function $e(t,e){var i,o,s,n=t,a=null;return Ce(t)?n={
ms:t._milliseconds,d:t._days,M:t._months}:r(t)?(n={},e?n[e]=t:n.milliseconds=t):(a=tn.exec(t))?(i="-"===a[1]?-1:1,n={y:0,d:b(a[fs])*i,h:b(a[ms])*i,m:b(a[_s])*i,s:b(a[ys])*i,ms:b(Ye(1e3*a[vs]))*i}):(a=en.exec(t))?(i="-"===a[1]?-1:1,n={y:Ke(a[2],i),M:Ke(a[3],i),w:Ke(a[4],i),d:Ke(a[5],i),h:Ke(a[6],i),m:Ke(a[7],i),s:Ke(a[8],i)}):null==n?n={}:"object"==typeof n&&("from"in n||"to"in n)&&(s=ti(Oe(n.from),Oe(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Ae(n),Ce(t)&&l(t,"_locale")&&(o._locale=t._locale),o}function Ke(t,e){var i=t&&parseFloat(t.replace(",","."));return(isNaN(i)?0:i)*e}function Je(t,e){var i={};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function ti(t,e){var i;return t.isValid()&&e.isValid()?(e=Ne(e,t),t.isBefore(e)?i=Je(t,e):(i=Je(e,t),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function ei(t,e){return function(i,o){var s,n;return null===o||isNaN(+o)||(x(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=i,i=o,o=n),i="string"==typeof i?+i:i,s=$e(i,o),ii(this,s,t),this}}function ii(e,i,o,s){var n=i._milliseconds,r=Ye(i._days),a=Ye(i._months);e.isValid()&&(s=null==s||s,a&&pt(e,ot(e,"Month")+a*o),r&&st(e,"Date",ot(e,"Date")+r*o),n&&e._d.setTime(e._d.valueOf()+n*o),s&&t.updateOffset(e,r||a))}function oi(t,e){var i=t.diff(e,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function si(e,i){var o=e||Oe(),s=Ne(o,this).startOf("day"),n=t.calendarFormat(this,s)||"sameElse",r=i&&(M(i[n])?i[n].call(this,o):i[n]);return this.format(r||this.localeData().calendar(n,this,Oe(o)))}function ni(){return new y(this)}function ri(t,e){var i=v(t)?t:Oe(t);return!(!this.isValid()||!i.isValid())&&(e=F(e)||"millisecond","millisecond"===e?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(e).valueOf())}function ai(t,e){var i=v(t)?t:Oe(t);return!(!this.isValid()||!i.isValid())&&(e=F(e)||"millisecond","millisecond"===e?this.valueOf()<i.valueOf():this.clone().endOf(e).valueOf()<i.valueOf())}function hi(t,e,i,o){var s=v(t)?t:Oe(t),n=v(e)?e:Oe(e);return!!(this.isValid()&&s.isValid()&&n.isValid())&&(o=o||"()",("("===o[0]?this.isAfter(s,i):!this.isBefore(s,i))&&(")"===o[1]?this.isBefore(n,i):!this.isAfter(n,i)))}function li(t,e){var i,o=v(t)?t:Oe(t);return!(!this.isValid()||!o.isValid())&&(e=F(e)||"millisecond","millisecond"===e?this.valueOf()===o.valueOf():(i=o.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf()))}function ui(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function ci(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function di(t,e,i){var o,s,n;if(!this.isValid())return NaN;if(o=Ne(t,this),!o.isValid())return NaN;switch(s=6e4*(o.utcOffset()-this.utcOffset()),e=F(e)){case"year":n=pi(this,o)/12;break;case"month":n=pi(this,o);break;case"quarter":n=pi(this,o)/3;break;case"second":n=(this-o)/1e3;break;case"minute":n=(this-o)/6e4;break;case"hour":n=(this-o)/36e5;break;case"day":n=(this-o-s)/864e5;break;case"week":n=(this-o-s)/6048e5;break;default:n=this-o}return i?n:g(n)}function pi(t,e){var i,o,s=12*(e.year()-t.year())+(e.month()-t.month()),n=t.clone().add(s,"months");return e-n<0?(i=t.clone().add(s-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(s+1,"months"),o=(e-n)/(i-n)),-(s+o)||0}function fi(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function mi(t){if(!this.isValid())return null;var e=!0!==t,i=e?this.clone().utc():this;return i.year()<0||i.year()>9999?q(i,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):M(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",q(i,"Z")):q(i,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function _i(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var i="["+t+'("]',o=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s=e+'[")]';return this.format(i+o+"-MM-DD[T]HH:mm:ss.SSS"+s)}function yi(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var i=q(this,e);return this.localeData().postformat(i)}function vi(t,e){return this.isValid()&&(v(t)&&t.isValid()||Oe(t).isValid())?$e({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function gi(t){return this.from(Oe(),t)}function bi(t,e){return this.isValid()&&(v(t)&&t.isValid()||Oe(t).isValid())?$e({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function wi(t){return this.to(Oe(),t)}function ki(t){var e;return void 0===t?this._locale._abbr:(e=oe(t),null!=e&&(this._locale=e),this)}function Si(){return this._locale}function xi(t,e){return(t%e+e)%e}function Mi(t,e,i){return t<100&&t>=0?new Date(t+400,e,i)-ln:new Date(t,e,i).valueOf()}function Oi(t,e,i){return t<100&&t>=0?Date.UTC(t+400,e,i)-ln:Date.UTC(t,e,i)}function Di(e){var i;if(void 0===(e=F(e))||"millisecond"===e||!this.isValid())return this;var o=this._isUTC?Oi:Mi;switch(e){case"year":i=o(this.year(),0,1);break;case"quarter":i=o(this.year(),this.month()-this.month()%3,1);break;case"month":i=o(this.year(),this.month(),1);break;case"week":i=o(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":i=o(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":i=o(this.year(),this.month(),this.date());break;case"hour":i=this._d.valueOf(),i-=xi(i+(this._isUTC?0:this.utcOffset()*an),hn);break;case"minute":i=this._d.valueOf(),i-=xi(i,an);break;case"second":i=this._d.valueOf(),i-=xi(i,rn)}return this._d.setTime(i),t.updateOffset(this,!0),this}function Ti(e){var i;if(void 0===(e=F(e))||"millisecond"===e||!this.isValid())return this;var o=this._isUTC?Oi:Mi;switch(e){case"year":i=o(this.year()+1,0,1)-1;break;case"quarter":i=o(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":i=o(this.year(),this.month()+1,1)-1;break;case"week":i=o(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":i=o(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":i=o(this.year(),this.month(),this.date()+1)-1;break;case"hour":i=this._d.valueOf(),i+=hn-xi(i+(this._isUTC?0:this.utcOffset()*an),hn)-1;break;case"minute":i=this._d.valueOf(),i+=an-xi(i,an)-1;break;case"second":i=this._d.valueOf(),i+=rn-xi(i,rn)-1}return this._d.setTime(i),t.updateOffset(this,!0),this}function Li(){return this._d.valueOf()-6e4*(this._offset||0)}function ji(){return Math.floor(this.valueOf()/1e3)}function Pi(){return new Date(this.valueOf())}function Ei(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Ai(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Ci(){return this.isValid()?this.toISOString():null}function Yi(){return f(this)}function Fi(){return u({},p(this))}function Ri(){return p(this).overflow}function Ni(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Hi(t,e){z(0,[t,t.length],0,e)}function Ii(t){return qi.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function zi(t){return qi.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Wi(){return xt(this.year(),1,4)}function Ui(){var t=this.localeData()._week;return xt(this.year(),t.dow,t.doy)}function qi(t,e,i,o,s){var n;return null==t?St(this,o,s).year:(n=xt(t,o,s),e>n&&(e=n),Vi.call(this,t,e,i,o,s))}function Vi(t,e,i,o,s){var n=kt(t,e,i,o,s),r=bt(n.year,0,n.dayOfYear);return this.year(r.getUTCFullYear()),this.month(r.getUTCMonth()),this.date(r.getUTCDate()),this}function Gi(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)}function Bi(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")}function Zi(t,e){e[vs]=b(1e3*("0."+t))}function Xi(){return this._isUTC?"UTC":""}function Qi(){return this._isUTC?"Coordinated Universal Time":""}function $i(t){return Oe(1e3*t)}function Ki(){return Oe.apply(null,arguments).parseZone()}function Ji(t){return t}function to(t,e,i,o){var s=oe(),n=c().set(o,e);return s[i](n,t)}function eo(t,e,i){if(r(t)&&(e=t,t=void 0),t=t||"",null!=e)return to(t,e,i,"month");var o,s=[];for(o=0;o<12;o++)s[o]=to(t,o,i,"month");return s}function io(t,e,i,o){"boolean"==typeof t?(r(e)&&(i=e,e=void 0),e=e||""):(e=t,i=e,t=!1,r(e)&&(i=e,e=void 0),e=e||"");var s=oe(),n=t?s._week.dow:0;if(null!=i)return to(e,(i+n)%7,o,"day");var a,h=[];for(a=0;a<7;a++)h[a]=to(e,(a+n)%7,o,"day");return h}function oo(t,e){return eo(t,e,"months")}function so(t,e){return eo(t,e,"monthsShort")}function no(t,e,i){return io(t,e,i,"weekdays")}function ro(t,e,i){return io(t,e,i,"weekdaysShort")}function ao(t,e,i){return io(t,e,i,"weekdaysMin")}function ho(){var t=this._data;return this._milliseconds=yn(this._milliseconds),this._days=yn(this._days),this._months=yn(this._months),t.milliseconds=yn(t.milliseconds),t.seconds=yn(t.seconds),t.minutes=yn(t.minutes),t.hours=yn(t.hours),t.months=yn(t.months),t.years=yn(t.years),this}function lo(t,e,i,o){var s=$e(e,i);return t._milliseconds+=o*s._milliseconds,t._days+=o*s._days,t._months+=o*s._months,t._bubble()}function uo(t,e){return lo(this,t,e,1)}function co(t,e){return lo(this,t,e,-1)}function po(t){return t<0?Math.floor(t):Math.ceil(t)}function fo(){var t,e,i,o,s,n=this._milliseconds,r=this._days,a=this._months,h=this._data;return n>=0&&r>=0&&a>=0||n<=0&&r<=0&&a<=0||(n+=864e5*po(_o(a)+r),r=0,a=0),h.milliseconds=n%1e3,t=g(n/1e3),h.seconds=t%60,e=g(t/60),h.minutes=e%60,i=g(e/60),h.hours=i%24,r+=g(i/24),s=g(mo(r)),a+=s,r-=po(_o(s)),o=g(a/12),a%=12,h.days=r,h.months=a,h.years=o,this}function mo(t){return 4800*t/146097}function _o(t){return 146097*t/4800}function yo(t){if(!this.isValid())return NaN;var e,i,o=this._milliseconds;if("month"===(t=F(t))||"quarter"===t||"year"===t)switch(e=this._days+o/864e5,i=this._months+mo(e),t){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(e=this._days+Math.round(_o(this._months)),t){case"week":return e/7+o/6048e5;case"day":return e+o/864e5;case"hour":return 24*e+o/36e5;case"minute":return 1440*e+o/6e4;case"second":return 86400*e+o/1e3;case"millisecond":return Math.floor(864e5*e)+o;default:throw new Error("Unknown unit "+t)}}function vo(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*b(this._months/12):NaN}function go(t){return function(){return this.as(t)}}function bo(){return $e(this)}function wo(t){return t=F(t),this.isValid()?this[t+"s"]():NaN}function ko(t){return function(){return this.isValid()?this._data[t]:NaN}}function So(){return g(this.days()/7)}function xo(t,e,i,o,s){return s.relativeTime(e||1,!!i,t,o)}function Mo(t,e,i){var o=$e(t).abs(),s=Cn(o.as("s")),n=Cn(o.as("m")),r=Cn(o.as("h")),a=Cn(o.as("d")),h=Cn(o.as("M")),l=Cn(o.as("y")),u=s<=Yn.ss&&["s",s]||s<Yn.s&&["ss",s]||n<=1&&["m"]||n<Yn.m&&["mm",n]||r<=1&&["h"]||r<Yn.h&&["hh",r]||a<=1&&["d"]||a<Yn.d&&["dd",a]||h<=1&&["M"]||h<Yn.M&&["MM",h]||l<=1&&["y"]||["yy",l];return u[2]=e,u[3]=+t>0,u[4]=i,xo.apply(null,u)}function Oo(t){return void 0===t?Cn:"function"==typeof t&&(Cn=t,!0)}function Do(t,e){return void 0!==Yn[t]&&(void 0===e?Yn[t]:(Yn[t]=e,"s"===t&&(Yn.ss=e-1),!0))}function To(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),i=Mo(this,!t,e);return t&&(i=e.pastFuture(+this,i)),e.postformat(i)}function Lo(t){return(t>0)-(t<0)||+t}function jo(){if(!this.isValid())return this.localeData().invalidDate();var t,e,i,o=Fn(this._milliseconds)/1e3,s=Fn(this._days),n=Fn(this._months);t=g(o/60),e=g(t/60),o%=60,t%=60,i=g(n/12),n%=12;var r=i,a=n,h=s,l=e,u=t,c=o?o.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var p=d<0?"-":"",f=Lo(this._months)!==Lo(d)?"-":"",m=Lo(this._days)!==Lo(d)?"-":"",_=Lo(this._milliseconds)!==Lo(d)?"-":"";return p+"P"+(r?f+r+"Y":"")+(a?f+a+"M":"")+(h?m+h+"D":"")+(l||u||c?"T":"")+(l?_+l+"H":"")+(u?_+u+"M":"")+(c?_+c+"S":"")}var Po,Eo;Eo=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),i=e.length>>>0,o=0;o<i;o++)if(o in e&&t.call(this,e[o],o,e))return!0;return!1};var Ao=t.momentProperties=[],Co=!1,Yo={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var Fo;Fo=Object.keys?Object.keys:function(t){var e,i=[];for(e in t)l(t,e)&&i.push(e);return i};var Ro={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},No={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ho=/\d{1,2}/,Io={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},zo={},Wo={},Uo=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,qo=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Vo={},Go={},Bo=/\d/,Zo=/\d\d/,Xo=/\d{3}/,Qo=/\d{4}/,$o=/[+-]?\d{6}/,Ko=/\d\d?/,Jo=/\d\d\d\d?/,ts=/\d\d\d\d\d\d?/,es=/\d{1,3}/,is=/\d{1,4}/,os=/[+-]?\d{1,6}/,ss=/\d+/,ns=/[+-]?\d+/,rs=/Z|[+-]\d\d:?\d\d/gi,as=/Z|[+-]\d\d(?::?\d\d)?/gi,hs=/[+-]?\d+(\.\d{1,3})?/,ls=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,us={},cs={},ds=0,ps=1,fs=2,ms=3,_s=4,ys=5,vs=6,gs=7,bs=8;z("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),z(0,["YY",2],0,function(){return this.year()%100}),z(0,["YYYY",4],0,"year"),z(0,["YYYYY",5],0,"year"),z(0,["YYYYYY",6,!0],0,"year"),Y("year","y"),N("year",1),G("Y",ns),G("YY",Ko,Zo),G("YYYY",is,Qo),G("YYYYY",os,$o),G("YYYYYY",os,$o),Q(["YYYYY","YYYYYY"],ds),Q("YYYY",function(e,i){i[ds]=2===e.length?t.parseTwoDigitYear(e):b(e)}),Q("YY",function(e,i){i[ds]=t.parseTwoDigitYear(e)}),Q("Y",function(t,e){e[ds]=parseInt(t,10)}),t.parseTwoDigitYear=function(t){return b(t)+(b(t)>68?1900:2e3)};var ws,ks=it("FullYear",!0);ws=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},z("M",["MM",2],"Mo",function(){return this.month()+1}),z("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),z("MMMM",0,0,function(t){return this.localeData().months(this,t)}),Y("month","M"),N("month",8),G("M",Ko),G("MM",Ko,Zo),G("MMM",function(t,e){return e.monthsShortRegex(t)}),G("MMMM",function(t,e){return e.monthsRegex(t)}),Q(["M","MM"],function(t,e){e[ps]=b(t)-1}),Q(["MMM","MMMM"],function(t,e,i,o){var s=i._locale.monthsParse(t,o,i._strict);null!=s?e[ps]=s:p(i).invalidMonth=t});var Ss=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,xs="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ms="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Os=ls,Ds=ls;z("w",["ww",2],"wo","week"),z("W",["WW",2],"Wo","isoWeek"),Y("week","w"),Y("isoWeek","W"),N("week",5),N("isoWeek",5),G("w",Ko),G("ww",Ko,Zo),G("W",Ko),G("WW",Ko,Zo),$(["w","ww","W","WW"],function(t,e,i,o){e[o.substr(0,1)]=b(t)});var Ts={dow:0,doy:6};z("d",0,"do","day"),z("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),z("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),z("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),z("e",0,0,"weekday"),z("E",0,0,"isoWeekday"),Y("day","d"),Y("weekday","e"),Y("isoWeekday","E"),N("day",11),N("weekday",11),N("isoWeekday",11),G("d",Ko),G("e",Ko),G("E",Ko),G("dd",function(t,e){return e.weekdaysMinRegex(t)}),G("ddd",function(t,e){return e.weekdaysShortRegex(t)}),G("dddd",function(t,e){return e.weekdaysRegex(t)}),$(["dd","ddd","dddd"],function(t,e,i,o){var s=i._locale.weekdaysParse(t,o,i._strict);null!=s?e.d=s:p(i).invalidWeekday=t}),$(["d","e","E"],function(t,e,i,o){e[o]=b(t)});var Ls="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),js="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ps="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Es=ls,As=ls,Cs=ls;z("H",["HH",2],0,"hour"),z("h",["hh",2],0,Vt),z("k",["kk",2],0,Gt),z("hmm",0,0,function(){return""+Vt.apply(this)+I(this.minutes(),2)}),z("hmmss",0,0,function(){return""+Vt.apply(this)+I(this.minutes(),2)+I(this.seconds(),2)}),z("Hmm",0,0,function(){return""+this.hours()+I(this.minutes(),2)}),z("Hmmss",0,0,function(){return""+this.hours()+I(this.minutes(),2)+I(this.seconds(),2)}),Bt("a",!0),Bt("A",!1),Y("hour","h"),N("hour",13),G("a",Zt),G("A",Zt),G("H",Ko),G("h",Ko),G("k",Ko),G("HH",Ko,Zo),G("hh",Ko,Zo),G("kk",Ko,Zo),G("hmm",Jo),G("hmmss",ts),G("Hmm",Jo),G("Hmmss",ts),Q(["H","HH"],ms),Q(["k","kk"],function(t,e,i){var o=b(t);e[ms]=24===o?0:o}),Q(["a","A"],function(t,e,i){i._isPm=i._locale.isPM(t),i._meridiem=t}),Q(["h","hh"],function(t,e,i){e[ms]=b(t),p(i).bigHour=!0}),Q("hmm",function(t,e,i){var o=t.length-2;e[ms]=b(t.substr(0,o)),e[_s]=b(t.substr(o)),p(i).bigHour=!0}),Q("hmmss",function(t,e,i){var o=t.length-4,s=t.length-2;e[ms]=b(t.substr(0,o)),e[_s]=b(t.substr(o,2)),e[ys]=b(t.substr(s)),p(i).bigHour=!0}),Q("Hmm",function(t,e,i){var o=t.length-2;e[ms]=b(t.substr(0,o)),e[_s]=b(t.substr(o))}),Q("Hmmss",function(t,e,i){var o=t.length-4,s=t.length-2;e[ms]=b(t.substr(0,o)),e[_s]=b(t.substr(o,2)),e[ys]=b(t.substr(s))});var Ys,Fs=/[ap]\.?m?\.?/i,Rs=it("Hours",!0),Ns={calendar:Ro,longDateFormat:No,invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:Ho,relativeTime:Io,months:xs,monthsShort:Ms,week:Ts,weekdays:Ls,weekdaysMin:Ps,weekdaysShort:js,meridiemParse:Fs},Hs={},Is={},zs=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ws=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Us=/Z|[+-]\d\d(?::?\d\d)?/,qs=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Vs=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Gs=/^\/?Date\((\-?\d+)/i,Bs=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Zs={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};t.createFromInputFallback=S("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var Xs=S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Oe.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:m()}),Qs=S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Oe.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:m()}),$s=function(){return Date.now?Date.now():+new Date},Ks=["year","quarter","month","week","day","hour","minute","second","millisecond"];Fe("Z",":"),Fe("ZZ",""),G("Z",as),G("ZZ",as),Q(["Z","ZZ"],function(t,e,i){i._useUTC=!0,i._tzm=Re(as,t)});var Js=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var tn=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,en=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;$e.fn=Ae.prototype,$e.invalid=Ee;var on=ei(1,"add"),sn=ei(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var nn=S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)}),rn=1e3,an=60*rn,hn=60*an,ln=3506328*hn;z(0,["gg",2],0,function(){return this.weekYear()%100}),z(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Hi("gggg","weekYear"),Hi("ggggg","weekYear"),Hi("GGGG","isoWeekYear"),Hi("GGGGG","isoWeekYear"),Y("weekYear","gg"),Y("isoWeekYear","GG"),N("weekYear",1),N("isoWeekYear",1),G("G",ns),G("g",ns),G("GG",Ko,Zo),G("gg",Ko,Zo),G("GGGG",is,Qo),G("gggg",is,Qo),G("GGGGG",os,$o),G("ggggg",os,$o),$(["gggg","ggggg","GGGG","GGGGG"],function(t,e,i,o){e[o.substr(0,2)]=b(t)}),$(["gg","GG"],function(e,i,o,s){i[s]=t.parseTwoDigitYear(e)}),z("Q",0,"Qo","quarter"),Y("quarter","Q"),N("quarter",7),G("Q",Bo),Q("Q",function(t,e){e[ps]=3*(b(t)-1)}),z("D",["DD",2],"Do","date"),Y("date","D"),N("date",9),G("D",Ko),G("DD",Ko,Zo),G("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),Q(["D","DD"],fs),Q("Do",function(t,e){e[fs]=b(t.match(Ko)[0])});var un=it("Date",!0);z("DDD",["DDDD",3],"DDDo","dayOfYear"),Y("dayOfYear","DDD"),N("dayOfYear",4),G("DDD",es),G("DDDD",Xo),Q(["DDD","DDDD"],function(t,e,i){i._dayOfYear=b(t)}),z("m",["mm",2],0,"minute"),Y("minute","m"),N("minute",14),G("m",Ko),G("mm",Ko,Zo),Q(["m","mm"],_s);var cn=it("Minutes",!1);z("s",["ss",2],0,"second"),Y("second","s"),N("second",15),G("s",Ko),G("ss",Ko,Zo),Q(["s","ss"],ys);var dn=it("Seconds",!1);z("S",0,0,function(){return~~(this.millisecond()/100)}),z(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),z(0,["SSS",3],0,"millisecond"),z(0,["SSSS",4],0,function(){return 10*this.millisecond()}),z(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),z(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),z(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),z(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),z(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),Y("millisecond","ms"),N("millisecond",16),G("S",es,Bo),G("SS",es,Zo),G("SSS",es,Xo);var pn;for(pn="SSSS";pn.length<=9;pn+="S")G(pn,ss);for(pn="S";pn.length<=9;pn+="S")Q(pn,Zi);var fn=it("Milliseconds",!1);z("z",0,0,"zoneAbbr"),z("zz",0,0,"zoneName");var mn=y.prototype;mn.add=on,mn.calendar=si,mn.clone=ni,mn.diff=di,mn.endOf=Ti,mn.format=yi,mn.from=vi,mn.fromNow=gi,mn.to=bi,mn.toNow=wi,mn.get=nt,mn.invalidAt=Ri,mn.isAfter=ri,mn.isBefore=ai,mn.isBetween=hi,mn.isSame=li,mn.isSameOrAfter=ui,mn.isSameOrBefore=ci,mn.isValid=Yi,mn.lang=nn,mn.locale=ki,mn.localeData=Si,mn.max=Qs,mn.min=Xs,mn.parsingFlags=Fi,mn.set=rt,mn.startOf=Di,mn.subtract=sn,mn.toArray=Ei,mn.toObject=Ai,mn.toDate=Pi,mn.toISOString=mi,mn.inspect=_i,mn.toJSON=Ci,mn.toString=fi,mn.unix=ji,mn.valueOf=Li,mn.creationData=Ni,mn.year=ks,mn.isLeapYear=et,mn.weekYear=Ii,mn.isoWeekYear=zi,mn.quarter=mn.quarters=Gi,mn.month=ft,mn.daysInMonth=mt,mn.week=mn.weeks=Tt,mn.isoWeek=mn.isoWeeks=Lt,mn.weeksInYear=Ui,mn.isoWeeksInYear=Wi,mn.date=un,mn.day=mn.days=Nt,mn.weekday=Ht,mn.isoWeekday=It,mn.dayOfYear=Bi,mn.hour=mn.hours=Rs,mn.minute=mn.minutes=cn,mn.second=mn.seconds=dn,mn.millisecond=mn.milliseconds=fn,mn.utcOffset=Ie,mn.utc=We,mn.local=Ue,mn.parseZone=qe,mn.hasAlignedHourOffset=Ve,mn.isDST=Ge,mn.isLocal=Ze,mn.isUtcOffset=Xe,mn.isUtc=Qe,mn.isUTC=Qe,mn.zoneAbbr=Xi,mn.zoneName=Qi,mn.dates=S("dates accessor is deprecated. Use date instead.",un),mn.months=S("months accessor is deprecated. Use month instead",ft),mn.years=S("years accessor is deprecated. Use year instead",ks),mn.zone=S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ze),mn.isDSTShifted=S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Be);var _n=T.prototype;_n.calendar=L,_n.longDateFormat=j,_n.invalidDate=P,_n.ordinal=E,_n.preparse=Ji,_n.postformat=Ji,_n.relativeTime=A,_n.pastFuture=C,_n.set=O,_n.months=lt,_n.monthsShort=ut,_n.monthsParse=dt,_n.monthsRegex=yt,_n.monthsShortRegex=_t,_n.week=Mt,_n.firstDayOfYear=Dt,_n.firstDayOfWeek=Ot,_n.weekdays=At,_n.weekdaysMin=Yt,_n.weekdaysShort=Ct,_n.weekdaysParse=Rt,_n.weekdaysRegex=zt,_n.weekdaysShortRegex=Wt,_n.weekdaysMinRegex=Ut,_n.isPM=Xt,_n.meridiem=Qt,te("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===b(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),t.lang=S("moment.lang is deprecated. Use moment.locale instead.",te),t.langData=S("moment.langData is deprecated. Use moment.localeData instead.",oe);var yn=Math.abs,vn=go("ms"),gn=go("s"),bn=go("m"),wn=go("h"),kn=go("d"),Sn=go("w"),xn=go("M"),Mn=go("Q"),On=go("y"),Dn=ko("milliseconds"),Tn=ko("seconds"),Ln=ko("minutes"),jn=ko("hours"),Pn=ko("days"),En=ko("months"),An=ko("years"),Cn=Math.round,Yn={ss:44,s:45,m:45,h:22,d:26,M:11},Fn=Math.abs,Rn=Ae.prototype;return Rn.isValid=Pe,Rn.abs=ho,Rn.add=uo,Rn.subtract=co,Rn.as=yo,Rn.asMilliseconds=vn,Rn.asSeconds=gn,Rn.asMinutes=bn,Rn.asHours=wn,Rn.asDays=kn,Rn.asWeeks=Sn,Rn.asMonths=xn,Rn.asQuarters=Mn,Rn.asYears=On,Rn.valueOf=vo,Rn._bubble=fo,Rn.clone=bo,Rn.get=wo,Rn.milliseconds=Dn,Rn.seconds=Tn,Rn.minutes=Ln,Rn.hours=jn,Rn.days=Pn,Rn.weeks=So,Rn.months=En,Rn.years=An,Rn.humanize=To,Rn.toISOString=jo,Rn.toString=jo,Rn.toJSON=jo,Rn.locale=ki,Rn.localeData=Si,Rn.toIsoString=S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",jo),Rn.lang=nn,z("X",0,0,"unix"),z("x",0,0,"valueOf"),G("x",ns),G("X",hs),Q("X",function(t,e,i){i._d=new Date(1e3*parseFloat(t,10))}),Q("x",function(t,e,i){i._d=new Date(b(t))}),t.version="2.24.0",function(t){Po=t}(Oe),t.fn=mn,t.min=Te,t.max=Le,t.now=$s,t.utc=c,t.unix=$i,t.months=oo,t.isDate=a,t.locale=te,t.invalid=m,t.duration=$e,t.isMoment=v,t.weekdays=no,t.parseZone=Ki,t.localeData=oe,t.isDuration=Ce,t.monthsShort=so,t.weekdaysMin=ao,t.defineLocale=ee,t.updateLocale=ie,t.locales=se,t.weekdaysShort=ro,t.normalizeUnits=F,t.relativeTimeRounding=Oo,t.relativeTimeThreshold=Do,t.calendarFormat=oi,t.prototype=mn,t.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},t}),i("moment",["moment/moment"],function(t){return t}),i("common/date_helper",["moment"],function(t){function e(e,i){return t(e).isSame(i,"day")}function i(e){return t.utc(e)}function o(e,i){return t(e).format(i)}return{areEqual:e,formatDate:o,getUTCDate:i}}),function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},e=t._,o=Array.prototype,s=Object.prototype,n="undefined"!=typeof Symbol?Symbol.prototype:null,r=o.push,a=o.slice,h=s.toString,l=s.hasOwnProperty,u=Array.isArray,c=Object.keys,d=Object.create,p=function(){},f=function(t){return t instanceof f?t:this instanceof f?void(this._wrapped=t):new f(t)};"undefined"==typeof exports||exports.nodeType?t._=f:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=f),exports._=f),f.VERSION="1.9.1";var m,_=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,o,s){return t.call(e,i,o,s)};case 4:return function(i,o,s,n){return t.call(e,i,o,s,n)}}return function(){return t.apply(e,arguments)}},y=function(t,e,i){return f.iteratee!==m?f.iteratee(t,e):null==t?f.identity:f.isFunction(t)?_(t,e,i):f.isObject(t)&&!f.isArray(t)?f.matcher(t):f.property(t)};f.iteratee=m=function(t,e){return y(t,e,1/0)};var v=function(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),o=Array(i),s=0;s<i;s++)o[s]=arguments[s+e];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,arguments[0],o);case 2:return t.call(this,arguments[0],arguments[1],o)}var n=Array(e+1);for(s=0;s<e;s++)n[s]=arguments[s];return n[e]=o,t.apply(this,n)}},g=function(t){if(!f.isObject(t))return{};if(d)return d(t);p.prototype=t;var e=new p;return p.prototype=null,e},b=function(t){return function(e){return null==e?void 0:e[t]}},w=function(t,e){return null!=t&&l.call(t,e)},k=function(t,e){for(var i=e.length,o=0;o<i;o++){if(null==t)return;t=t[e[o]]}return i?t:void 0},S=Math.pow(2,53)-1,x=b("length"),M=function(t){var e=x(t);return"number"==typeof e&&e>=0&&e<=S};f.each=f.forEach=function(t,e,i){e=_(e,i);var o,s;if(M(t))for(o=0,s=t.length;o<s;o++)e(t[o],o,t);else{var n=f.keys(t);for(o=0,s=n.length;o<s;o++)e(t[n[o]],n[o],t)}return t},f.map=f.collect=function(t,e,i){e=y(e,i);for(var o=!M(t)&&f.keys(t),s=(o||t).length,n=Array(s),r=0;r<s;r++){var a=o?o[r]:r;n[r]=e(t[a],a,t)}return n};var O=function(t){var e=function(e,i,o,s){var n=!M(e)&&f.keys(e),r=(n||e).length,a=t>0?0:r-1;for(s||(o=e[n?n[a]:a],a+=t);a>=0&&a<r;a+=t){var h=n?n[a]:a;o=i(o,e[h],h,e)}return o};return function(t,i,o,s){var n=arguments.length>=3;return e(t,_(i,s,4),o,n)}};f.reduce=f.foldl=f.inject=O(1),f.reduceRight=f.foldr=O(-1),f.find=f.detect=function(t,e,i){var o=M(t)?f.findIndex:f.findKey,s=o(t,e,i);if(void 0!==s&&-1!==s)return t[s]},f.filter=f.select=function(t,e,i){var o=[];return e=y(e,i),f.each(t,function(t,i,s){e(t,i,s)&&o.push(t)}),o},f.reject=function(t,e,i){return f.filter(t,f.negate(y(e)),i)},f.every=f.all=function(t,e,i){e=y(e,i);for(var o=!M(t)&&f.keys(t),s=(o||t).length,n=0;n<s;n++){var r=o?o[n]:n;if(!e(t[r],r,t))return!1}return!0},f.some=f.any=function(t,e,i){e=y(e,i);for(var o=!M(t)&&f.keys(t),s=(o||t).length,n=0;n<s;n++){var r=o?o[n]:n;if(e(t[r],r,t))return!0}return!1},f.contains=f.includes=f.include=function(t,e,i,o){return M(t)||(t=f.values(t)),("number"!=typeof i||o)&&(i=0),f.indexOf(t,e,i)>=0},f.invoke=v(function(t,e,i){var o,s;return f.isFunction(e)?s=e:f.isArray(e)&&(o=e.slice(0,-1),e=e[e.length-1]),f.map(t,function(t){var n=s;if(!n){if(o&&o.length&&(t=k(t,o)),null==t)return;n=t[e]}return null==n?n:n.apply(t,i)})}),f.pluck=function(t,e){return f.map(t,f.property(e))},f.where=function(t,e){return f.filter(t,f.matcher(e))},f.findWhere=function(t,e){return f.find(t,f.matcher(e))},f.max=function(t,e,i){var o,s,n=-1/0,r=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t){t=M(t)?t:f.values(t);for(var a=0,h=t.length;a<h;a++)null!=(o=t[a])&&o>n&&(n=o)}else e=y(e,i),f.each(t,function(t,i,o){((s=e(t,i,o))>r||s===-1/0&&n===-1/0)&&(n=t,r=s)});return n},f.min=function(t,e,i){var o,s,n=1/0,r=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t){t=M(t)?t:f.values(t);for(var a=0,h=t.length;a<h;a++)null!=(o=t[a])&&o<n&&(n=o)}else e=y(e,i),f.each(t,function(t,i,o){((s=e(t,i,o))<r||s===1/0&&n===1/0)&&(n=t,r=s)});return n},f.shuffle=function(t){return f.sample(t,1/0)},f.sample=function(t,e,i){if(null==e||i)return M(t)||(t=f.values(t)),t[f.random(t.length-1)];var o=M(t)?f.clone(t):f.values(t),s=x(o);e=Math.max(Math.min(e,s),0);for(var n=s-1,r=0;r<e;r++){var a=f.random(r,n),h=o[r];o[r]=o[a],o[a]=h}return o.slice(0,e)},
f.sortBy=function(t,e,i){var o=0;return e=y(e,i),f.pluck(f.map(t,function(t,i,s){return{value:t,index:o++,criteria:e(t,i,s)}}).sort(function(t,e){var i=t.criteria,o=e.criteria;if(i!==o){if(i>o||void 0===i)return 1;if(i<o||void 0===o)return-1}return t.index-e.index}),"value")};var D=function(t,e){return function(i,o,s){var n=e?[[],[]]:{};return o=y(o,s),f.each(i,function(e,s){var r=o(e,s,i);t(n,e,r)}),n}};f.groupBy=D(function(t,e,i){w(t,i)?t[i].push(e):t[i]=[e]}),f.indexBy=D(function(t,e,i){t[i]=e}),f.countBy=D(function(t,e,i){w(t,i)?t[i]++:t[i]=1});var T=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;f.toArray=function(t){return t?f.isArray(t)?a.call(t):f.isString(t)?t.match(T):M(t)?f.map(t,f.identity):f.values(t):[]},f.size=function(t){return null==t?0:M(t)?t.length:f.keys(t).length},f.partition=D(function(t,e,i){t[i?0:1].push(e)},!0),f.first=f.head=f.take=function(t,e,i){return null==t||t.length<1?null==e?void 0:[]:null==e||i?t[0]:f.initial(t,t.length-e)},f.initial=function(t,e,i){return a.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},f.last=function(t,e,i){return null==t||t.length<1?null==e?void 0:[]:null==e||i?t[t.length-1]:f.rest(t,Math.max(0,t.length-e))},f.rest=f.tail=f.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},f.compact=function(t){return f.filter(t,Boolean)};var L=function(t,e,i,o){o=o||[];for(var s=o.length,n=0,r=x(t);n<r;n++){var a=t[n];if(M(a)&&(f.isArray(a)||f.isArguments(a)))if(e)for(var h=0,l=a.length;h<l;)o[s++]=a[h++];else L(a,e,i,o),s=o.length;else i||(o[s++]=a)}return o};f.flatten=function(t,e){return L(t,e,!1)},f.without=v(function(t,e){return f.difference(t,e)}),f.uniq=f.unique=function(t,e,i,o){f.isBoolean(e)||(o=i,i=e,e=!1),null!=i&&(i=y(i,o));for(var s=[],n=[],r=0,a=x(t);r<a;r++){var h=t[r],l=i?i(h,r,t):h;e&&!i?(r&&n===l||s.push(h),n=l):i?f.contains(n,l)||(n.push(l),s.push(h)):f.contains(s,h)||s.push(h)}return s},f.union=v(function(t){return f.uniq(L(t,!0,!0))}),f.intersection=function(t){for(var e=[],i=arguments.length,o=0,s=x(t);o<s;o++){var n=t[o];if(!f.contains(e,n)){var r;for(r=1;r<i&&f.contains(arguments[r],n);r++);r===i&&e.push(n)}}return e},f.difference=v(function(t,e){return e=L(e,!0,!0),f.filter(t,function(t){return!f.contains(e,t)})}),f.unzip=function(t){for(var e=t&&f.max(t,x).length||0,i=Array(e),o=0;o<e;o++)i[o]=f.pluck(t,o);return i},f.zip=v(f.unzip),f.object=function(t,e){for(var i={},o=0,s=x(t);o<s;o++)e?i[t[o]]=e[o]:i[t[o][0]]=t[o][1];return i};var j=function(t){return function(e,i,o){i=y(i,o);for(var s=x(e),n=t>0?0:s-1;n>=0&&n<s;n+=t)if(i(e[n],n,e))return n;return-1}};f.findIndex=j(1),f.findLastIndex=j(-1),f.sortedIndex=function(t,e,i,o){i=y(i,o,1);for(var s=i(e),n=0,r=x(t);n<r;){var a=Math.floor((n+r)/2);i(t[a])<s?n=a+1:r=a}return n};var P=function(t,e,i){return function(o,s,n){var r=0,h=x(o);if("number"==typeof n)t>0?r=n>=0?n:Math.max(n+h,r):h=n>=0?Math.min(n+1,h):n+h+1;else if(i&&n&&h)return n=i(o,s),o[n]===s?n:-1;if(s!==s)return n=e(a.call(o,r,h),f.isNaN),n>=0?n+r:-1;for(n=t>0?r:h-1;n>=0&&n<h;n+=t)if(o[n]===s)return n;return-1}};f.indexOf=P(1,f.findIndex,f.sortedIndex),f.lastIndexOf=P(-1,f.findLastIndex),f.range=function(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var o=Math.max(Math.ceil((e-t)/i),0),s=Array(o),n=0;n<o;n++,t+=i)s[n]=t;return s},f.chunk=function(t,e){if(null==e||e<1)return[];for(var i=[],o=0,s=t.length;o<s;)i.push(a.call(t,o,o+=e));return i};var E=function(t,e,i,o,s){if(!(o instanceof e))return t.apply(i,s);var n=g(t.prototype),r=t.apply(n,s);return f.isObject(r)?r:n};f.bind=v(function(t,e,i){if(!f.isFunction(t))throw new TypeError("Bind must be called on a function");var o=v(function(s){return E(t,o,e,this,i.concat(s))});return o}),f.partial=v(function(t,e){var i=f.partial.placeholder,o=function(){for(var s=0,n=e.length,r=Array(n),a=0;a<n;a++)r[a]=e[a]===i?arguments[s++]:e[a];for(;s<arguments.length;)r.push(arguments[s++]);return E(t,o,this,this,r)};return o}),f.partial.placeholder=f,f.bindAll=v(function(t,e){e=L(e,!1,!1);var i=e.length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var o=e[i];t[o]=f.bind(t[o],t)}}),f.memoize=function(t,e){var i=function(o){var s=i.cache,n=""+(e?e.apply(this,arguments):o);return w(s,n)||(s[n]=t.apply(this,arguments)),s[n]};return i.cache={},i},f.delay=v(function(t,e,i){return setTimeout(function(){return t.apply(null,i)},e)}),f.defer=f.partial(f.delay,f,1),f.throttle=function(t,e,i){var o,s,n,r,a=0;i||(i={});var h=function(){a=!1===i.leading?0:f.now(),o=null,r=t.apply(s,n),o||(s=n=null)},l=function(){var l=f.now();a||!1!==i.leading||(a=l);var u=e-(l-a);return s=this,n=arguments,u<=0||u>e?(o&&(clearTimeout(o),o=null),a=l,r=t.apply(s,n),o||(s=n=null)):o||!1===i.trailing||(o=setTimeout(h,u)),r};return l.cancel=function(){clearTimeout(o),a=0,o=s=n=null},l},f.debounce=function(t,e,i){var o,s,n=function(e,i){o=null,i&&(s=t.apply(e,i))},r=v(function(r){if(o&&clearTimeout(o),i){var a=!o;o=setTimeout(n,e),a&&(s=t.apply(this,r))}else o=f.delay(n,e,this,r);return s});return r.cancel=function(){clearTimeout(o),o=null},r},f.wrap=function(t,e){return f.partial(e,t)},f.negate=function(t){return function(){return!t.apply(this,arguments)}},f.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,o=t[e].apply(this,arguments);i--;)o=t[i].call(this,o);return o}},f.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},f.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},f.once=f.partial(f.before,2),f.restArguments=v;var A=!{toString:null}.propertyIsEnumerable("toString"),C=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Y=function(t,e){var i=C.length,o=t.constructor,n=f.isFunction(o)&&o.prototype||s,r="constructor";for(w(t,r)&&!f.contains(e,r)&&e.push(r);i--;)(r=C[i])in t&&t[r]!==n[r]&&!f.contains(e,r)&&e.push(r)};f.keys=function(t){if(!f.isObject(t))return[];if(c)return c(t);var e=[];for(var i in t)w(t,i)&&e.push(i);return A&&Y(t,e),e},f.allKeys=function(t){if(!f.isObject(t))return[];var e=[];for(var i in t)e.push(i);return A&&Y(t,e),e},f.values=function(t){for(var e=f.keys(t),i=e.length,o=Array(i),s=0;s<i;s++)o[s]=t[e[s]];return o},f.mapObject=function(t,e,i){e=y(e,i);for(var o=f.keys(t),s=o.length,n={},r=0;r<s;r++){var a=o[r];n[a]=e(t[a],a,t)}return n},f.pairs=function(t){for(var e=f.keys(t),i=e.length,o=Array(i),s=0;s<i;s++)o[s]=[e[s],t[e[s]]];return o},f.invert=function(t){for(var e={},i=f.keys(t),o=0,s=i.length;o<s;o++)e[t[i[o]]]=i[o];return e},f.functions=f.methods=function(t){var e=[];for(var i in t)f.isFunction(t[i])&&e.push(i);return e.sort()};var F=function(t,e){return function(i){var o=arguments.length;if(e&&(i=Object(i)),o<2||null==i)return i;for(var s=1;s<o;s++)for(var n=arguments[s],r=t(n),a=r.length,h=0;h<a;h++){var l=r[h];e&&void 0!==i[l]||(i[l]=n[l])}return i}};f.extend=F(f.allKeys),f.extendOwn=f.assign=F(f.keys),f.findKey=function(t,e,i){e=y(e,i);for(var o,s=f.keys(t),n=0,r=s.length;n<r;n++)if(o=s[n],e(t[o],o,t))return o};var R=function(t,e,i){return e in i};f.pick=v(function(t,e){var i={},o=e[0];if(null==t)return i;f.isFunction(o)?(e.length>1&&(o=_(o,e[1])),e=f.allKeys(t)):(o=R,e=L(e,!1,!1),t=Object(t));for(var s=0,n=e.length;s<n;s++){var r=e[s],a=t[r];o(a,r,t)&&(i[r]=a)}return i}),f.omit=v(function(t,e){var i,o=e[0];return f.isFunction(o)?(o=f.negate(o),e.length>1&&(i=e[1])):(e=f.map(L(e,!1,!1),String),o=function(t,i){return!f.contains(e,i)}),f.pick(t,o,i)}),f.defaults=F(f.allKeys,!0),f.create=function(t,e){var i=g(t);return e&&f.extendOwn(i,e),i},f.clone=function(t){return f.isObject(t)?f.isArray(t)?t.slice():f.extend({},t):t},f.tap=function(t,e){return e(t),t},f.isMatch=function(t,e){var i=f.keys(e),o=i.length;if(null==t)return!o;for(var s=Object(t),n=0;n<o;n++){var r=i[n];if(e[r]!==s[r]||!(r in s))return!1}return!0};var N,H;N=function(t,e,i,o){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!==t)return e!==e;var s=typeof t;return("function"===s||"object"===s||"object"==typeof e)&&H(t,e,i,o)},H=function(t,e,i,o){t instanceof f&&(t=t._wrapped),e instanceof f&&(e=e._wrapped);var s=h.call(t);if(s!==h.call(e))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return n.valueOf.call(t)===n.valueOf.call(e)}var r="[object Array]"===s;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,l=e.constructor;if(a!==l&&!(f.isFunction(a)&&a instanceof a&&f.isFunction(l)&&l instanceof l)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],o=o||[];for(var u=i.length;u--;)if(i[u]===t)return o[u]===e;if(i.push(t),o.push(e),r){if((u=t.length)!==e.length)return!1;for(;u--;)if(!N(t[u],e[u],i,o))return!1}else{var c,d=f.keys(t);if(u=d.length,f.keys(e).length!==u)return!1;for(;u--;)if(c=d[u],!w(e,c)||!N(t[c],e[c],i,o))return!1}return i.pop(),o.pop(),!0},f.isEqual=function(t,e){return N(t,e)},f.isEmpty=function(t){return null==t||(M(t)&&(f.isArray(t)||f.isString(t)||f.isArguments(t))?0===t.length:0===f.keys(t).length)},f.isElement=function(t){return!(!t||1!==t.nodeType)},f.isArray=u||function(t){return"[object Array]"===h.call(t)},f.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},f.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){f["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),f.isArguments(arguments)||(f.isArguments=function(t){return w(t,"callee")});var I=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof I&&(f.isFunction=function(t){return"function"==typeof t||!1}),f.isFinite=function(t){return!f.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},f.isNaN=function(t){return f.isNumber(t)&&isNaN(t)},f.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},f.isNull=function(t){return null===t},f.isUndefined=function(t){return void 0===t},f.has=function(t,e){if(!f.isArray(e))return w(t,e);for(var i=e.length,o=0;o<i;o++){var s=e[o];if(null==t||!l.call(t,s))return!1;t=t[s]}return!!i},f.noConflict=function(){return t._=e,this},f.identity=function(t){return t},f.constant=function(t){return function(){return t}},f.noop=function(){},f.property=function(t){return f.isArray(t)?function(e){return k(e,t)}:b(t)},f.propertyOf=function(t){return null==t?function(){}:function(e){return f.isArray(e)?k(t,e):t[e]}},f.matcher=f.matches=function(t){return t=f.extendOwn({},t),function(e){return f.isMatch(e,t)}},f.times=function(t,e,i){var o=Array(Math.max(0,t));e=_(e,i,1);for(var s=0;s<t;s++)o[s]=e(s);return o},f.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},f.now=Date.now||function(){return(new Date).getTime()};var z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},W=f.invert(z),U=function(t){var e=function(e){return t[e]},i="(?:"+f.keys(t).join("|")+")",o=RegExp(i),s=RegExp(i,"g");return function(t){return t=null==t?"":""+t,o.test(t)?t.replace(s,e):t}};f.escape=U(z),f.unescape=U(W),f.result=function(t,e,i){f.isArray(e)||(e=[e]);var o=e.length;if(!o)return f.isFunction(i)?i.call(t):i;for(var s=0;s<o;s++){var n=null==t?void 0:t[e[s]];void 0===n&&(n=i,s=o),t=f.isFunction(n)?n.call(t):n}return t};var q=0;f.uniqueId=function(t){var e=++q+"";return t?t+e:e},f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\u2028|\u2029/g,Z=function(t){return"\\"+G[t]};f.template=function(t,e,i){!e&&i&&(e=i),e=f.defaults({},e,f.templateSettings);var o=RegExp([(e.escape||V).source,(e.interpolate||V).source,(e.evaluate||V).source].join("|")+"|$","g"),s=0,n="__p+='";t.replace(o,function(e,i,o,r,a){return n+=t.slice(s,a).replace(B,Z),s=a+e.length,i?n+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":o?n+="'+\n((__t=("+o+"))==null?'':__t)+\n'":r&&(n+="';\n"+r+"\n__p+='"),e}),n+="';\n",e.variable||(n="with(obj||{}){\n"+n+"}\n"),n="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+n+"return __p;\n";var r;try{r=new Function(e.variable||"obj","_",n)}catch(t){throw t.source=n,t}var a=function(t){return r.call(this,t,f)};return a.source="function("+(e.variable||"obj")+"){\n"+n+"}",a},f.chain=function(t){var e=f(t);return e._chain=!0,e};var X=function(t,e){return t._chain?f(e).chain():e};f.mixin=function(t){return f.each(f.functions(t),function(e){var i=f[e]=t[e];f.prototype[e]=function(){var t=[this._wrapped];return r.apply(t,arguments),X(this,i.apply(f,t))}}),f},f.mixin(f),f.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];f.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],X(this,i)}}),f.each(["concat","join","slice"],function(t){var e=o[t];f.prototype[t]=function(){return X(this,e.apply(this._wrapped,arguments))}}),f.prototype.value=function(){return this._wrapped},f.prototype.valueOf=f.prototype.toJSON=f.prototype.value,f.prototype.toString=function(){return String(this._wrapped)},"function"==typeof i&&i.amd&&i("underscore",[],function(){return f})}(),i("actionbar/views/date_summary",["common/date_helper","underscore"],function(t,e){function i(t,e){return void 0===e&&(e={}),this.el=null,this.controller=t,this.options=e,this.mobile=!!(t.options&&t.options.layout_options&&t.options.layout_options.date_summary&&t.options.layout_options.date_summary.mobile),this.date=null,this.date_element=null,this.pill_element=null,this}return i.prototype.render=function(){var t=document.createElement("div");return t.classList.add("date-summary"),t.classList.add("hidden"),(this.options.hide_checkmark||this.controller.touch&&!this.mobile)&&t.classList.add("no-checkmark"),t.insertAdjacentHTML("afterbegin",this._template()),this.el=t,this.date_element=t.querySelector(".date"),this.pill_element=t.querySelector(".pill"),this._bindEvents(),this},i.prototype.remove=function(){return this.el.parentNode&&this.el.parentNode.removeChild(this.el),this._unbindEvents(),this.el=null,this.date=null,this.date_element=null,this.pill_element=null,this},i.prototype.update=function(e,i,o){if(void 0===o&&(o={}),"selected"in o&&(o.selected?this.el.classList.add("selected"):this.el.classList.remove("selected")),i>0?(this.date=e,this.el.classList.remove("hidden")):(this.date=null,this.el.classList.add("hidden")),this.date_element){var s="MMMM YYYY";this.controller.compressed&&(s="MMM YYYY");var n=t.formatDate(e,s);this.date_element.textContent!==n&&(this.date_element.textContent=n)}this.pill_element&&this.pill_element.textContent!=i&&(this.pill_element.textContent=i)},i.prototype._bindEvents=function(){this.el&&(e.bindAll(this,"_clickHandler"),this.el.addEventListener("click",this._clickHandler))},i.prototype._unbindEvents=function(){this.el&&this.el.removeEventListener("click",this._clickHandler)},i.prototype._clickHandler=function(t){this.controller.touch&&!1===this.mobile||this.el&&this.el.classList.contains("no-checkmark")||this.controller.layout.grouped[this.date].child.summary._onClick(t)},i.prototype._template=function(){return'<div class="pill"></div><div class="date"></div>'},i}),i("actionbar/views/layout_size",["underscore"],function(t){function e(t,e){return void 0===e&&(e={}),this.el=null,this.controller=t,this.options=e,this.disabled=!1,this}return e.prototype.render=function(){var t=document.createElement("div");return t.classList.add("layout-size"),t.insertAdjacentHTML("afterbegin",this._template()),this.el=t,this.update(),this._bindEvents(),this},e.prototype.remove=function(){return this.el.parentNode&&this.el.parentNode.removeChild(this.el),this._unbindEvents(),this.el=null,this},e.prototype.update=function(t){var e=this.el.querySelector(".pmc-icon.active");e&&e.classList.remove("active"),this.controller.options.layout_options.min_height===this.controller.options.layout_options.object_sizes.small.min_height?this.el.querySelector(".pmc-icon.small").classList.add("active"):this.controller.options.layout_options.min_height===this.controller.options.layout_options.object_sizes.large.min_height&&this.el.querySelector(".pmc-icon.large").classList.add("active"),t&&(t.disabled||!1===t.disabled)&&this._toggleDisabled(t.disabled)},e.prototype._bindEvents=function(){this.el&&(t.bindAll(this,"_clickHandler"),this.el.addEventListener("click",this._clickHandler,!1))},e.prototype._unbindEvents=function(){this.el&&this.el.removeEventListener("click",this._clickHandler,!1)},e.prototype._clickHandler=function(t){var e=t.target;this.disabled||!e.classList.contains("pmc-icon")||e.classList.contains("disabled")||this._updateLayout(e)},e.prototype._updateLayout=function(t){t.classList.contains("large")&&!t.classList.contains("active")?(this.controller.updateLayoutOptions({default_size:"large"}),this.controller.clickCb([],"layout-change",{size:"large"}),this.controller._track({name:"layout-change",type:"large"})):t.classList.contains("small")&&!t.classList.contains("active")&&(this.controller.updateLayoutOptions({default_size:"small"}),this.controller.clickCb([],"layout-change",{size:"small"}),this.controller._track({name:"layout-change",type:"small"}));var e=t.parentNode.querySelector(".pmc-icon.active");e&&e.classList.remove("active"),t.classList.add("active")},e.prototype._toggleDisabled=function(t){this.disabled=t,t?this.el.classList.add("disabled"):this.el.classList.remove("disabled")},e.prototype._template=function(t){return'<div class="pmc-icon large"></div><div class="pmc-icon small"></div>'},e}),i("actionbar/views/layout_sort",["underscore"],function(t){function e(t,e){return void 0===e&&(e={}),this.el=null,this.controller=t,this.options=e,this}return e.prototype.render=function(){var t=document.createElement("div");return t.classList.add("layout-sort"),t.insertAdjacentHTML("afterbegin",this._template()),this.el=t,this._bindEvents(),this._setStyles(),this},e.prototype.remove=function(){return this.el.parentNode&&this.el.parentNode.removeChild(this.el),this._unbindEvents(),this.el=null,this},e.prototype.update=function(){this._setStyles()},e.prototype._setStyles=function(){var t=this.el.querySelector(".sort-by-link.active");t&&t.classList.remove("active");var e=this.el.querySelector(".sort-mobile-item.active");switch(e&&e.classList.remove("active"),this.controller.options.layout_options.sort_by_attr){case"moment_date":this.el.querySelector(".sort-by-link.moment-date").classList.add("active"),this.el.querySelector(".sort-mobile-item.moment-date").classList.add("active"),this.el.querySelector(".sort-mobile-active").textContent="Date Taken";break;case"upload_date":this.el.querySelector(".sort-by-link.upload-date").classList.add("active"),this.el.querySelector(".sort-mobile-item.upload-date").classList.add("active"),this.el.querySelector(".sort-mobile-active").textContent="Date Uploaded"}},e.prototype._bindEvents=function(){this.el&&(t.bindAll(this,"_clickHandler"),this.el.addEventListener("click",this._clickHandler,!1),document.body.addEventListener("click",this._clickHandler,!1))},e.prototype._unbindEvents=function(){this.el&&(this.el.removeEventListener("click",this._clickHandler,!1),document.body.removeEventListener("click",this._clickHandler,!1))},e.prototype._clickHandler=function(t){var e=t.target;e.classList.contains("sort-by-link")&&!e.classList.contains("active")?(this.el.querySelector(".sort-by-link.active").classList.remove("active"),this._updateSort(e),this._setStyles()):e.classList.contains("sort-mobile-active")?this.el.querySelector(".sort-mobile-flyout").classList.add("active"):e.classList.contains("sort-mobile-item")?(this.el.querySelector(".sort-mobile-flyout").classList.remove("active"),e.classList.contains("active")||(this.el.querySelector(".sort-mobile-item.active").classList.remove("active"),this._updateSort(e),this._setStyles())):this.el.querySelector(".sort-mobile-flyout").classList.remove("active")},e.prototype._updateSort=function(t){var e=t.getAttribute("data-sort");this.controller.updateLayoutOptions({group_by_attr:e,sort_by_attr:e}),this.controller.clickCb([],"sort",e),this.controller._track({name:"sort",type:e})},e.prototype._template=function(){return'<div class="sort-label">Sort by</div><div class="sort-options"><span class="sort-by-link moment-date" data-sort="moment_date">Date Taken</span><span class="sort-by-link upload-date" data-sort="upload_date">Date Uploaded</span></div><div class="sort-options-mobile"><span class="sort-mobile-active"></span><div class="sort-mobile-flyout"><ul class="sort-mobile-list"><li class="sort-mobile-item moment-date" data-sort="moment_date">Date Taken</li><li class="sort-mobile-item upload-date" data-sort="upload_date">Date Uploaded</li></ul></div></div>'},e}),i("actionbar/bar",["actionbar/views/date_summary","actionbar/views/layout_size","actionbar/views/layout_sort","underscore"],function(t,e,i,o){function s(t,e){return void 0===e&&(e={}),this.el=null,this.options=o.extend(r,e),this.controller=t,this.views={left:{},center:{},right:{}},this}var n={"date-summary":t,"layout-size":e,"layout-sort":i},r={position:"top"};return s.prototype.render=function(){var t=document.createElement("div");return t.classList.add("action-bar"),t.classList.add(this.options.position),t.insertAdjacentHTML("afterbegin",this._template()),this.el=t,this.updateViews(),this},s.prototype.remove=function(){return o.each(this.views,function(t,e){o.each(t,function(t){t.remove()})},this),this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.el=null,this},s.prototype.update=function(){this.updateLayoutSize(),this.updateLayoutSort()},s.prototype.updateLayoutSize=function(t){o.each(this.views,function(e,i){"layout-size"in e&&e["layout-size"].update(t)},this)},s.prototype.updateLayoutSort=function(){o.each(this.views,function(t,e){"layout-sort"in t&&t["layout-sort"].update()},this)},s.prototype.updateDateSummary=function(t,e,i){o.each(this.views,function(o,s){"date-summary"in o&&o["date-summary"].update(t,e,i)},this)},s.prototype.updateOptions=function(t){return void 0===t&&(t={}),o.each(t.sections,function(t,e){this.options.sections[e]=t},this),delete t.sections,o.extend(this.options,t),this._unloadViews(),this.updateViews(),this},s.prototype.updateViews=function(){o.each(this.options.sections,this._updateView,this)},s.prototype._updateView=function(t,e){o.each(t,function(t){this._loadView(e,t)},this)},s.prototype._loadView=function(t,e){var i,o;"string"==typeof e.view&&e.view in n?(i=e.view,void 0===this.views[t][i]&&(o=new n[e.view](this.controller,e.options))):e.view.prototype instanceof Object?(i=e.name,void 0===this.views[t][i]?o=new e.view(e.options):this.views[t][i].update(e.options)):"function"==typeof e.view.render&&(i=e.name,void 0===this.views[t][i]&&(o=e.view)),void 0!==o&&(this.views[t][i]=o,this.el.querySelector("."+t).appendChild(o.render().el))},s.prototype._unloadViews=function(){o.each(this.views,function(t,e){o.each(t,function(t,i){o.find(this.options.sections[e],function(t){return t.name===i||t.view===i})||(t.remove(),delete this.views[e][i])},this)},this)},s.prototype._template=function(){return'<div class="column left"></div><div class="column center"></div><div class="column right"></div>'},s}),i("common/element_factory",[],function(){function t(){return e={},this}var e;return t.prototype.claim=function(t){return e[t]||(e[t]=[]),0===e[t].length&&this._buildObject(t),e[t].pop()},t.prototype._buildObject=function(t){var i=document.createElement("div");i.innerHTML=t,e[t].push(i.firstChild)},t.prototype.getElements=function(){return e},t.prototype.release=function(t,i){e[t]||(e[t]=[]),e[t].push(i)},t.prototype.clearElements=function(){e={}},t}),i("common/queueable_image",["underscore"],function(t){function e(t){this.callback=t.callback,this.priority=t.priority,this.retryCount=t.retryCount||0,this.url=t.url,this.queue=t.queue}return e.prototype.start=function(){var e=new Image;e.onload=t.bind(this._loadComplete,this),e.onerror=t.bind(this._loadError,this),e.src=this.url},e.prototype.canRetry=function(){return 3>this.retryCount},e.prototype.retryDelay=function(){switch(this.retryCount){case 0:return 1e3;case 1:return 3e3;case 2:return 6e3;default:return null}},e.prototype.attemptingRetry=function(){return++this.retryCount},e.prototype._loadComplete=function(){this.queue._loadComplete(this)},e.prototype._loadError=function(){this.queue._loadError(this)},e}),i("common/image_queue",["common/queueable_image","underscore"],function(t,e){function i(){this._concurrentInProgress=0,this._queued=[]}return i.prototype.add=function(e,i){var o;o=e instanceof t?e:new t({callback:i,queue:this,priority:e.priority,retryCount:0,url:e.url}),e.priority?this._queued.unshift(o):this._queued.push(o),this._spawn()},i.prototype.remove=function(t){var i=e.findIndex(this._queued,{url:t});if(-1<i)return this._queued.splice(i,1)},i.prototype.reset=function(){this._queued=[],this._concurrentInProgress=0},i.prototype._spawn=function(){for(;this._canSpawn();){this._concurrentInProgress++;this._queued.shift().start()}},i.prototype._canSpawn=function(){return 0<this._queued.length&&6>this._concurrentInProgress},i.prototype._loadDone=function(){this._concurrentInProgress--,this._spawn()},i.prototype._loadComplete=function(t){t.callback(!0),this._loadDone()},i.prototype._loadError=function(t){if(t.canRetry()){var i=function(){t.attemptingRetry(),this.add(t)};e.delay(e.bind(i,this),t.retryDelay())}else t.callback(!1);this._loadDone()},i}),i("common/extend",[],function(){function t(t,i){function o(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return o.prototype=i.prototype,t.prototype=new o,t.__super__=i.prototype,t}var e={}.hasOwnProperty;return t}),i("layouts/layout",["common/date_helper","underscore"],function(t,e){function i(t,e,i){return this.controller=e.controller,this.child_map=i,this.child_type=e.layouts,this.layout_opt=e.layout_opt,this.idAttr=e.layout_opt.object_id_attr,this.objects=this._createIdMap(t),this.parent=e.parent||e.controller,this.sorted=[],this}return i.prototype._createIdMap=function(t){for(var e={},i=0;i<t.length;i++)e[t[i][this.idAttr]]=t[i];return e},i.prototype._groupObjects=function(t){void 0===t&&(t=!1);var i=e.filter(this.objects,function(t){return!t.hidden}),o=e.sortBy(i,function(t){return t[this.idAttr]},this),s=e.sortBy(o,this.comparator,this);t&&s.reverse();var n=e.groupBy(s,this._groupObjectsBy,this);this.sorted=s,this.grouped=this._sortObjectByKeys(n,t)},i.prototype._sortObjectByKeys=function(t,e){void 0===e&&(e=!1);var i=Object.keys(t).sort();return e&&i.reverse(),i.reduce(function(e,i){return e[i]=t[i],e},{})},i.prototype._initiateObjects=function(t){e.each(t,function(t,e){var i={controller:this.controller,layouts:this.child_type,layout_opt:this.layout_opt,parent:this,key:e};t.child?t.child.parent=this:t.child=this._loadChild(t,i)},this)},i.prototype._initiateObject=function(t,e){var i={controller:this.controller,layouts:this.child_type,layout_opt:this.layout_opt,parent:this,key:e};t.child=this._loadChild(t,i)},i.prototype._loadChild=function(t,e){for(var i,o=0;o<this.child_type.length;o++)if(this.child_type[o]in this.child_map){i=this.child_type[o];break}return new this.child_map[i](t,e)},i.prototype.resetPositioning=function(){this.grouped?e.each(this.grouped,function(t,e){t.child.resetPositioning()},this):e.each(this.objects,function(t,e){t.child.resetPositioning()},this),e.extend(this.position,this.default_position),this.month&&this.month.resetPositioning(),this.summary&&this.summary.resetPositioning()},i.prototype.buildPositioning=function(){e.each(this.grouped,function(t,e){t.child.buildPositioning()},this),this._buildPositioning(this.grouped)},i.prototype.updateOptions=function(t){var i=!1,o=!0,s=!0;return t&&t.banners&&(this.banners=t.banners,this._updateBanners()),t&&t.default_size&&(e.extend(t,this.layout_opt.object_sizes[t.default_size]),delete t.default_size),e.each(t,function(t,e){this.layout_opt[e]!==t&&(i=!0)},this),i?((t.hasOwnProperty("group_by_attr")&&this.layout_opt.group_by_attr!==t.group_by_attr||t.hasOwnProperty("sort_by_attr")&&this.layout_opt.sort_by_attr!==t.sort_by_attr||t.hasOwnProperty("reverse_sort")&&this.layout_opt.reverse_sort!==t.reverse_sort)&&(o=!1),(t.minimal&&this.layout_opt.minimal!==t.minimal||t.read_only&&this.layout_opt.read_only!==t.read_only)&&(s=!1),e.extend(this.layout_opt,t),o?(this.resetPositioning(),this.buildPositioning()):this.reload({keepSort:o}),{keepSort:o,refresh:s}):{refresh:!1}},i.prototype._updateObjects=function(t){var i={};return e.each(t,function(t){var o,s=t[this.idAttr];if(e.isArray(this.objects)){var n={};n[this.idAttr]=s,o=e.find(this.objects,n)}else o=this.objects[s];if(o)if(o.hidden&&!t.hidden)e.extend(o,t),this.addObjects([o],!0),i={refresh:!0};else if(!o.hidden&&t.hidden)e.extend(o,t),this.removeObjects([s],!0),i={refresh:!0};else if(t[this.layout_opt.group_by_attr])this.removeObjects([s]),e.extend(o,t),this.addObjects([o]),i={refresh:!0};else{var r=this._groupObjectsBy(o),a=this.grouped[r];a?(i=a.child._updateObjects([t]),a.child.summary&&a.child.summary.allSelected()):(e.extend(this.objects[s],t),i={refresh:!0})}},this),i},i.prototype.updateObjects=function(t){return forceUpdate=this._updateObjects(t),forceUpdate.refresh&&(this.resetPositioning(),this.buildPositioning()),e.filter(this.objects,function(t){return!t.hidden}).length},i.prototype.addObjects=function(t,i){void 0===i&&(i=!1);var o=[],s=function(t){var e=t[this.layout_opt.sort_by_attr];return isNaN(e)?e:e*(this.layout_opt.reverse_sort?-1:1)};return e.each(t,function(t){var n=t[this.idAttr];if((i||!e.has(this.objects,n))&&(o.push(t),this.objects[n]=t,!t.hidden&&e.isObject(this.grouped))){var r=this._groupObjectsBy(t);e.has(this.grouped,r)||(this.grouped[r]=[],this.grouped=this._sortObjectByKeys(this.grouped,this.layout_opt.reverse_sort),this._initiateObject(this.grouped[r],r));var a=e.sortedIndex(this.sorted,t,s,this);this.sorted.splice(a,0,t);var h=e.sortedIndex(this.grouped[r],t,s,this);this.grouped[r].splice(h,0,t),this.grouped[r].child.addObjects&&this.grouped[r].child.addObjects([t])}},this),this.summary&&this.summary.update(),o.length>0},i.prototype.removeObjects=function(t,i){void 0===i&&(i=!1);var o=[];return e.each(t,function(t){var s=this.objects[t];if(s){o.push(t);var n=this._groupObjectsBy(s);if(n in this.grouped){this.grouped[n].child.removeObjects([s[this.idAttr]]);var r=e.indexOf(this.sorted,s);r>-1&&this.sorted.splice(r,1);var a=e.indexOf(this.grouped[n],s);a>-1&&this.grouped[n].splice(a,1),0===this.grouped[n].length&&(this.grouped[n].child.month&&this.grouped[n].child.month.remove(),this.grouped[n].child.summary&&this.grouped[n].child.summary.remove(),delete this.grouped[n]),this.grouped=this._sortObjectByKeys(this.grouped,this.layout_opt.reverse_sort)}}i||delete this.objects[t]},this),this.summary&&this.summary.update(),o.length>0},i.prototype.hasObjects=function(t){return e.some(this.objects,function(i){return e.some(t,function(t,e){return i[e]===t})})},i.prototype.allObjects=function(t){return e.every(this.objects,function(i){return e.every(t,function(t,e){return i[e]===t})})},i.prototype.getFirstObject=function(){var t;return this.sorted.length>0&&(t=this.sorted[0]),t},i.prototype.getLastObject=function(){var t;return this.sorted.length>0&&(t=this.sorted[this.sorted.length-1]),t},i.prototype.getObjectCount=function(){return Object.keys(this.objects).length},i.prototype.nextObject=function(t,i){function o(t,e){a=r[e]!==t}var s,n=e.indexOf(this.sorted,this.objects[t]);if(-1===n)return null;for(var r,a=!1;!s;)n++,n>this.sorted.length&&(n=0),(r=this.sorted[n])&&!r.hidden&&(e.each(i,o),a||(s=r));return s[this.idAttr]},i.prototype.previousObject=function(t,i){function o(t,e){a=r[e]!==t}
var s,n=e.indexOf(this.sorted,this.objects[t]);if(-1===n)return null;for(var r,a=!1;!s;)n--,n<0&&(n=this.sorted.length),(r=this.sorted[n])&&!r.hidden&&(e.each(i,o),a||(s=r));return s[this.idAttr]},i.prototype.objectRange=function(t,i){var o=e.indexOf(this.sorted,this.objects[t]),s=e.indexOf(this.sorted,this.objects[i]),n=Math.min(o,s),r=Math.max(o,s)+1;return e.pluck(this.sorted.slice(n,r),this.idAttr)},i.prototype.reload=function(t){void 0===t&&(t={}),this.resetPositioning(),this.remove(),t.objects&&(this.objects=this._createIdMap(t.objects)),t.resize&&(this.header&&this.header.updateDimensions(),this.footer&&this.footer.updateDimensions()),t.keepSort||this._groupObjects(this.layout_opt.reverse_sort),this._initiateObjects(this.grouped),this.buildPositioning()},i.prototype.render=function(t,i,o,s){e.each(this.grouped,function(e){e.child&&(i<=e.collection.position.top+e.child.position.top+e.child.position.height&&i+s>=e.collection.position.top+e.child.position.top?e.child.render(t,i,o,s):e.child.remove())},this)},i.prototype.remove=function(){e.each(this.grouped,function(t){t.child&&t.child.remove()},this)},i.prototype.updateDimensions=function(){if(this.options.updateDimensions){var t=this.options.updateDimensions(this.controller.getDimensions());t&&(t.width&&(this.position.width=t.width),t.height&&(this.position.height=t.height))}},i.prototype.getPositionAtDate=function(i,o){void 0===o&&(o=!1);var s=t.getUTCDate(i),n=this.layout_opt.sort_by_attr,r=e.find(this.objects,function(e){if(t.areEqual(s,e[n]))return!0}),a=0,h=0;if(o||(h=Math.round(this.controller.getDimensions().height/2)),void 0===r){var l=e.findKey(this.objects,function(t){if(s.valueOf()>t[n])return!0});return r=this.objects[l],r&&(a=r.child.getPosition()),a>=h&&(a-=h),a}return a=r.child.getPosition(),a>=h&&(a-=h),a},i.prototype.getPositionAtObject=function(t,e){void 0===e&&(e=!1);var i=this.objects[t];if(void 0===i||i.hidden)return 0;var o=i.child.getPosition(!0),s=this.controller.vertical?this.position.height:this.position.width,n={object:i.child.position,viewport:this.controller.getDimensions()},r={object:Math.round((this.controller.vertical?n.object.height:n.object.width)/2),viewport:Math.round((this.controller.vertical?n.viewport.height:n.viewport.width)/2),viewport_threshold:Math.round(.8*(this.controller.vertical?n.viewport.height:n.viewport.width))};if(o<r.viewport_threshold)o=0;else if(!e&&o+r.viewport<s)o-=r.viewport-r.object;else{o-=55}return o},i.prototype.getDateAtPosition=function(t,i){void 0===i&&(i=!1);var o=null,s=null;if(this.controller.vertical?(o="top",s="height"):(o="left",s="width"),!i){var n=Math.round(this.controller.getDimensions().height/2);t+=n}t=Math.min(t,this.position[s]);var r=e.find(this.grouped,function(e,i){if(e.child&&t>=e.child.position[o]&&t<e.child.position[o]+e.child.position[s])return!0});return r&&r.child?r.child.date:""},i.prototype.getObjectIdAtPosition=function(t,i){void 0===i&&(i=!1);var o=null,s=null;if(this.controller.vertical?(o="top",s="height"):(o="left",s="width"),!i){var n=Math.round(this.controller.getDimensions().height/2);t+=n}if(e.isEmpty(this.grouped))return null;var r=[],a=[];r.push({child:this.header&&this.header.child?this.header.child:void 0}),a.push({child:this.footer&&this.footer.child?this.footer.child:void 0}),r.child=this.header&&this.header.child?this.header.child:void 0,a.child=this.footer&&this.footer.child?this.footer.child:void 0;var h=e.extend({},{header:r},this.grouped,{footer:a}),l=e.find(h,function(e,i){if(e.child&&t>=e.child.position[o]&&t<e.child.position[o]+e.child.position[s])return!0});l||(l=e.min(this.grouped,function(t){return t.child.position[o]}),t>l.child.position[o]&&(l=e.max(this.grouped,function(t){return t.child.position[o]})));var u=e.find(l,function(e,i){if(e.child){var n=e.child.parent;if(n===l.child){if(t>=l.child.position[o]+e.child.position[o]&&t<l.child.position[o]+e.child.position[o]+e.child.position[s])return!0}else if(t>=l.child.position[o]+n.position[o]+e.child.position[o]&&t<l.child.position[o]+n.position[o]+e.child.position[o]+e.child.position[s])return!0}});return u||(u=t<l.child.position[o]+e.first(l).child.position[o]?e.first(l):e.last(l)),u[this.idAttr]},i.prototype.comparator=function(t){return t[this.layout_opt.sort_by_attr]},i.prototype._groupObjectsBy=function(t){return t[this.layout_opt.group_by_attr]},i}),i("views/base",["underscore"],function(t){function e(t){this.el=null,this.rendered=!1,this.parent=t.parent,this.controller=t.controller,this.container=t.container||t.controller._layout_container,this.factory=t.controller.factory,this.layout_opt=t.layout_opt,this.default_position={top:0,left:0,width:0,height:0},this.position={top:0,left:0,width:0,height:0}}return e.prototype.render=function(t,e,i,o){return this.rendered?(this.updatePositions(t,e,i,o),!1):(this.el=this.factory.claim(this._getTemplate()),this.container.appendChild(this.el),this.updatePositions(t,e,i,o),this.rendered=!0,this)},e.prototype.remove=function(){return this.rendered&&(this.el.removeAttribute("style"),this.container.removeChild(this.el),this.factory.release(this._getTemplate(),this.el),this.rendered=!1,this.el=null),this},e.prototype.setPosition=function(e){this.position.top=e&&!t.isUndefined(e.top)?e.top:this.position.top,this.position.left=e&&!t.isUndefined(e.left)?e.left:this.position.left,this.position.width=e&&!t.isUndefined(e.width)?e.width:this.position.width,this.position.height=e&&!t.isUndefined(e.height)?e.height:this.position.height},e.prototype.resetPositioning=function(){this.position=t.extend(this.position,this.default_position)},e.prototype.getTop=function(){return this.position.top},e.prototype.getLeft=function(){return this.position.left},e.prototype.getWidth=function(){return this.position.width},e.prototype.getHeight=function(){return this.position.height},e.prototype.updatePositions=function(t,e,i,o){for(var s=0,n=0,r=this.parent;r&&r.position;)s+=r.position.top||0,n+=r.position.left||0,r=r.parent;var a={width:this.position.width,height:this.position.height,x:Math.round(n+this.position.left-t),y:Math.round(s+this.position.top-e),z:0};this.el&&(a.width>0&&a.height>0&&(this.el.style.width=a.width+"px",this.el.style.height=a.height+"px"),this.el.style.transform="translate3d("+a.x+"px, "+a.y+"px, "+a.z+"px)")},e.prototype._getTemplate=function(){return""},e}),i("views/banner",["common/extend","views/base"],function(t,e){function i(t){i.__super__.constructor.call(this,t),this.banner_options=t.banner_options,this.banner_element=t.banner_options.el}return t(i,e),i.prototype.remove=function(){if(this.el)for(var t=this.el.lastChild;t;)this.el.removeChild(t),t=this.el.lastChild;i.__super__.remove.call(this)},i.prototype.updatePositions=function(t,e,i,o){var s={width:this.position.width,height:this.position.height,x:this.position.left-t,y:this.position.top-e,z:0};this.el&&(this.el.appendChild(this.banner_element),s.width>0&&s.height>0&&(this.banner_element.style.width=s.width+"px",this.banner_element.style.height=s.height+"px"),this.el.style.transform="translate3d("+s.x+"px, "+s.y+"px, "+s.z+"px)")},i.prototype._getTemplate=function(){return'<div class="banner-container"></div>'},i}),i("layouts/vertical_banner",["common/extend","layouts/layout","views/banner","underscore"],function(t,e,i,o){function s(t,e){return this.controller=e.controller,this.options=e.banner_options,this.position={top:0,left:0,width:e.banner_options.width,height:e.banner_options.height},this.updates={},this.child=new i({parent:this,controller:this.controller,banner_options:e.banner_options}),this.child.setPosition({width:this.position.width,height:this.position.height}),this}t(s,e);return s.prototype.remove=function(){this.child.remove()},s.prototype.render=function(t,e,i,o){this.child.render(t,e,i,o)},s.prototype.update=function(t){void 0===t&&(t={});var e=!1;o.each(t,function(t,i){i in this.updates?this.updates[i]!==t&&(this.updates[i]=t,e=!0):(this.updates[i]=t,e=!0)},this),e&&this.options.update&&this.options.update(t)},s.prototype.updateDimensions=function(){s.__super__.updateDimensions.call(this),this.child.setPosition({width:this.position.width,height:this.position.height})},s}),i("views/date_summary",["views/base","common/date_helper","common/extend","underscore"],function(t,e,i,o){function s(t){return s.__super__.constructor.call(this,t),this.objects=t.objects,this.date=t.date,this.options=t.options,this.selected=null,this.type=t.type,this}i(s,t);return s.prototype.render=function(t,e,i,o){return s.__super__.render.call(this,t,e,i,o)?(this._bindEvents(),this.updatePositions(t,e,i,o),this.el.classList.add(this.type),this.position.width&&(this.el.style.minWidth=this.position.width+"px"),this.el.querySelector(".group").textContent=this.dateFormat(),this._updateCount(),(this.controller.touch&&!1===this.options.mobile||!0===this.options.hide_checkmark)&&this.el.classList.add("no-checkmark"),this.allSelected()):this.rendered&&(this.el.querySelector(".group").textContent=this.dateFormat()),this},s.prototype.remove=function(){return this.rendered&&(this.el.classList.remove(this.type),this.el.classList.remove("selected"),this.el.classList.remove("no-checkmark"),this._unbindEvents()),s.__super__.remove.call(this),this},s.prototype.update=function(){this.el&&this._updateCount()},s.prototype.dateFormat=function(){var t="";switch(this.type){case"month":t=this.controller.compressed?e.formatDate(this.date,"MMM YYYY"):e.formatDate(this.date,"MMMM YYYY");break;case"day":t=e.formatDate(this.date,"ddd D")}return t},s.prototype.allSelected=function(){o.every(this.objects,function(t){return t.selected})?(this.el&&this.el.classList.add("selected"),this.selected=!0,"month"===this.type&&this.controller.actionbar.updateDateSummary(this.date,this._getCount(),{selected:!0})):(this.el&&this.el.classList.remove("selected"),this.selected=!1,"month"===this.type&&this.controller.actionbar.updateDateSummary(this.date,this._getCount(),{selected:!1}))},s.prototype.isSelected=function(){return null===this.selected?o.every(this.objects,function(t){return t.selected}):this.selected},s.prototype._getCount=function(){return this.objects.length?this.objects.length:Object.keys(this.objects).length},s.prototype._updateCount=function(){var t=this._getCount();this.el.querySelector(".pill").textContent=t,"month"===this.type&&this.controller.actionbar.updateDateSummary(this.date,t)},s.prototype._bindEvents=function(){this.el&&(o.bindAll(this,"_onClick"),this.el.addEventListener("click",this._onClick,!1))},s.prototype._unbindEvents=function(){this.el&&this.el.removeEventListener("click",this._onClick,!1)},s.prototype._onClick=function(t){if(!(this.controller.touch&&!1===this.options.mobile||this.el&&this.el.classList.contains("no-checkmark"))){var e=t.target,i=o.pluck(this.objects,this.parent.idAttr);e.classList.contains("pill")?(this.controller.clickCb(i,"select",t),this.controller._track({name:"select-group",type:this.type})):e.classList.contains("group")&&(this.controller.clickCb(i,"select-date",t),this.controller._track({name:"select-date",type:this.type}))}},s.prototype._getTemplate=function(){return'<div class="pmc-summary"><div class="pill"></div><div class="group"></div></div>'},s}),i("common/moment_helper",[],function(){function t(t,e){var i=e/t;return t<=100&&100*i<4e3||315*i>4e3?"x-small":t<=315&&315*i<4e3||720*i>4e3?"small":t<=720&&720*i<4e3||1600*i>4e3?"medium":t<=1600&&1600*i<4e3||2048*i>4e3?"large":"x-large"}function e(t,e,o,s,n){return void 0===s&&(s=Date.now()),"https://"+i(n)+"/ng/services/mediarender/THISLIFE/"+e+"/media/"+t+"/"+o+"/"+s+"/enhance"}function i(t){var e;switch(t){case"beta":case"int":e="uniim1.beta.shutterfly.com";break;case"dev":case"delta":e="uniim1.dev.shutterfly.com";break;case"foxtrot":e="uniim1.foxtrot.shutterfly.com";break;case"stage":e="uniim1.stage.shutterfly.com";break;default:e="uniim1.shutterfly.com"}return e}return{getImageSize:t,getImageSource:e}}),function(t,e,o){"object"==typeof exports?module.exports=o():"function"==typeof i&&i.amd?i("deepcopy",o):e.dcopy=o()}(0,this,function(){function t(t,e,i){return t instanceof Array?(t.push(i),t[t.length-1]):t instanceof Object?(t[e]=i,t[e]):void 0}return function(e){function i(e,o){for(var s in e){var n=e[s];if(n instanceof Date){var r=new Date(n.getTime());t(o,s,r)}else if(n instanceof Function){var r=n;t(o,s,r)}else if(n instanceof Array){var r=[],a=t(o,s,r);i(n,a)}else if(n instanceof Object){var r={},a=t(o,s,r);i(n,a)}else{var r=n;t(o,s,r)}}}if(/number|string|boolean/.test(typeof e))return e;if(e instanceof Date)return new Date(e.getTime());var o=e instanceof Array?[]:{};return i(e,o),o}}),function(t,e,o){"undefined"!=typeof module&&module.exports?module.exports=o():"function"==typeof i&&i.amd?i("bowser",o):t.bowser=o()}(this,0,function(){function t(t){function e(e){var i=t.match(e);return i&&i.length>1&&i[1]||""}function i(e){var i=t.match(e);return i&&i.length>1&&i[2]||""}var s,n=e(/(ipod|iphone|ipad)/i).toLowerCase(),a=/like android/i.test(t),h=!a&&/android/i.test(t),l=/nexus\s*[0-6]\s*/i.test(t),u=!l&&/nexus\s*[0-9]+/i.test(t),c=/CrOS/.test(t),d=/silk/i.test(t),p=/sailfish/i.test(t),f=/tizen/i.test(t),m=/(web|hpw)(o|0)s/i.test(t),_=/windows phone/i.test(t),y=(/SamsungBrowser/i.test(t),!_&&/windows/i.test(t)),v=!n&&!d&&/macintosh/i.test(t),g=!h&&!p&&!f&&!m&&/linux/i.test(t),b=i(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),w=e(/version\/(\d+(\.\d+)?)/i),k=/tablet/i.test(t)&&!/tablet pc/i.test(t),S=!k&&/[^-]mobi/i.test(t),x=/xbox/i.test(t);/opera/i.test(t)?s={name:"Opera",opera:r,version:w||e(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?s={name:"Opera",opera:r,version:e(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||w}:/SamsungBrowser/i.test(t)?s={name:"Samsung Internet for Android",samsungBrowser:r,version:w||e(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(t)?s={name:"NAVER Whale browser",whale:r,version:e(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(t)?s={name:"MZ Browser",mzbrowser:r,version:e(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(t)?s={name:"Opera Coast",coast:r,version:w||e(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(t)?s={name:"Focus",focus:r,version:e(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(t)?s={name:"Yandex Browser",yandexbrowser:r,version:w||e(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?s={name:"UC Browser",ucbrowser:r,version:e(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?s={name:"Maxthon",maxthon:r,version:e(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?s={name:"Epiphany",epiphany:r,version:e(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?s={name:"Puffin",puffin:r,version:e(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?s={name:"Sleipnir",sleipnir:r,version:e(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?s={name:"K-Meleon",kMeleon:r,version:e(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:_?(s={name:"Windows Phone",osname:"Windows Phone",windowsphone:r},b?(s.msedge=r,s.version=b):(s.msie=r,s.version=e(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?s={name:"Internet Explorer",msie:r,version:e(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:c?s={name:"Chrome",osname:"Chrome OS",chromeos:r,chromeBook:r,chrome:r,version:e(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?s={name:"Microsoft Edge",msedge:r,version:b}:/vivaldi/i.test(t)?s={name:"Vivaldi",vivaldi:r,version:e(/vivaldi\/(\d+(\.\d+)?)/i)||w}:p?s={name:"Sailfish",osname:"Sailfish OS",sailfish:r,version:e(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?s={name:"SeaMonkey",seamonkey:r,version:e(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(s={name:"Firefox",firefox:r,version:e(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(s.firefoxos=r,s.osname="Firefox OS")):d?s={name:"Amazon Silk",silk:r,version:e(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?s={name:"PhantomJS",phantom:r,version:e(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?s={name:"SlimerJS",slimer:r,version:e(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?s={name:"BlackBerry",osname:"BlackBerry OS",blackberry:r,version:w||e(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:m?(s={name:"WebOS",osname:"WebOS",webos:r,version:w||e(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(s.touchpad=r)):/bada/i.test(t)?s={name:"Bada",osname:"Bada",bada:r,version:e(/dolfin\/(\d+(\.\d+)?)/i)}:f?s={name:"Tizen",osname:"Tizen",tizen:r,version:e(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||w}:/qupzilla/i.test(t)?s={name:"QupZilla",qupzilla:r,version:e(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||w}:/chromium/i.test(t)?s={name:"Chromium",chromium:r,version:e(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||w}:/chrome|crios|crmo/i.test(t)?s={name:"Chrome",chrome:r,version:e(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:h?s={name:"Android",version:w}:/safari|applewebkit/i.test(t)?(s={name:"Safari",safari:r},w&&(s.version=w)):n?(s={name:"iphone"==n?"iPhone":"ipad"==n?"iPad":"iPod"},w&&(s.version=w)):s=/googlebot/i.test(t)?{name:"Googlebot",googlebot:r,version:e(/googlebot\/(\d+(\.\d+))/i)||w}:{name:e(/^(.*)\/(.*) /),version:i(/^(.*)\/(.*) /)},!s.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(s.name=s.name||"Blink",s.blink=r):(s.name=s.name||"Webkit",s.webkit=r),!s.version&&w&&(s.version=w)):!s.opera&&/gecko\//i.test(t)&&(s.name=s.name||"Gecko",s.gecko=r,s.version=s.version||e(/gecko\/(\d+(\.\d+)?)/i)),s.windowsphone||!h&&!s.silk?!s.windowsphone&&n?(s[n]=r,s.ios=r,s.osname="iOS"):v?(s.mac=r,s.osname="macOS"):x?(s.xbox=r,s.osname="Xbox"):y?(s.windows=r,s.osname="Windows"):g&&(s.linux=r,s.osname="Linux"):(s.android=r,s.osname="Android");var M="";s.windows?M=function(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(e(/Windows ((NT|XP)( \d\d?.\d)?)/i)):s.windowsphone?M=e(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):s.mac?(M=e(/Mac OS X (\d+([_\.\s]\d+)*)/i),M=M.replace(/[_\s]/g,".")):n?(M=e(/os (\d+([_\s]\d+)*) like mac os x/i),M=M.replace(/[_\s]/g,".")):h?M=e(/android[ \/-](\d+(\.\d+)*)/i):s.webos?M=e(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):s.blackberry?M=e(/rim\stablet\sos\s(\d+(\.\d+)*)/i):s.bada?M=e(/bada\/(\d+(\.\d+)*)/i):s.tizen&&(M=e(/tizen[\/\s](\d+(\.\d+)*)/i)),M&&(s.osversion=M);var O=!s.windows&&M.split(".")[0];return k||u||"ipad"==n||h&&(3==O||O>=4&&!S)||s.silk?s.tablet=r:(S||"iphone"==n||"ipod"==n||h||l||s.blackberry||s.webos||s.bada)&&(s.mobile=r),s.msedge||s.msie&&s.version>=10||s.yandexbrowser&&s.version>=15||s.vivaldi&&s.version>=1||s.chrome&&s.version>=20||s.samsungBrowser&&s.version>=4||s.whale&&1===o([s.version,"1.0"])||s.mzbrowser&&1===o([s.version,"6.0"])||s.focus&&1===o([s.version,"1.0"])||s.firefox&&s.version>=20||s.safari&&s.version>=6||s.opera&&s.version>=10||s.ios&&s.osversion&&s.osversion.split(".")[0]>=6||s.blackberry&&s.version>=10.1||s.chromium&&s.version>=20?s.a=r:s.msie&&s.version<10||s.chrome&&s.version<20||s.firefox&&s.version<20||s.safari&&s.version<6||s.opera&&s.version<10||s.ios&&s.osversion&&s.osversion.split(".")[0]<6||s.chromium&&s.version<20?s.c=r:s.x=r,s}function e(t){return t.split(".").length}function i(t,e){var i,o=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(i=0;i<t.length;i++)o.push(e(t[i]));return o}function o(t){for(var o=Math.max(e(t[0]),e(t[1])),s=i(t,function(t){var s=o-e(t);return t+=new Array(s+1).join(".0"),i(t.split("."),function(t){return new Array(20-t.length).join("0")+t}).reverse()});--o>=0;){if(s[0][o]>s[1][o])return 1;if(s[0][o]!==s[1][o])return-1;if(0===o)return 0}}function s(e,i,s){var n=a;"string"==typeof i&&(s=i,i=void 0),void 0===i&&(i=!1),s&&(n=t(s));var r=""+n.version;for(var h in e)if(e.hasOwnProperty(h)&&n[h]){if("string"!=typeof e[h])throw new Error("Browser version in the minVersion map should be a string: "+h+": "+String(e));return o([r,e[h]])<0}return i}function n(t,e,i){return!s(t,e,i)}var r=!0,a=t("undefined"!=typeof navigator?navigator.userAgent||"":"");return a.test=function(t){for(var e=0;e<t.length;++e){var i=t[e];if("string"==typeof i&&i in a)return!0}return!1},a.isUnsupportedBrowser=s,a.compareVersions=o,a.check=n,a._detect=t,a.detect=t,a}),i("bowser",function(){}),i("views/scalable_moment",["views/base","common/moment_helper","common/extend","deepcopy","underscore","bowser"],function(t,e,i,o,s,n){function r(t,e){return r.__super__.constructor.call(this,e),this.model=t,this.id=this.model[e.layout_opt.object_id_attr],this.src=null,this.uid_attr=e.layout_opt.object_id_attr,this.iQueue=e.controller.image_queue,this.height=e.layout_opt.min_height,this.max_height=e.layout_opt.max_height,this.lock_drawer=e.layout_opt.lock_drawer,this.read_only=e.layout_opt.read_only,this.sort_by=e.layout_opt.sort_by_attr,this}i(r,t);var a=n.mobile||n.tablet;return r.prototype.render=function(t,e,i,o){if(r.__super__.render.call(this,t,e,i,o)){this.el.setAttribute("data-uid",this.id),this.el.classList.add("scalable");var s;this.layout_opt.overlay?(this.overlay=new this.layout_opt.overlay,s=this.overlay.render().el):(s=document.createElement("div"),s.classList.add("action-menu")),this.el.querySelector(".overlay").appendChild(s),this.updatePositions(t,e,i,o),this.setImageSource(),this._setIcons(),this._updateEffects(),this._updateRestrictions(),this._bindEvents()}else this.rendered&&(this._updateRestrictions(),null===this.src&&this.setImageSource());return this},r.prototype.remove=function(){return this.rendered&&(this.el.className="moment",this.overlay&&(this.overlay.remove(),this.overlay=null),this.el.querySelector(".overlay").innerHTML="",this._removeIcons(),this._unbindEvents(),this.clearImageSource()),r.__super__.remove.call(this),this},r.prototype.resetPositioning=function(){r.__super__.resetPositioning.call(this),this.height===this.layout_opt.min_height&&this.max_height===this.layout_opt.max_height||(this.src=null),this.height=this.layout_opt.min_height,this.max_height=this.layout_opt.max_height,this.lock_drawer=this.layout_opt.lock_drawer,this.read_only=this.layout_opt.read_only,this.sort_by=this.layout_opt.sort_by_attr},r.prototype.setScale=function(t){if(t&&t.width&&t.height)this.position.width=t.width,this.position.height=t.height;else{var e=Math.floor(this.model.width*(this.height/this.model.height));this.position.width=e,this.position.height=this.height}},r.prototype.update=function(t){var e={keepSort:!1,refresh:!1};return(t.width&&t.width!==this.model.width||t.height&&t.height!==this.model.height||t.effects_modified_date&&t.effects_modified_date!==this.model.effects_modified_date)&&(this.src=null,e.refresh=!0,e.keepSort=!0),(t[this.sort_by]&&t[this.sort_by]!==this.model[this.sort_by]||t.moment_date&&"moment_date"===this.model[this.sort_by]&&t.moment_date!==this.model.moment_date||t.upload_date&&"upload_date"===this.model[this.sort_by]&&t.upload_date!==this.model.upload_date||void 0!==t.hidden)&&(e.refresh=!0),this._updateEffects(t),s.extend(this.model,t),this.model.actions&&o(this.model.actions,t.actions),e},r.prototype.getPosition=function(t){void 0===t&&(t=!1);for(var e=0,i=this.parent;i&&i.position&&i.position.top;)e+=i.position.top,i=i.parent;return t&&(e+=this.position.top),e},r.prototype.setImageSource=function(){if(null===this.src)if(this.model.src)"function"==typeof this.model.src?this.src=this.model.src(this.position.width,this.position.height):this.src=this.model.src;else{var t=Math.min(this.position.width,this.position.height),i=Math.max(this.position.width,this.position.height),o=e.getImageSize(t,i),n=this.controller.life_uid;this.model.story_moment_created_by&&(n=this.model.story_moment_created_by),this.src=e.getImageSource(this.id,n,o,this.model.effects_modified_date,this.controller.environment)}var r=s.bind(function(t){t&&this.el&&(this.el.querySelector("img").src=this.src,this.controller.isFirstImageLoaded()||(this.controller._track({name:"firstPhoto",type:"time",value:performance.now()}),this.controller.setFirstImageLoaded()))},this);this.iQueue.add({priority:!1,url:this.src},r)},r.prototype.clearImageSource=function(){this.iQueue.remove(this.src),this.el.querySelector("img").src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAkKAAEALAAAAAABAAEAAAICTAEAOw=="},r.prototype._setIcons=function(){if(s.each(this.layout_opt.moment_icons,function(t,e){s.each(t,function(t,i){if(!s.isEmpty(t)){var o=document.createElement("div");o.classList.add("pmc-icon"),o.classList.add(t.class),this.model.actions&&this.model.actions[t.class]&&(this.model.actions[t.class].disabled&&o.classList.add("disabled"),this.model.actions[t.class].hidden&&o.classList.add("hidden")),t.action&&o.setAttribute("action",t.action);var r=0+44*i;o.style[e]=r+"px",o.style.right="view"===t.action&&n.mobile?"-6px":0,this.el.appendChild(o)}},this)},this),"video"===this.model.moment_type){var t=document.createElement("div");t.classList.add("pmc-icon"),t.classList.add("play"),t.setAttribute("action","play"),this.el.appendChild(t)}},r.prototype._removeIcons=function(){var t=this.el.querySelectorAll(".pmc-icon");s.each(t,function(t){this.el.removeChild(t)},this)},r.prototype._updateEffects=function(t){if(void 0===t&&(t=this.model),"rating"in t&&this.el)if(t.rating>0){var e=this.el.querySelector(".pmc-icon.favorite");e&&(e.classList.remove("pulse"),s.defer(function(){e.classList.add("pulse")})),this.el.classList.add("favorite")}else this.el.classList.remove("favorite");"selected"in t&&this.el&&(t.selected?this.el.classList.add("selected"):this.el.classList.remove("selected")),"moment_type"in t&&this.el&&("video"===t.moment_type?this.el.classList.add("video"):this.el.classList.remove("video")),"disabled"in t&&this.el&&(t.disabled?this.el.classList.add("disabled"):this.el.classList.remove("disabled"))},r.prototype._updateRestrictions=function(){this.rendered&&this.el&&(this.lock_drawer?this.el.classList.add("show-all"):this.el.classList.remove("show-all"),this.read_only?this.el.classList.add("read-only"):this.el.classList.remove("read-only"))},r.prototype._bindEvents=function(){this.el&&(a||(s.bindAll(this,"_onMouseover","_onMouseleave"),this.el.addEventListener("mouseover",this._onMouseover,!1),this.el.addEventListener("mouseleave",this._onMouseleave,!1)),s.bindAll(this,"_onClick","_onDblClick"),this.el.addEventListener("click",this._onClick,!1),this.el.addEventListener("dblclick",this._onDblClick,!1))},r.prototype._unbindEvents=function(){this.el&&(n.mobile||n.tablet?(this.el.removeEventListener("click",this._onClick,!1),this.el.removeEventListener("dblclick",this._onDblClick,!1)):(this.el.removeEventListener("click",this._onClick,!1),this.el.removeEventListener("dblclick",this._onDblClick,!1),this.el.removeEventListener("mouseover",this._onMouseover,!1),this.el.removeEventListener("mouseout",this._onMouseleave,!1)))},r.prototype._onClick=function(t){var e=t.target,i="click";return!!this.model.disabled||(e.hasAttribute("action")&&(i=e.getAttribute("action")),!(!this.model.disabledActions||-1!==["click","view"].indexOf(i))||(!(!this.model.actions||!this.model.actions[i]||!this.model.actions[i].disabled&&!this.model.actions[i].hidden)||(this.controller.clickCb([this.id],i,t),this.controller._track({name:"click",type:i}),!0)))},r.prototype._onDblClick=function(t){var e=t.target;if(this.model.disabled||e.classList.contains("pmc-icon"))return!0;this.controller.clickCb([this.id],"view",t),this.controller._track({name:"double-click",type:"view"})},r.prototype._onMouseover=function(t){this.parent.summary&&this.parent.summary.el&&this.parent.summary.el.classList.add("force-visible")},r.prototype._onMouseleave=function(t){if(this.el&&!this.el.classList.contains("favorite")){var e=this.el.querySelector(".pmc-icon.favorite");e&&e.classList.remove("pulse")}this.parent.summary&&this.parent.summary.el&&this.parent.summary.el.classList.remove("force-visible")},r.prototype._getTemplate=function(){return'<div class="moment"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAkKAAEALAAAAAABAAEAAAICTAEAOw=="/><div class="overlay"></div><div class="check-mark"></div></div>'},r}),i("views/square_moment",["views/base","common/moment_helper","common/extend","deepcopy","underscore","bowser"],function(t,e,i,o,s,n){function r(t,e){return r.__super__.constructor.call(this,e),this.model=t,this.id=this.model[e.layout_opt.object_id_attr],this.src=null,this.uid_attr=e.layout_opt.object_id_attr,this.iQueue=e.controller.image_queue,this.height=e.layout_opt.min_height,this.max_height=e.layout_opt.max_height,this.lock_drawer=e.layout_opt.lock_drawer,this.read_only=e.layout_opt.read_only,this.sort_by=e.layout_opt.sort_by_attr,this}i(r,t);var a=n.mobile||n.tablet;return r.prototype.render=function(t,e,i,o){if(r.__super__.render.call(this,t,e,i,o)){this.el.setAttribute("data-uid",this.id),this.el.classList.add("pmc-square");var s;this.layout_opt.overlay?(this.overlay=new this.layout_opt.overlay,s=this.overlay.render().el):(s=document.createElement("div"),s.classList.add("action-menu")),this.el.querySelector(".overlay").appendChild(s),this.updatePositions(t,e,i,o),this.setImageSource(),this._setIcons(),this._updateEffects(),this._updateRestrictions(),this._bindEvents()}else this.rendered&&(this._updateRestrictions(),null===this.src&&this.setImageSource());return this},r.prototype.remove=function(){return this.rendered&&(this.el.className="moment",this.overlay&&(this.overlay.remove(),this.overlay=null),this.el.querySelector(".overlay").innerHTML="",this._removeIcons(),this._unbindEvents(),this.clearImageSource()),r.__super__.remove.call(this),this},r.prototype.resetPositioning=function(){r.__super__.resetPositioning.call(this),this.height===this.layout_opt.min_height&&this.max_height===this.layout_opt.max_height&&this.width===this.layout_opt.min_width&&this.max_width===this.layout_opt.max_width||(this.src=null),this.height=this.layout_opt.min_height,this.max_height=this.layout_opt.max_height,this.width=this.layout_opt.min_width,this.max_width=this.layout_opt.max_width,this.lock_drawer=this.layout_opt.lock_drawer,this.read_only=this.layout_opt.read_only,this.sort_by=this.layout_opt.sort_by_attr},r.prototype.setScale=function(t){this.position.width=this.position.height=this.max_height},r.prototype.update=function(t){var e={keepSort:!1,refresh:!1};return(t.width&&t.width!==this.model.width||t.height&&t.height!==this.model.height||t.effects_modified_date&&t.effects_modified_date!==this.model.effects_modified_date)&&(this.src=null,e.refresh=!0,e.keepSort=!0),(t[this.sort_by]&&t[this.sort_by]!==this.model[this.sort_by]||t.moment_date&&"moment_date"===this.model[this.sort_by]&&t.moment_date!==this.model.moment_date||t.upload_date&&"upload_date"===this.model[this.sort_by]&&t.upload_date!==this.model.upload_date||void 0!==t.hidden)&&(e.refresh=!0),this._updateEffects(t),s.extend(this.model,t),this.model.actions&&o(this.model.actions,t.actions),e},r.prototype.getPosition=function(t){void 0===t&&(t=!1);for(var e=0,i=this.parent;i&&i.position&&i.position.top;)e+=i.position.top,i=i.parent;return t&&(e+=this.position.top),e},r.prototype.setImageSource=function(){if(null===this.src)if(this.model.src)"function"==typeof this.model.src?this.src=this.model.src(this.position.width,this.position.height):this.src=this.model.src;else{var t=Math.min(this.position.width,this.position.height),i=Math.max(this.position.width,this.position.height),o=e.getImageSize(t,i),n=this.controller.life_uid;this.model.story_moment_created_by&&(n=this.model.story_moment_created_by),this.src=e.getImageSource(this.id,n,o,this.model.effects_modified_date,this.controller.environment)}var r=s.bind(function(t){t&&this.el&&(this.el.querySelector("img").src=this.src)},this);this.iQueue.add({priority:!1,url:this.src},r)},r.prototype.clearImageSource=function(){this.iQueue.remove(this.src),
this.el.querySelector("img").src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAkKAAEALAAAAAABAAEAAAICTAEAOw=="},r.prototype._setIcons=function(){if(s.each(this.layout_opt.moment_icons,function(t,e){s.each(t,function(t,i){if(!s.isEmpty(t)){var o=document.createElement("div");o.classList.add("pmc-icon"),o.classList.add(t.class),this.model.actions&&this.model.actions[t.class]&&(this.model.actions[t.class].disabled&&o.classList.add("disabled"),this.model.actions[t.class].hidden&&o.classList.add("hidden")),t.action&&o.setAttribute("action",t.action);var n=0+44*i;o.style[e]=n+"px",o.style.right=0,this.el.appendChild(o)}},this)},this),"video"===this.model.moment_type){var t=document.createElement("div");t.classList.add("pmc-icon"),t.classList.add("play"),t.setAttribute("action","play"),this.el.appendChild(t)}},r.prototype._removeIcons=function(){var t=this.el.querySelectorAll(".pmc-icon");s.each(t,function(t){this.el.removeChild(t)},this)},r.prototype._updateEffects=function(t){if(void 0===t&&(t=this.model),"rating"in t&&this.el)if(t.rating>0){var e=this.el.querySelector(".pmc-icon.favorite");e&&(e.classList.remove("pulse"),s.defer(function(){e.classList.add("pulse")})),this.el.classList.add("favorite")}else this.el.classList.remove("favorite");"selected"in t&&this.el&&(t.selected?this.el.classList.add("selected"):this.el.classList.remove("selected")),"moment_type"in t&&this.el&&("video"===t.moment_type?this.el.classList.add("video"):this.el.classList.remove("video")),"disabled"in t&&this.el&&(t.disabled?this.el.classList.add("disabled"):this.el.classList.remove("disabled"))},r.prototype._updateRestrictions=function(){this.rendered&&this.el&&(this.lock_drawer?this.el.classList.add("show-all"):this.el.classList.remove("show-all"),this.read_only?this.el.classList.add("read-only"):this.el.classList.remove("read-only"))},r.prototype._bindEvents=function(){this.el&&(a||(s.bindAll(this,"_onMouseover","_onMouseleave"),this.el.addEventListener("mouseover",this._onMouseover,!1),this.el.addEventListener("mouseleave",this._onMouseleave,!1)),s.bindAll(this,"_onClick","_onDblClick"),this.el.addEventListener("click",this._onClick,!1),this.el.addEventListener("dblclick",this._onDblClick,!1))},r.prototype._unbindEvents=function(){this.el&&(this.el.removeEventListener("click",this._onClick,!1),this.el.removeEventListener("dblclick",this._onDblClick,!1),this.el.removeEventListener("mouseover",this._onMouseover,!1),this.el.removeEventListener("mouseout",this._onMouseleave,!1))},r.prototype._onClick=function(t){var e=t.target,i="click";return!!this.model.disabled||(e.hasAttribute("action")&&(i=e.getAttribute("action")),!(!this.model.disabledActions||"view"===i)||(!(!this.model.actions||!this.model.actions[i]||!this.model.actions[i].disabled&&!this.model.actions[i].hidden)||(this.controller.clickCb([this.id],i,t),this.controller._track({name:"click",type:i}),!0)))},r.prototype._onDblClick=function(t){var e=t.target;if(this.model.disabled||e.classList.contains("pmc-icon"))return!0;this.controller.clickCb([this.id],"view",t),this.controller._track({name:"double-click",type:"view"})},r.prototype._onMouseover=function(t){this.parent.summary&&this.parent.summary.el&&this.parent.summary.el.classList.add("force-visible")},r.prototype._onMouseleave=function(t){if(this.el&&!this.el.classList.contains("favorite")){var e=this.el.querySelector(".pmc-icon.favorite");e&&e.classList.remove("pulse")}this.parent.summary&&this.parent.summary.el&&this.parent.summary.el.classList.remove("force-visible")},r.prototype._getTemplate=function(){return'<div class="moment"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAkKAAEALAAAAAABAAEAAAICTAEAOw=="/><div class="overlay"></div><div class="check-mark"></div></div>'},r}),i("layouts/vertical_day",["common/extend","views/date_summary","layouts/layout","views/scalable_moment","views/square_moment","underscore"],function(t,e,i,o,s,n){function r(t,e){return r.__super__.constructor.call(this,t,e),this.MOMENT_OFFSET=20,this.MONTH_OFFSET=20,this.layout_opt=e.layout_opt,this.group_index=e.layout_opt.object_id_attr,this.date=e.key,this.key=e.key,this.objects=t,this.parent=e.parent,this.container=e.parent.container,this.default_position={top:82,left:0,width:0,height:0},this.position={top:82,left:0,width:0,height:0},this._initiateObjects(this.objects),this}t(r,i);return r.prototype._loadChild=function(t,e){return this.layout_opt.view_object&&"function"==typeof this.layout_opt.view_object?new this.layout_opt.view_object(t,e):new o(t,e)},r.prototype._updateObjects=function(t){var e=t[0],i=e[this.layout_opt.object_id_attr],o={};o[this.layout_opt.object_id_attr]=i;var s=n.find(this.objects,o);if(!s)throw new Error("Object does not exist");return s.child.update(e)},r.prototype.render=function(t,e,i,o){this.summary&&this.summary.render(t,e,i,o),n.each(this.objects,function(s,n){for(var r=this.parent,a=0;r&&r.position&&r.position.top;)a+=r.position.top,r=r.parent;e-.5*o<=a+this.position.top+s.child.position.top+s.child.position.height&&e+1.5*o>=a+this.position.top+s.child.position.top?s.child.render(t,e,i,o):s.child.remove()},this)},r.prototype.remove=function(){this.summary&&this.summary.remove(),n.each(this.objects,function(t,e){t.child.remove()},this)},r.prototype.addObjects=function(t){n.each(t,function(t){this._initiateObject(t)},this),this.summary&&this.summary.update()},r.prototype.removeObjects=function(t){var e={};n.each(t,function(t){e[this.layout_opt.object_id_attr]=t;var i=n.findIndex(this.objects,e);i>=0&&(this.objects[i].child.remove(),this.objects.splice(i,1))},this),this.summary&&this.summary.update()},r.prototype.resetPositioning=function(){r.__super__.resetPositioning.call(this)},r.prototype.buildPositioning=function(){this._buildPositioning(this.objects)},r.prototype._buildPositioning=function(t){var i=this.layout_opt.max_height/this.layout_opt.min_height,o=this.layout_opt.offsets.left+this.layout_opt.offsets.right,s=this.controller.getDimensions().width-o,r=s,a=[],h=0,l=null,u=this.position.top;this.summary||(this.summary=new e({parent:this,date:this.key,type:"day",controller:this.controller,options:this.layout_opt.date_summary,objects:this.objects})),n.each(t,function(t,e){t.child.setPosition({top:u,left:l?l.child.position.left+l.child.position.width+6:this.MOMENT_OFFSET}),t.child.setScale();var o=t.child.getWidth();if(r<o+6){if(a.length>0){var n=(s-6*(a.length-1))/(s-(r+6)-6*(a.length-1));this._scaleRow(a,Math.min(n,i)),u+=l.child.position.height+6,t.child.setPosition({top:u,left:this.MOMENT_OFFSET})}r=s,a=[],h++}r-=o+6,a.push(t),l=t},this);var c=(s-6*(a.length-1))/(s-(r+6)-6*(a.length-1));h>0?(this._scaleRow(a,Math.min(c,i),!0),this.position.width=s):(this._scaleRow(a,Math.min(c,i)),this.position.width=l.child.position.left+l.child.position.width),this.position.height=l.child.position.top+l.child.position.height,this.summary.setPosition({top:this.summary.getTop()+2.7*this.MONTH_OFFSET,left:this.MOMENT_OFFSET,width:this.position.width})},r.prototype._getDateSummary=function(){this.summary||(this.summary=new e({parent:this,date:this.date,type:"day",controller:this.controller,objects:this.objects}))},r.prototype._scaleRow=function(t,e,i){var o=null;i&&(o=Math.round((this.layout_opt.min_height+this.layout_opt.max_height)/2));var s=null;return n.each(t,function(t,i){var n=Math.floor(t.child.getWidth()*e),r=Math.round(t.child.getHeight()*e);if(o&&r>o){var a=o/r;n=Math.floor(n*a),r=Math.round(r*a)}s&&t.child.setPosition({left:s.child.position.left+s.child.position.width+6}),t.child.setScale({width:n,height:r}),s=t},this),{width:s.child.position.left+s.child.position.width,height:s.child.position.top+s.child.position.height}},r.prototype._setupGroupSummary=function(){this.summary||(this.summary=new e({parent:this,date:this.key,type:"month",controller:this.controller,options:this.layout_opt.date_summary,objects:this.objects}))},r.prototype._updateGroupSummary=function(){this.summary&&this.summary.setPosition({top:this.summary.getTop()+2*this.MONTH_OFFSET,left:this.summary.getLeft(),width:this.position.width})},r}),i("views/month_card",["common/extend","views/base","views/date_summary"],function(t,e,i){function o(t){o.__super__.constructor.call(this,t),this.compressed=!1,t.compressed&&(this.compressed=!0)}return t(o,e),o.prototype.render=function(t,e,i,s){o.__super__.render.call(this,t,e,i,s),this.rendered&&this.compressed&&this.el.classList.add("compressed")},o.prototype.remove=function(){this.rendered&&this.compressed&&this.el.classList.remove("compressed"),o.__super__.remove.call(this)},o.prototype.updatePositions=function(t,e,i,o){var s={width:this.position.width,height:this.position.height,x:this.position.left-t,y:this.position.top-e,z:0};this.el&&(s.width>0&&s.height>0&&(this.el.style.width=s.width+"px",this.el.style.height=s.height+"px"),this.el.style.transform="translate3d("+s.x+"px, "+s.y+"px, "+s.z+"px)")},o.prototype._getTemplate=function(){return'<div class="month-bg"><div class="card"></div></div>'},o}),i("layouts/vertical_month",["common/extend","layouts/layout","layouts/vertical_day","views/date_summary","views/month_card","underscore"],function(t,e,i,o,s,n){function r(t,e){return r.__super__.constructor.call(this,t,e),this.MONTH_OFFSET=this.layout_opt.offsets.left,this.date=e.key,this.key=e.key,this.layout_opt=e.layout_opt,this.group_index=e.layout_opt.object_id_attr,this.parent=e.parent,this.default_position={top:0,left:0,width:0,height:0},this.position={top:0,left:0,width:this.controller.getDimensions().width,height:0},this.controller.compressed||(this.position.left=this.layout_opt.offsets.left),this._groupObjects(this.layout_opt.reverse_sort),this._initiateObjects(this.grouped),this}return t(r,e),r.prototype._loadChild=function(t,e){return new i(t,e)},r.prototype.render=function(t,e,i,o){this.month&&this.month.render(t,e,i,o),this.summary&&(e<this.position.top?this.summary.render(t,e,i,o):this.summary.remove()),n.each(this.grouped,function(s,n){e-.5*o<=this.position.top+s.child.position.top+s.child.position.height&&e+1.5*o>=this.position.top+s.child.position.top?s.child.render(t,e,i,o):s.child.remove()},this)},r.prototype.remove=function(){this.month&&this.month.remove(),this.summary&&this.summary.remove(),r.__super__.remove.call(this)},r.prototype.resetPositioning=function(){r.__super__.resetPositioning.call(this),this.position.width=this.controller.getDimensions().width},r.prototype._buildPositioning=function(t){var e=this.MONTH_OFFSET;this.controller.compressed&&(e=0);var i=this.layout_opt.max_height/this.layout_opt.min_height,r=this.controller.getDimensions().width-e,a=r,h=[],l=null,u=this.layout_opt.offsets.top;this.month||(this.month=new s({parent:this,controller:this.controller})),this.summary||(this.summary=new o({parent:this,date:this.date,type:"month",controller:this.controller,options:this.layout_opt.date_summary,objects:this.objects})),n.each(t,function(t,e){if(t.child.position.top=u,t.child.position.height+=this.MONTH_OFFSET,l)if(a<t.child.position.width+3*this.MONTH_OFFSET){var o=(r-(h.length-1)*(3*this.MONTH_OFFSET))/(r-(a+3*this.MONTH_OFFSET)-(h.length-1)*(3*this.MONTH_OFFSET));this._scaleRow(h,Math.min(o,i)),u+=l.child.position.height-2.5*this.MONTH_OFFSET,t.child.position.top=u,a=r,h=[]}else t.child.position.left=l.child.position.left+l.child.position.width+3*this.MONTH_OFFSET;a-=t.child.position.width+3*this.MONTH_OFFSET,h.push(t),l=t},this);var c=(r-(h.length-1)*(3*this.MONTH_OFFSET))/(r-(a+3*this.MONTH_OFFSET)-(h.length-1)*(3*this.MONTH_OFFSET));this._scaleRow(h,Math.min(c,i),!0),this.position.height=l.child.position.top+l.child.position.height,this.month.setPosition({top:this.position.top,left:this.position.left,width:this.position.width,height:this.position.height}),this.summary.setPosition({top:this.position.top+2*this.MONTH_OFFSET,left:this.position.left+(this.controller.compressed?this.MONTH_OFFSET:0)})},r.prototype._scaleRow=function(t,e,i){var o=null;n.each(t,function(s,n){var r=Math.round((s.child.position.height-this.MONTH_OFFSET)*e),a=Math.max(this.layout_opt.min_height,Math.min(this.layout_opt.max_height,r));a!=this.layout_opt.min_height&&a!=this.layout_opt.max_height||(e=a/(s.child.position.height-this.MONTH_OFFSET)),o&&(s.child.position.left=o.child.position.left+o.child.position.width+3*this.MONTH_OFFSET);var h;1===t.length&&1===s.length?(h=s.child._scaleRow(s.child.objects,1,!0),s.child.position.width=h.width,s.child.position.height=h.height+this.MONTH_OFFSET):s.child.position.height<this.layout_opt.max_height&&(h=s.child._scaleRow(s.child.objects,e,i),s.child.position.width=h.width,s.child.position.height=h.height+this.MONTH_OFFSET),o=s},this)},r.prototype._groupObjectsBy=function(t){function e(t){return("00"+t.toString()).slice(-2)}var i=new Date(t[this.layout_opt.group_by_attr]),o=i.getUTCFullYear(),s=i.getUTCMonth()+1,n=i.getUTCDate();return o+"-"+e(s)+"-"+e(n)},r}),i("layouts/vertical_timeline",["common/extend","layouts/layout","layouts/vertical_banner","layouts/vertical_day","layouts/vertical_month","underscore"],function(t,e,i,o,s,n){function r(t,e){return r.__super__.constructor.call(this,t,e),this.PADDING=0,this.container=e.controller._layout_container,this.layout_opt=e.layout_opt,this.group_index=e.layout_opt.group_by_attr,this.markers={},this.default_position={width:0,height:0},this.position={width:this.controller.getDimensions().width,height:0},this.banners=e.layout_opt.banners,this._groupObjects(this.layout_opt.reverse_sort),this._addBanners(),this._initiateObjects(this.grouped),this}t(r,e);return r.prototype._loadChild=function(t,e){return new s(t,e)},r.prototype.render=function(t,e,i,o){this.header&&(e<=this.header.child.position.top+this.header.child.position.height&&e+o>=this.header.child.position.top?(this.header.render(t,e,i,o),this.header.update({visible:!0})):(this.header.remove(),this.header.update({visible:!1}))),n.each(this.grouped,function(s,n){e-.5*o<=s.child.position.top+s.child.position.height&&e+1.5*o>=s.child.position.top?s.child.render(t,e,i,o):s.child.remove()},this),this.footer&&(e-.5*o<=this.footer.child.position.top+this.footer.child.position.height&&e+1.5*o>=this.footer.child.position.top?(this.footer.render(t,e,i,o),this.footer.update({visible:!0})):(this.footer.remove(),this.footer.update({visible:!1})))},r.prototype._addBanners=function(){this.banners&&(this.banners.header&&(this.header=new i([],{banner_options:this.banners.header,controller:this.controller,parent:this})),this.banners.footer&&(this.footer=new i([],{banner_options:this.banners.footer,controller:this.controller,parent:this})))},r.prototype._updateBanners=function(){n.isObject(this.banners)||(this.banners={}),this.header&&this.header.remove(),this.banners.header?this.header=new i([],{banner_options:this.banners.header,controller:this.controller,parent:this}):this.header=null,this.footer&&this.footer.remove(),this.banners.footer?this.footer=new i([],{banner_options:this.banners.footer,controller:this.controller,parent:this}):this.footer=null},r.prototype.resetPositioning=function(){r.__super__.resetPositioning.call(this),this.position.width=this.controller.getDimensions().width,this.markers={}},r.prototype._buildPositioning=function(t){var e=null,i=0;this.header&&(i=46,this.header.child.setPosition({top:i,height:this.header.position.height}),e=this.header),n.each(t,function(t,o){e&&(i=e.child.position.top+e.child.position.height+this.PADDING),t.child.position.top=i,t.child.month&&t.child.month.setPosition({top:i});var s=t.child.key.split("-");this.markers[s[0]]||(this.markers[s[0]]={count:0,position:i});var n=Object.keys(t.child.objects).length;this.markers[s[0]].count+=n,this.markers[s[0]][s[1]]={count:n,position:i},e=t},this),this.footer&&(i=46,e&&(i=e.child.position.top+e.child.position.height),this.footer.child.setPosition({top:i,height:this.footer.position.height}),e=this.footer),e&&(this.position.height=e.child.position.top+e.child.position.height+this.PADDING/2)},r.prototype._groupObjectsBy=function(t){var e=new Date(t[this.layout_opt.group_by_attr]),i=e.getUTCFullYear(),o=e.getUTCMonth()+1;return i+"-"+function(t){return("00"+t.toString()).slice(-2)}(o)},r}),i("layouts/vtl_condensed/filename_summary",["common/extend","views/base","views/date_summary","underscore"],function(t,e,i,o){function s(t){s.__super__.constructor.call(this,t),this.group=t.group,this.objects=t.objects,this.options=t.options,this.selected=!1}return t(s,e),s.prototype.render=function(t,e,i,o){return s.__super__.render.call(this,t,e,i,o)&&(this._bindEvents(),this.updatePositions(t,e,i,o),this.position.width&&(this.el.style.minWidth=this.position.width+"px"),this.el.querySelector(".group").textContent=this.group.toUpperCase(),this._updateCount(),(this.controller.touch&&!1===this.options.mobile||!0===this.options.hide_checkmark)&&this.el.classList.add("no-checkmark"),this.allSelected()),this},s.prototype.remove=function(){return this.rendered&&(this.el.classList.remove("selected"),this._unbindEvents()),s.__super__.remove.call(this),this},s.prototype.update=function(){this.el&&this._updateCount()},s.prototype.allSelected=function(){o.every(this.objects,function(t){return t.selected})?(this.el&&this.el.classList.add("selected"),this.selected=!0,this.controller.actionbar.updateDateSummary(this.date,this._getCount(),{selected:!0})):(this.el&&this.el.classList.remove("selected"),this.selected=!1,this.controller.actionbar.updateDateSummary(this.date,this._getCount(),{selected:!1}))},s.prototype.isSelected=function(){return this.selected},s.prototype._getCount=function(){return this.objects.length?this.objects.length:Object.keys(this.objects).length},s.prototype._updateCount=function(){var t=this._getCount();this.el.querySelector(".pill").textContent=t,this.controller.actionbar.updateDateSummary(this.date,t)},s.prototype._bindEvents=function(){this.el&&(o.bindAll(this,"_onClick"),this.el.addEventListener("click",this._onClick,!1))},s.prototype._unbindEvents=function(){this.el&&this.el.removeEventListener("click",this._onClick,!1)},s.prototype._onClick=function(t){if(!this.controller.touch||!1!==this.options.mobile){if(t.target.classList.contains("pill")){var e=o.pluck(this.objects,this.parent.layout_opt.object_id_attr);this.controller.clickCb(e,"select",t),this.controller._track({name:"select-group",type:this.type})}}},s.prototype._getTemplate=function(){return'<div class="pmc-summary"><div class="pill"></div><div class="group"></div></div>'},s}),i("layouts/vtl_condensed/month",["common/extend","layouts/vertical_month","layouts/vertical_day","views/date_summary","layouts/vtl_condensed/filename_summary","views/month_card","views/scalable_moment","views/square_moment","underscore"],function(t,e,i,o,s,n,r,a,h){function l(t,e){return l.__super__.constructor.call(this,t,e),this.layout_opt.group_objects?(this.default_position.top=this.layout_opt.offsets.top,this.position.top=this.layout_opt.offsets.top):(this.default_position.top=0,this.position.top=0),this}return t(l,i),l.prototype._loadChild=function(t,e){return this.layout_opt.view_object&&"function"==typeof this.layout_opt.view_object?new this.layout_opt.view_object(t,e):"square"===this.layout_opt.view_type?new a(t,e):new r(t,e)},l.prototype.render=function(t,e,i,o){this.month&&this.month.render(t,e,i,o),this.summary&&(e<this.position.top?this.summary.render(t,e,i,o):this.summary.remove()),h.each(this.objects,function(s,n){e-.5*o<=this.position.top+s.child.position.top+s.child.position.height&&e+1.5*o>=this.position.top+s.child.position.top?s.child.render(t,e,i,o):s.child.remove()},this)},l.prototype.remove=function(){this.month&&this.month.remove(),l.__super__.remove.call(this)},l.prototype.resetPositioning=function(){l.__super__.resetPositioning.call(this)},l.prototype.buildPositioning=function(t){return this._buildPositioning(this.objects,t)},l.prototype._buildPositioning=function(t,e){var i=this.layout_opt.max_height/this.layout_opt.min_height,o=this.controller.getDimensions().width,s=this.layout_opt.offsets.left+this.layout_opt.offsets.right,n=o-s,r=n,a=0,l=null,u=this.position.top;void 0===e?e=[]:(this._rescaleRow(e),l=h.last(e),r-=l.child.position.left+l.child.position.width),this._setupMonthCard(),this._setupGroupSummary(),this.controller.compressed&&this.summary&&this.summary.setPosition({left:this.MONTH_OFFSET}),h.each(t,function(t,o){t.child.setPosition({top:u,left:l?l.child.position.left+l.child.position.width+this.layout_opt.offsets.object:this.layout_opt.offsets.left}),t.child.setScale();var s=t.child.getWidth();if(r<s+this.layout_opt.offsets.object){if(e.length>0){var h=(n-(e.length-1)*this.layout_opt.offsets.object)/(n-(r+this.layout_opt.offsets.object)-(e.length-1)*this.layout_opt.offsets.object);this._scaleRow(e,Math.min(h,i)),o>0?(u+=l.child.position.height+this.layout_opt.offsets.object,t.child.setPosition({top:u,left:this.layout_opt.offsets.left})):t.child.setPosition({left:this.layout_opt.offsets.left})}r=n,e=[],a++}r-=s+this.layout_opt.offsets.object,e.push(t),l=t},this);var c=(n-(e.length-1)*this.layout_opt.offsets.object)/(n-(r+this.layout_opt.offsets.object)-(e.length-1)*this.layout_opt.offsets.object);return a>0?this._scaleRow(e,Math.min(c,i),!0):this._scaleRow(e,Math.min(c,i)),this.position.width=this.controller.getDimensions().width,this.position.height=l.child.position.top+l.child.position.height,this._updateMonthCard(o),this._updateGroupSummary(),this.layout_opt.group_objects?void 0:e},l.prototype._rescaleRow=function(t){var e;h.each(t,function(t){t.child.setPosition({height:this.layout_opt.min_height}),t.child.setScale(),e&&t.child.setPosition({left:e.child.position.left+e.child.position.width}),e=t},this)},l.prototype._setupMonthCard=function(){!this.month&&this.layout_opt.group_objects&&(this.month=new n({parent:this,controller:this.controller}))},l.prototype._updateMonthCard=function(t){this.month&&this.month.setPosition({top:this.position.top,left:this.position.left,width:t,height:this.position.height+this.layout_opt.offsets.left})},l.prototype._setupGroupSummary=function(){this.layout_opt.group_objects&&(this.key.length>1?l.__super__._setupGroupSummary.call(this):this.summary||(this.summary=new s({parent:this,group:this.key,controller:this.controller,options:this.layout_opt.date_summary,objects:this.objects})))},l}),i("layouts/vtl_condensed/layout",["common/extend","layouts/vertical_timeline","layouts/vtl_condensed/month","views/month_card","underscore"],function(t,e,i,o,s){function n(t,e){return n.__super__.constructor.call(this,t,e),this.PADDING=0,this.HEADER_OFFSET=40,this.MONTH_OFFSET=0,this}t(n,e);return n.prototype._loadChild=function(t,e){return new i(t,e)},n.prototype.render=function(t,e,i,o){n.__super__.render.call(this,t,e,i,o),this.month&&this.month.render(t,e,i,o)},n.prototype.remove=function(){n.__super__.remove.call(this),this.month&&(this.month.remove(),this.month=null)},n.prototype.buildPositioning=function(){var t;s.each(this.grouped,function(e,i){t=e.child.buildPositioning(t)},this),this.layout_opt.group_objects?this._buildPositioning(this.grouped):this._combinePositioning(this.grouped)},n.prototype._combinePositioning=function(t){var e=null,i=0;this.month||(this.month=new o({parent:this,controller:this.controller,compressed:!0})),this.header&&(i=46,this.header.child.setPosition({top:i,height:this.header.position.height}),e=this.header);var n=i;this.month&&(e&&(n+=e.child.position.height),this.month.setPosition({top:n,left:this.MONTH_OFFSET})),s.each(t,function(t,o){if(e)if(e.child.objects){var n=s.first(t.child.objects),r=s.last(e.child.objects);n.child.position.left>20?i+=r.child.position.top:i+=r.child.position.top+r.child.position.height+this.layout_opt.offsets.object}else i=e.child.position.top+e.child.position.height+this.HEADER_OFFSET;t.child.position.top=i,e=t},this),this.month&&e&&this.month.setPosition({width:e.child.position.width,height:e.child.position.top+e.child.position.height+20-n}),this.footer&&(i=46,e&&(i=e.child.position.top+e.child.position.height),this.footer.child.setPosition({top:i,height:this.footer.position.height}),e=this.footer),e&&(this.position.height=e.child.position.top+e.child.position.height+this.PADDING/2)},n.prototype.comparator=function(t){return"filename"===this.layout_opt.sort_by_attr?t[this.layout_opt.sort_by_attr].toLowerCase():n.__super__.comparator.call(this,t)},n.prototype._groupObjectsBy=function(t){return"filename"===this.layout_opt.group_by_attr?t[this.layout_opt.group_by_attr].substr(0,1).toLowerCase():n.__super__._groupObjectsBy.call(this,t)},n}),i("layouts/loader",["layouts/vertical_timeline","layouts/vtl_condensed/layout"],function(t,e){function i(t,e,i){if("string"==typeof t&&t in o)return new o[t](e,i);throw new Error({message:"Layout not found."})}var o={VerticalCondensed:e,VerticalTimeline:t};return i}),i("common/reference_loader",["views/base","views/scalable_moment","views/square_moment"],function(t,e,i){function o(t){if("string"==typeof t&&t in s)return s[t];throw new Error({message:"Object not found."})}var s={view:t,scalable_moment:e,square_moment:i};return o}),i("views/scrubber/tooltip",["common/date_helper","underscore"],function(t,e){function i(){return this.el=null,this}return i.prototype.render=function(){var t=document.createElement("div");return t.classList.add("tooltip"),this.el=t,this},i.prototype.remove=function(){return this.el.parentNode.removeChild(this.el),this.el=null,this},i.prototype.getText=function(){return this.el.textContent},i.prototype.updateText=function(e){var i=t.formatDate(e,"MMM YYYY");return this.el.textContent=i,this},i.prototype.clearPosition=function(){return this.el.style.transform="",this},i.prototype.updatePosition=function(t,e){var i={x:0,y:0,z:0};return i[e]=Math.round(t),this.el.style.transform="translate3d("+i.x+"px, "+i.y+"px, "+i.z+"px)",this},i.prototype.show=function(){return this.addClass("show"),this},i.prototype.hide=function(){return this.removeClass("show"),this},i.prototype.addClass=function(t){return!!this.el&&(this.el.classList.add(t),!0)},i.prototype.removeClass=function(t){return!!this.el&&(this.el.classList.remove(t),!0)},i}),i("views/scrubber/needle",["views/scrubber/tooltip","underscore"],function(t,e){function i(t){return this.el=null,this.axis=t.axis,this.parent=t.parent,this.position=0,this.range=0,this}return i.prototype.render=function(){var e=document.createElement("div");e.classList.add("needle");var i=new t;return e.appendChild(i.render().el),this.el=e,this.tooltip=i,this},i.prototype.remove=function(){return this.tooltip.remove(),this.tooltip=null,this.el&&(this.parent.el.removeChild(this.el),this.el=null),this},i.prototype.getPosition=function(){return this.position},i.prototype.setPosition=function(t,e){void 0===e&&(e=0);var i={x:0,y:0,z:0};if(this.el){this.position=i[this.axis]=Math.min(t,this.range+7),this.el.style.transform="translate3d("+i.x+"px, "+i.y+"px, "+i.z+"px)";var o=e;0===o&&(t<10?o=10-t:this.range>0&&t>this.range-15&&(o=-(t-(this.range-15)))),0!==o?this.tooltip.updatePosition(o,this.axis):this.tooltip.clearPosition()}},i.prototype.updateRange=function(t){this.range=t},i.prototype.show=function(){this.el&&this.el.classList.add("show")},i.prototype.hide=function(){this.el&&this.el.classList.remove("show")},i.prototype.showTooltip=function(){this.tooltip&&this.tooltip.show()},i.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},i.prototype.updateTooltip=function(t){this.tooltip&&this.tooltip.updateText(t)},i.prototype.addTooltipClass=function(t){this.tooltip&&this.tooltip.addClass(t)},i.prototype.removeTooltipClass=function(t){this.tooltip&&this.tooltip.removeClass(t)},i}),i("views/scrubber/handle",["views/scrubber/needle","views/scrubber/tooltip","underscore"],function(t,e,i){function o(t){return this.axis=t.axis,this.controller=t.controller,this.dimensions={},this.dragging=!1,this.drag_position=0,this.el=null,this.needle=null,this.offset=0,this.parent=t.parent,this.position=0,this.range=0,this.show_needle=t.show_needle,this.show_tooltip=t.show_tooltip,this.touch={active:!1,animating:!1,distance:0,dragging:!1,end_time:0,points:{},start_pos:0,start_time:0,timeout:null},this}return o.prototype.render=function(){var o=this._getTemplate();if(this.show_needle){var s=new t({axis:this.axis,parent:this});o.appendChild(s.render().el),this.needle=s}else if(this.show_tooltip){var n=new e;o.appendChild(n.render().el),this.tooltip=n}return this.el=o,this._bindEvents(),i.defer(i.bind(function(){this._setOffset()},this)),this},o.prototype.remove=function(){return this._unbindEvents(),this.needle&&this.needle.remove(),this.tooltip&&this.tooltip.remove(),this.parent.el.removeChild(this.el),this.el=null,this.needle=null,this.offset=0,this},o.prototype.moveTo=function(t,e){var i=e[this.axis],o=this._getPercent(i);this.setPosition(o),this.updatePosition(),this._mouseDown(t),this.parent.scroll.timeout&&(clearTimeout(this.parent.scroll.timeout),this.parent.scroll.timeout=null)},o.prototype.delayedTooltip=function(t){this.parent.scroll.timeout&&clearTimeout(this.parent.scroll.timeout);var e=this.controller.getDateAtPosition(t);e&&(this.updateTooltip(e),this.showTooltip()),this.parent.scroll.timeout=setTimeout(i.bind(function(){this.needle&&!this.dragging&&this.needle.hideTooltip(),this.parent.scroll.timeout=null},this),3e3)},o.prototype.hideTooltip=function(){this.needle&&this.needle.hideTooltip(),this.tooltip&&this.tooltip.hide()},o.prototype.showTooltip=function(){this.needle&&this.needle.showTooltip(),this.tooltip&&this.tooltip.show()},o.prototype.updateTooltip=function(t){this.needle&&this.needle.updateTooltip(t),this.tooltip&&this.tooltip.updateText(t)},o.prototype.addTooltipClass=function(t){this.needle&&this.needle.addTooltipClass(t),this.tooltip&&this.tooltip.addClass(t)},o.prototype.removeTooltipClass=function(t){this.needle&&this.needle.removeTooltipClass(t),this.tooltip&&this.tooltip.removeClass(t)},o.prototype.setPosition=function(t,e){void 0===e&&(e=!0),t=Math.min(1,Math.max(0,t)),this.position=this._getPosition(t);var i=this.offset,o=0;this.position<10?o=10-this.position:this.range>0&&this.position>this.range-15&&(o=-(this.position-(this.range-15))),this.needle&&this.needle.setPosition(i,o),this.tooltip&&(0!==o?this.tooltip.updatePosition(o,this.axis):this.tooltip.clearPosition()),e&&this.parent.setPosition(t,!1)},o.prototype.updatePosition=function(){var t={x:0,y:0,z:0};0===this.offset&&this._setOffset(),t[this.axis]=Math.round(this.position)-this.offset,this.el.style.transform="translate3d("+t.x+"px, "+t.y+"px, "+t.z+"px)"},o.prototype.getRange=function(){return this.range},o.prototype.updateRange=function(){this.range=this._getRange()[this.axis],this.needle&&this.needle.updateRange(this.range)},o.prototype._setOffset=function(){var t=0;t="x"===this.axis?this.el.offsetWidth/2:this.el.offsetHeight/2,this.offset=t},o.prototype._bindEvents=function(){i.bindAll(this,"_mouseDown","_touchStart","_touchMove","_touchEnd"),this.el.addEventListener("mousedown",this._mouseDown),this.el.addEventListener("touchstart",this._touchStart),this.el.addEventListener("touchmove",this._touchMove),this.el.addEventListener("touchend",this._touchEnd)},o.prototype._unbindEvents=function(){this.el.removeEventListener("mousedown",this._mouseDown),this.el.removeEventListener("touchstart",this._touchStart),this.el.removeEventListener("touchmove",this._touchMove),this.el.removeEventListener("touchend",this._touchEnd)},o.prototype._mouseDown=function(t){this.dragging=!0,this.mouseDown={x:t.pageX,y:t.pageY},this.drag_position=this.position,this.mouseMoveCb=i.bind(this._mouseMove,this),this.mouseUpCb=i.bind(this._mouseUp,this),window.addEventListener("mousemove",this.mouseMoveCb),window.addEventListener("mouseup",this.mouseUpCb)},o.prototype._mouseUp=function(t){if(!this.dragging)return!0;this.position!==this.drag_position&&this.controller._track({name:"scroll-drag"}),this.dragging=!1,this.drag_position=0,this.delayedTooltip(this.parent.getPosition()),window.removeEventListener("mousemove",this.mouseMoveCb),
window.removeEventListener("mouseup",this.mouseUpCb)},o.prototype._mouseMove=function(t){if(!this.dragging)return!0;this.parent.scroll.timeout&&(clearTimeout(this.parent.scroll.timeout),this.parent.scroll.timeout=null);var e={x:t.pageX-this.mouseDown.x,y:t.pageY-this.mouseDown.y},i=this._limitRange(this.drag_position+e[this.axis]),o=this._getPercent(i);this.parent._getPosition(o);this.setPosition(o),this.updatePosition(),t.preventDefault()},o.prototype._touchStart=function(t){this.touch.active||(this.touch=i.extend(this.touch,{active:!0,start_pos:this.position,start_time:Date.now(),distance:0,points:{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY}}),!0===this.touch.animating&&(this.touch.animating=!1),t.preventDefault(),t.stopPropagation(),this.parent.scroll.timeout&&clearTimeout(this.parent.scroll.timeout),this.parent.touch.timeout&&clearTimeout(this.parent.touch.timeout),this.controller.scroll_id=null,this.addTooltipClass("touch"))},o.prototype._touchMove=function(t){if(this.touch.active){var e={x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY},i=this.touch.points[this.axis]-e[this.axis],o=Date.now();if(this.touch.points=e,this.touch.distance+=i,o-this.touch.end_time>300&&Math.abs(this.touch.distance)<10)return;var s=this.position-i;(s<0||s>this.range)&&(s=this.position-i/3),t.preventDefault(),t.stopPropagation();var n=this._getPercent(s);this.setPosition(n),this.updatePosition(),o-this.touch.start_time>300&&(this.touch.start_time=o,this.touch.start_pos=s);var r=this.parent._getPosition(n),a=this.controller.getDateAtPosition(r);return this.updateTooltip(a),this.parent.scroll.timeout&&clearTimeout(this.parent.scroll.timeout),this.parent.touch.timeout&&clearTimeout(this.parent.touch.timeout),!1}t.preventDefault()},o.prototype._touchEnd=function(t){if(this.touch.active){this.touch.active=!1,this.touch.end_time=Date.now();var e=Math.round(this.position);this.removeTooltipClass("touch"),this.setPosition(this._getPercent(e)),this.updatePosition(),this.position!==this.touch.start_pos&&this.controller._track({name:"scroll-drag"}),this.parent.touch.timeout=setTimeout(i.bind(function(){this.parent.touch.timeout=null},this),3e3)}},o.prototype._getRange=function(){return{x:this.parent.el.offsetWidth,y:this.parent.el.offsetHeight}},o.prototype._getPercent=function(t){return Math.min(1,Math.max(0,t/this.range))},o.prototype._getPosition=function(t){return t*this.range},o.prototype._limitRange=function(t){return Math.min(Math.max(0,t),this.range)},o.prototype._getTemplate=function(){var t=document.createElement("div"),e=document.createElement("div");return t.classList.add("handle-container"),e.classList.add("handle"),t.appendChild(e),t},o}),i("scrubbers/basic/handle",["common/extend","views/scrubber/handle"],function(t,e){function i(t){return i.__super__.constructor.call(this,t),this}return t(i,e),i.prototype.render=function(){return i.__super__.render.call(this),this.needle&&(this.needle.remove(),this.needle=null),this},i}),i("views/scrubber/markers",["underscore"],function(t){function e(t){return this.el=null,this.parent=t.parent,this.positions=t.positions,this.controller=t.controller,this}return e.prototype.render=function(){var t=document.createElement("div");return t.classList.add("markers-container"),this.el=t,this},e.prototype.remove=function(){return this._clearElements(),this.el&&(this.parent.el.removeChild(this.el),this.el=null),this},e.prototype.updatePositioning=function(e){t.isEmpty(e)||(this.positions=e,this._clearElements(),this._buildPositioning())},e.prototype._clearElements=function(){if(this.el)for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)},e.prototype._buildPositioning=function(){if(this.el&&this.parent.handle){var e,i,o,s,n,r=this.controller.compressed?6:8,a=Object.keys(this.positions).sort().reverse(),h=[],l=this.parent.handle.range,u=Math.floor(10-r/2),c=l+20-r-2;for(i=0;i<a.length;i++)o=this.positions[a[i]],s=o.position/this.parent._getRange()[this.parent.axis],e={index:i,el:document.createElement("div"),label:a[i],hidden:!1,start:Math.floor(this.parent.handle._getPosition(s))+10,position:0},h.push(e),e.size=l+20-e.start,i>0&&(h[i-1].size=e.start-h[i-1].start,h[i-1].position=Math.min(c,e.start-r+4),h[i-1].el.style.transform="translate3d(0px, "+h[i-1].position+"px, 0px)"),e.el.classList.add("marker"),e.el.classList.add("year"),e.el.textContent=e.label,this.el.appendChild(e.el);for(n=0;n<h.length&&h[n].position<u;)h[n].position=u,h[n].el.style.transform="translate3d(0px, "+u+"px, 0px)",n++;for(h[h.length-1].position=c,h[h.length-1].el.style.transform="translate3d(0px, "+c+"px, 0px)",a=t.sortBy(h,"size").reverse(),i=0;i<a.length;i++)if(e=a[i],!e.hidden){for(n=e.index-1;n>=0&&!h[n].hidden&&e.position-h[n].position<2.75*r;)h[n].hidden=!0,h[n].el.style.display="none",n--;for(n=e.index+1;n<h.length&&!h[n].hidden&&h[n].position-e.position<2.75*r;)h[n].hidden=!0,h[n].el.style.display="none",n++}}},e}),i("views/scrubber/wrapper",["underscore","views/scrubber/handle","views/scrubber/markers","views/scrubber/needle","views/scrubber/tooltip"],function(t,e,i,o,s){function n(t){return this.el=null,this.handle=null,this.keyboard={animating:!1,position:0,time:0},this.scroll={delta:0,percent:0,position:0,previous:0,range:0,stop_dir:0,stop_pos:0,timeout:null,offset:.15},this.touch={active:!1,animating:!1,distance:0,dragging:!1,end_time:0,points:{},start_pos:0,end_pos:0,start_time:0,timeout:null},this.controller=t.controller,this.scrubber_options=t.scrubber_options,this.max_dimensions=t.max_dimensions,t.scrubber_options.vertical?this.axis="y":this.axis="x",this.continuousScrollTimeout=0,this.continuousScrollInterval=0,this}return n.prototype.render=function(){var n=document.createElement("div");n.classList.add("scrubber-container"),this.controller.el.classList.add(this.scrubber_options.vertical?"vertical":"horizontal");var r=new e({axis:this.axis,controller:this.controller,parent:this,show_needle:this.scrubber_options.show_needle,show_tooltip:this.scrubber_options.show_tooltip});if(n.appendChild(r.render().el),this.el=n,this.handle=r,this.scrubber_options.show_needle){var a=new o({axis:this.axis,controller:this.controller,parent:this});n.appendChild(a.render().el),this.needle=a}else if(this.scrubber_options.show_tooltip){var h=new s;n.appendChild(h.render().el),this.tooltip=h}if(this.scrubber_options.show_markers){var l=this.controller._getDatePositions(),u=new i({parent:this,positions:l,controller:this.controller});n.appendChild(u.render().el),this.markers=u}return this._bindEvents(),t.defer(t.bind(this.resize,this)),this},n.prototype.resize=function(t){void 0!==t&&(this.max_dimensions=t);var e=this.controller.getDimensions();this.updateRange(),this.updateMarkers(),0===this.max_dimensions.x||0===this.max_dimensions.y||this.controller.vertical&&this.max_dimensions.y<e.height||!this.controller.vertical&&this.max_dimensions.x<e.width?(this.el.classList.add("hidden"),this.setPosition(0)):(this.el.classList.remove("hidden"),this.setPosition())},n.prototype.remove=function(){this._unbindEvents(),this.handle.remove(),this.needle&&this.needle.remove(),this.tooltip&&this.tooltip.remove(),this.el.parentNode.removeChild(this.el),this.el=null,this.handle=null,this.needle=null,this.tooltip=null},n.prototype.setDimensions=function(t){this.max_dimensions=t},n.prototype.setPosition=function(t,e){void 0===t&&(t=this.scroll.percent?this.scroll.percent:0),void 0===e&&(e=!0);var i=this._getPosition(t);this.scroll.percent=t,this.scroll.position=i,this.controller.updatePosition(Math.round(i)),!0===e&&(this.handle.setPosition(t,!1),this.handle.updatePosition())},n.prototype.updateMarkers=function(){if(this.markers){var t=this.controller._getDatePositions();this.markers.updatePositioning(t)}},n.prototype.updateRange=function(){var t=this._getRange()[this.axis],e=null,i=this.controller.getDimensions(),o="x"===this.axis?i.width:i.height;e=t-o>0?t-o:t,this.scroll.range=e,this.handle.updateRange(),this.needle&&this.needle.updateRange(this.handle.getRange())},n.prototype.getPercent=function(){return this.scroll.percent},n.prototype.getPosition=function(){return this.scroll.position},n.prototype.updateOptions=function(t){this.scrubber_options=t},n.prototype._bindEvents=function(){return this.el&&(t.bindAll(this,"_click","_mouseUp","_mouseOver","_mouseMove","_mouseOut"),this.el.addEventListener("mousedown",this._click),this.el.addEventListener("mouseup",this._mouseUp),this.el.addEventListener("mouseover",this._mouseOver),this.el.addEventListener("mousemove",this._mouseMove),this.el.addEventListener("mouseout",this._mouseOut),this.controller._bindEvents()),this},n.prototype._unbindEvents=function(){return this.el&&(this.el.removeEventListener("mousedown",this._click,this),this.el.removeEventListener("mouseup",this._mouseUp,this),this.el.removeEventListener("mouseover",this._mouseOver,this),this.el.removeEventListener("mousemove",this._mouseMove,this),this.el.removeEventListener("mouseout",this._mouseOut,this),this.controller._unbindEvents()),this},n.prototype._click=function(e){var i=Array.isArray(e.changedTouches)&&e.changedTouches.length>0?e.changedTouches[0].pageX:void 0,o=Array.isArray(e.changedTouches)&&e.changedTouches.length>0?e.changedTouches[0].pageY:void 0,s="number"==typeof e.pageX?e.pageX:i,n="number"==typeof e.pageY?e.pageY:o,r={x:s-this.el.getBoundingClientRect().left,y:n-this.el.getBoundingClientRect().top},a=this.handle._getPercent(this.handle._limitRange(r[this.axis])),h=this._getPosition(a),l=this.controller.getDateAtPosition(h);if(this.needle&&this.needle.hide(),this.tooltip&&this.tooltip.hide(),e.target.classList.contains("scrubber-container")){var u=a<=this.getPercent();return this._animateScroll(u),this.scroll.stop_dir=u,this.scroll.stop_pos=h,void(this.controller.touch||(this.continuousScrollTimeout=setTimeout(t.bind(function(){this._startContinuousScroll(u)},this),250)))}l&&(this.handle.updateTooltip(l),this.handle.showTooltip()),e.target.classList.contains("handle")||(this.handle.moveTo(e,r),this.controller.scroll_id=null,this.controller._track({name:"scroll-to"}))},n.prototype._mouseUp=function(t){this._cancelContinuousScroll()},n.prototype._mouseOver=function(t){var e=t.target;e.classList.contains("handle")||e.classList.contains("scrubber-container")||this.handle.dragging||this.controller.touch||(this.handle.hideTooltip(),this.needle&&this.needle.show(),this.tooltip&&this.tooltip.show())},n.prototype._mouseMove=function(t){var e={x:t.pageX-this.el.getBoundingClientRect().left,y:t.pageY-this.el.getBoundingClientRect().top},i=this.handle._getPercent(this.handle._limitRange(e[this.axis]));isNaN(i)&&(this.updateRange(),i=this.handle._getPercent(this.handle._limitRange(e[this.axis])));var o=this._getPosition(i),s=this.controller.getDateAtPosition(o);if(this.handle.dragging)this.handle.updateTooltip(s);else{if(t.target.classList.contains("scrubber-container")||t.target.classList.contains("handle"))return this.needle&&this.needle.hide(),void(this.tooltip&&this.tooltip.hide());if(this.needle&&s&&(this.needle.showTooltip(),this.needle.updateTooltip(s),this.needle.setPosition(e[this.axis])),this.tooltip){var n=0,r=this.handle._getPosition(i);r<10?n=10-r:this.handle.getRange()>0&&r>this.handle.getRange()-15&&(n=-(r-(this.handle.getRange()-15))),r+=n,this.tooltip.show(),this.tooltip.updateText(s),this.tooltip.updatePosition(r,this.axis)}}},n.prototype._mouseOut=function(t){this._cancelContinuousScroll();var e=t.target,i=t.relatedTarget;if(e&&i&&i!=document&&e.classList.contains("scrubber-container")&&i.classList.contains("handle"))return!0;this.needle&&this.needle.hide(),this.tooltip&&this.tooltip.hide()},n.prototype._keyDown=function(e){if(!(document.activeElement&&-1!=t.indexOf(["INPUT","TEXTAREA"],document.activeElement.nodeName)||document.activeElement&&document.activeElement.hasAttribute("contentEditable")||this.scrubber_options.disableScroll||this.el.classList.contains("hidden"))){this.scroll.offset=.15;var i=e.keyCode;37===i||38===i||33===i?(this.handle.el!==document.activeElement&&this.handle.el.focus(),33===i&&(this.scroll.offset=.9),this._animateScroll(!0)):39!==i&&40!==i&&34!==i||(this.handle.el!==document.activeElement&&this.handle.el.focus(),34===i&&(this.scroll.offset=.9),this._animateScroll(!1))}},n.prototype._animateScroll=function(e){if(!this.keyboard.animating){var i=e?-1:1,o=this.handle.range*i*this.scroll.offset;this._limitRange(this.scroll.position+o)!==this.scroll.previous&&(this.controller.scroll_id=null,this.keyboard.animating=!0,this._setRafRunning(!0),this.keyboard=t.extend(this.keyboard,{position:this.scroll.position,time:Date.now(),to_beginning:e}),this._animateStart(),t.delay(t.bind(function(){this.keyboard.animating=!1},this),200))}},n.prototype._animateStart=function(){var e=Date.now()-this.keyboard.time,i=e/200,o=this.keyboard.to_beginning?-1:1,s=this.handle.range*o*this.scroll.offset*Math.min(i,1),n=this._limitRange(this.keyboard.position+s),r=this._getPercent(n);this.setPosition(r),this.handle.delayedTooltip(n),this.needle&&this.needle.hideTooltip(),this.tooltip&&this.tooltip.hide(),this.keyboard.animating?(this._setRafRunning(!0),this.scroll.previous=this.scroll.position,window.requestAnimationFrame(t.bind(this._animateStart,this))):this._setRafRunning(!1)},n.prototype._wheel=function(t){if(t.preventDefault(),!this.scrubber_options.disableScroll){var e={x:t.deltaX,y:t.deltaY},i=1,o=navigator.userAgent.match(/macintosh/i);navigator.userAgent.match(/firefox/i)&&!o&&(i=15),this.scroll.delta=Math.max(-180,Math.min(180,e[this.axis]*i)),"x"===this.axis&&0===e.x&&(this.scroll.delta=e.y);var s=this.scroll.position+this.scroll.delta,n=this._getPercent(s);return this.raf_running||this.el.classList.contains("hidden")||(this.controller.scroll_id=null,this.setPosition(n),this._scroll()),!1}},n.prototype._scroll=function(e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),Math.abs(this.scroll.delta)>0&&(this.scroll.delta=0);var o;o=i?this.setPosition(this._getPercent(this.scroll.position)):this._getPercent(this._limitRange(this.scroll.position)),this.setPosition(o),this.needle&&this.needle.hide(),this.tooltip&&this.tooltip.hide(),this.handle.delayedTooltip(this.scroll.position),this.scroll.position===this.scroll.previous?this._setRafRunning(!1):(this._setRafRunning(!0),this.scroll.previous=this.scroll.position,window.requestAnimationFrame(t.bind(function(){this._scroll(e,i)},this)))},n.prototype._touchStart=function(e){this.touch.active||(this.touch=t.extend(this.touch,{active:!0,dimensions:this.controller.getDimensions(),start_pos:this.scroll.position,start_time:Date.now(),distance:0,points:{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}}),!0===this.touch.animating&&(this.touch.animating=!1),this.controller.scroll_id=null)},n.prototype._touchMove=function(t){if(this.touch.active){var e={x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY},i=this.touch.points[this.axis]-e[this.axis],o=Date.now();if(this.touch.dragging=!0,this.touch.points=e,this.touch.distance+=i,o-this.touch.end_time>300&&Math.abs(this.touch.distance)<10)return;var s=this.scroll.position+i;(s<0||s+this.touch.dimensions.height>this.scroll.range)&&(s=this.scroll.position+i/3),t.preventDefault(),t.stopPropagation(),this.setPosition(this._getPercent(s)),this._scroll(!0,!0),o-this.touch.start_time>300&&(this.touch.start_time=o,this.touch.start_pos=s);var n=this.controller.getDateAtPosition(s);return this.handle.updateTooltip(n),this.touch.timeout&&clearTimeout(this.touch.timeout),!1}t.preventDefault()},n.prototype._touchEnd=function(e){if(this.touch.active){if(this.touch.end_pos=this.scroll.position,this.touch.active=!1,this.touch.dragging){this.touch.dragging=!1,this.touch.end_time=Date.now();var i=this.touch.end_time-this.touch.start_time,o=Math.round(this.scroll.position);if(this._resetPosition())return;if(this.setPosition(this._getPercent(this._limitRange(o))),this.raf_running||this._scroll(),i<300){var s=this._getMomentum(this.scroll.position,this.touch.start_pos,i,this.scroll.range,this.touch.dimensions.height);this._momentumScroll(s.destination,s.duration)}return this.touch.timeout=setTimeout(t.bind(function(){this.touch.timeout=null},this),3e3),e.stopPropagation(),!1}var n=e.target;if(n.classList.contains("markers-container")||n.classList.contains("scrubber-container"))return this._click(e),!1}},n.prototype._resetPosition=function(t){void 0===t&&(t=600);var e=this.controller.getLastObject(),i=e&&e.child?e.child.getPosition(!0):0;if(this.scroll.position<0)this.scroll.position=0;else if(this.scroll.position>this.scroll.range)this.scroll.position=this.scroll.range;else{if(!(this.touch.dimensions.height>i))return!1;this.scroll.position=0}return this._momentumScroll(this.scroll.position,t),!0},n.prototype._getMomentum=function(t,e,i,o,s,n){void 0===n&&(n=6e-4);var r=t-e,a=Math.abs(r)/i,h=r<0?-1:1,l=t+a*a/(2*n)*h,u=a/n;return l>o?(l=s?o-s/2.5*(a/8):o,r=Math.abs(l-t),u=r/a):l<0&&(l=s?s/2.5*(a/8):0,r=Math.abs(t)+l,u=r/a),{destination:Math.round(l),duration:u}},n.prototype._momentumScroll=function(e,i){var o=this.touch.end_pos,s=Date.now(),n=s+i,r=t.bind(function(){var t=Date.now();if(t>=n)return this.touch.animating=!1,this.setPosition(this._getPercent(this._limitRange(e))),void(this.raf_running||this._scroll());t=(t-s)/i;var a=Math.sqrt(1- --t*t),h=(e-o)*a+o,l=this._getPercent(h);this.setPosition(l),this.raf_running||this._scroll(!0,!0),this.touch.animating&&window.requestAnimationFrame(r)},this);this.touch.animating=!0,r()},n.prototype._setRafRunning=function(t){this.raf_running=t},n.prototype._getPercent=function(t){return t/this.scroll.range},n.prototype._getPosition=function(t){return t*this.scroll.range},n.prototype._getRange=function(){return{x:this.max_dimensions.x,y:this.max_dimensions.y}},n.prototype._limitRange=function(t){return Math.min(Math.max(0,t),this.scroll.range)},n.prototype._startContinuousScroll=function(e){this.continuousScrollInterval=setInterval(t.bind(function(){(this.scroll.stop_dir&&this.getPosition()<=this.scroll.stop_pos||!this.scroll.stop_dir&&this.getPosition()>=this.scroll.stop_pos)&&this._cancelContinuousScroll(),this._animateScroll(e)},this),250)},n.prototype._cancelContinuousScroll=function(t){this.continuousScrollTimeout&&clearTimeout(this.continuousScrollTimeout),this.continuousScrollInterval&&clearInterval(this.continuousScrollInterval)},n}),i("scrubbers/basic/scrubber",["common/extend","scrubbers/basic/handle","views/scrubber/wrapper"],function(t,e,i){function o(t){return o.__super__.constructor.call(this,t),this}return t(o,i),o.prototype.render=function(){return o.__super__.render.call(this),this.needle&&(this.needle.remove(),this.needle=null),this},o}),i("scrubbers/yearly/scrubber",["common/extend","scrubbers/basic/scrubber"],function(t,e){function i(){}return t(i,e),i}),i("scrubbers/loader",["scrubbers/basic/scrubber","scrubbers/yearly/scrubber","views/scrubber/wrapper"],function(t,e,i){function o(t,e){return"string"==typeof t&&t in s?(e.controller.el.classList.add(t.toLowerCase()),new s[t](e)):(e.controller.el.classList.add("yearly"),new i(e))}var s={Basic:t,Yearly:i};return o}),i("application",["actionbar/bar","common/element_factory","common/image_queue","layouts/loader","common/reference_loader","scrubbers/loader","bowser","underscore"],function(t,e,i,o,s,n,r,a){function h(o,s){if(void 0!==o&&a.isArray(o)||(o=[]),void 0!==s&&a.isObject(s)||(s={}),this.options=this._buildOptions(s),this.clickCb=this.options.clickCallback,this.trackingCb=this.options.trackingCallback,this.environment=this.options.environment,this.life_uid=this.options.life_uid,this.idAttr=this.options.layout_options.object_id_attr,this.scroll_id=null,this.compressed=!1,this.touch=!1,this.vertical=this.options.scrubber_options.vertical,this.el=this.options.container,this.el.classList.add("pmc-heimdall"),r.mobile||r.tablet?(this.touch=!0,this.el.classList.add("touch"),this.el.offsetWidth<768&&(this.compressed=!0,this.el.classList.add("compressed")),this.options.layout_options.object_sizes.mobile&&(this.options.layout_options.min_height=this.options.layout_options.object_sizes.mobile.min_height,this.options.layout_options.max_height=this.options.layout_options.object_sizes.mobile.max_height)):this.el.offsetWidth<768?(this.compressed=!0,this.el.classList.add("compressed"),this.options.layout_options.object_sizes.small&&(this.options.layout_options.min_height=this.options.layout_options.object_sizes.small.min_height,this.options.layout_options.max_height=this.options.layout_options.object_sizes.small.max_height)):(this.compressed=!1,this.el.classList.remove("compressed"),this.options.layout_options.min_height=this.options.layout_options.object_sizes[this.options.layout_options.default_size].min_height,this.options.layout_options.max_height=this.options.layout_options.object_sizes[this.options.layout_options.default_size].max_height),"VerticalTimeline"==this.options.layout){var n=this.options.actionbar_options.sections.left;"date-summary"in a.pluck(n,"view")||this.options.actionbar_options.sections.left.push({view:"date-summary"})}if(this.options.topbar_options.size_change){var h=this.options.actionbar_options.sections.center;"layout-size"in a.pluck(h,"view")||this.options.actionbar_options.sections.center.push({view:"layout-size"})}if(this.options.topbar_options.sort){var l=this.options.actionbar_options.sections.right;"layout-sort"in a.pluck(l,"view")||this.options.actionbar_options.sections.right.push({view:"layout-sort"})}var u=new t(this,this.options.actionbar_options);this.el.appendChild(u.render().el),this.actionbar=u;var c=document.createElement("div");c.classList.add("layouts-container"),this.el.appendChild(c),this._layout_container=c,this.factory=new e,this.image_queue=new i,"Basic"==this.options.scrubber&&this.options.scrubber_options.show_markers&&(this.options.scrubber="Yearly"),this.layout=this._loadLayout(this.options.layout,o),this.scrubber=this._loadScrubber(this.options.scrubber),this.el.appendChild(this.scrubber.render().el),this._resetDimensions(),this.layout.resetPositioning(),this.layout.buildPositioning();var d={x:this.layout.position.width,y:this.layout.position.height};this.scrubber.setDimensions(d),this.layout.render(0,0,this.getDimensions().width,this.getDimensions().height),this.firstImageLoaded=!1}var l={actionbar_options:{position:"top",sections:{left:[],center:[],right:[]}},layout:"VerticalTimeline",layout_options:{date_summary:{mobile:!0,hide_checkmark:!1},default_size:"small",group_by_attr:"moment_date",group_objects:!0,moment_icons:{top:[],bottom:[]},object_id_attr:"uid",object_sizes:{small:{min_height:125,max_height:150},large:{min_height:225,max_height:275},mobile:{min_height:125,max_height:200}},offsets:{top:50,left:20,right:20,object:6},overlay:null,reverse_sort:!0,sort_by_attr:"moment_date",view_object:null},scrubber:"Basic",scrubber_options:{disableScroll:!1,show_markers:!0,show_needle:!0,show_tooltip:!0,vertical:!0},topbar_options:{size_change:!1,sort:!1}};return h.prototype._loadLayout=function(t,e){return new o(t,e,{controller:this,layout_opt:this.options.layout_options})},h.prototype._loadScrubber=function(t,e){return new n(t,{controller:this,max_dimensions:e,scrubber_options:this.options.scrubber_options})},h.prototype._bindEvents=function(){this._resizeEvent=a.debounce(a.bind(this._resize,this),250),a.bindAll(this.scrubber,"_keyDown","_touchStart","_touchMove","_touchEnd","_wheel"),window.addEventListener("resize",this._resizeEvent),window.addEventListener("keydown",this.scrubber._keyDown),this.el.addEventListener("touchstart",this.scrubber._touchStart),this.el.addEventListener("touchmove",this.scrubber._touchMove),this.el.addEventListener("touchend",this.scrubber._touchEnd),this.el.addEventListener("wheel",this.scrubber._wheel)},h.prototype._unbindEvents=function(){window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("keydown",this.scrubber._keyDown),this.el.removeEventListener("touchstart",this.scrubber._touchStart),this.el.removeEventListener("touchmove",this.scrubber._touchMove),this.el.removeEventListener("touchend",this.scrubber._touchEnd),this.el.removeEventListener("wheel",this.scrubber._wheel)},h.prototype._resize=function(t){var e=document.activeElement.nodeName;if(this.touch&&["input","textarea"].indexOf(e.toLocaleLowerCase())>=0)return t.preventDefault(),!1;this.el.offsetWidth<768?(this.options.layout_options.object_sizes.small&&(this.options.layout_options.min_height=this.options.layout_options.object_sizes.small.min_height,this.options.layout_options.max_height=this.options.layout_options.object_sizes.small.max_height),"Yearly"==this.options.scrubber&&(this.options.layout_options.offsets.right=60),this.compressed=!0,this.el.classList.add("compressed"),this.actionbar.update()):("Yearly"==this.options.scrubber&&(this.options.layout_options.offsets.right=20),this.compressed=!1,this.el.classList.remove("compressed")),null===this.scroll_id&&(this.scroll_id=this.layout.getObjectIdAtPosition(this.scrubber.getPosition())),this._resetDimensions(),this.layout.reload({keepSort:!0,resize:!0});var i={x:this.layout.position.width,y:this.layout.position.height};this.scrubber.resize(i),this.scroll_id&&this.scrollToObject(this.scroll_id)},h.prototype._resetDimensions=function(){this._dimensions=void 0,this.getDimensions()},h.prototype._buildOptions=function(t){void 0===t&&(t={});var e=a.extend({},l.actionbar_options,t.actionbar_options),i=a.extend({},l.layout_options,t.layout_options),o=a.extend({},l.scrubber_options,t.scrubber_options),s=a.extend({},l.topbar_options,t.topbar_options),n=a.extend({},l,t);return n.actionbar_options=e,n.layout_options=i,n.scrubber_options=o,n.topbar_options=s,n},h.prototype._getDatePositions=function(){var t={};return this.layout.markers&&(t=this.layout.markers),t},h.prototype._track=function(t){return!!this.trackingCb&&(this.trackingCb(t),!0)},h.prototype.remove=function(){this.clearObjects(),this.actionbar&&this.actionbar.remove(),this.layout&&this.layout.remove(),this.scrubber&&this.scrubber.remove()},h.prototype.addObjects=function(t){void 0===t&&(t=[]),a.isArray(t)||(t=[t]),null===this.scroll_id&&(this.scroll_id=this.layout.getObjectIdAtPosition(this.scrubber.getPosition()));var e=this.layout.addObjects(t);if(e){this.layout.resetPositioning(),this.layout.buildPositioning();var i={x:this.layout.position.width,y:this.layout.position.height};this.scrubber.resize(i),this.scroll_id&&this.scrollToObject(this.scroll_id)}return e},h.prototype.removeObjects=function(t){void 0===t&&(t=[]),a.isArray(t)||(t=[t]),null===this.scroll_id&&(this.scroll_id=this.layout.getObjectIdAtPosition(this.scrubber.getPosition()));var e=this.layout.removeObjects(t);if(e){this.layout.resetPositioning(),this.layout.buildPositioning();var i={x:this.layout.position.width,y:this.layout.position.height};this.scrubber.resize(i),this.scroll_id&&this.scrollToObject(this.scroll_id)}return e},h.prototype.clearObjects=function(){this.layout.reload({objects:[]});var t={x:0,y:0};this.scrubber.resize(t)},h.prototype.updateObjects=function(t){void 0===t&&(t=[]),a.isArray(t)||(t=[t]);var e=this.layout.updateObjects(t),i={x:this.layout.position.width,y:this.layout.position.height};return this.scrubber.resize(i),e},h.prototype.nextObject=function(t,e){return void 0===e&&(e={}),this.layout.nextObject(t,e)},h.prototype.previousObject=function(t,e){return void 0===e&&(e={}),this.layout.previousObject(t,e)},h.prototype.objectRange=function(t,e){return this.layout.objectRange(t,e)},h.prototype.updateActionbarOptions=function(t){return void 0===t&&(t={}),this.actionbar.updateOptions(t),this},h.prototype.updateLayoutOptions=function(t,e){if(void 0===t&&(t={}),void 0===e&&(e={}),this.layout&&Object.keys(t).length>0){null!==this.scroll_id&&!0!==e.clear_scroll_id||(this.scroll_id=this.layout.getObjectIdAtPosition(this.scrubber.getPosition()));var i=this.layout.updateOptions(t);if(i.refresh){var o={x:this.layout.position.width,y:this.layout.position.height};this.scrubber.resize(o)}else this.scrubber.resize();this.actionbar&&(t&&t.actions?this.actionbar.updateLayoutSize(t.actions):this.actionbar.updateLayoutSize(),this.actionbar.updateLayoutSort()),i.keepSort&&0!==this.scrubber.getPosition()?this.scroll_id&&this.scrollToObject(this.scroll_id):this.scrubber.setPosition(0)}return this},h.prototype.updateScrubberOptions=function(t){return void 0===t&&(t={}),this.scrubber.updateOptions(t),this},h.prototype.updateOptions=function(t){return this.updateLayoutOptions(t),this},h.prototype.scrollToDate=function(t,e){var i=this.layout.getPositionAtDate(t,e),o=Math.min(1,Math.max(0,this.scrubber._getPercent(i)));this.scrubber.setPosition(o)},h.prototype.scrollToObject=function(t,e){var i;i=void 0===t?0:this.layout.getPositionAtObject(t,e);var o=Math.min(1,Math.max(0,this.scrubber._getPercent(i)));this.scrubber.setPosition(o)},h.prototype.getIdForScrolledObject=function(){var t=this.scrubber.getPosition();return this.layout.getObjectIdAtPosition(t)},h.prototype.updatePosition=function(t){void 0===t&&(t=this.scrubber.getPosition()),this.layout.render(0,t,this.getDimensions().width,this.getDimensions().height);var e=this.layout.getDateAtPosition(t,!0),i=this.layout.grouped[e],o=0,s=!1;i&&i.child&&i.child.summary&&(o=i.length?i.length:Object.keys(i).length,s=i.child.summary.isSelected()),this.actionbar.updateDateSummary(e,o,{selected:s})},h.prototype.getDateAtPosition=function(t,e){return void 0===e&&(e=!1),this.layout.getDateAtPosition(t,e)},h.prototype.getDimensions=function(){return(void 0===this._dimensions||this._dimensions.width<=0||this._dimensions.height<=0)&&(this._dimensions={width:this._layout_container.offsetWidth,height:this._layout_container.offsetHeight-this.actionbar.el.offsetHeight}),this._dimensions},h.prototype.hasObjects=function(t){return void 0===t&&(t={hidden:!1}),this.layout.hasObjects(t)},h.prototype.allObjects=function(t){return void 0===t&&(t={hidden:!1}),this.layout.allObjects(t)},h.prototype.getFirstObject=function(){return this.layout.getFirstObject()},h.prototype.getLastObject=function(){return this.layout.getLastObject()},h.prototype.getObjectCount=function(){return this.layout.getObjectCount()},h.prototype.setFirstImageLoaded=function(t){void 0===t&&(t=!0),this.firstImageLoaded=t},h.prototype.isFirstImageLoaded=function(){return this.firstImageLoaded},h.prototype.disableScroll=function(){this.updateScrubberOptions({disableScroll:!0})},h.prototype.enableScroll=function(){this.updateScrubberOptions({disableScroll:!1})},h.referenceObject=function(t){return s(t.toLowerCase())},h}),e(["application"],function(t){"function"==typeof window.define&&window.define.amd?window.define("PMCHeimdall",[],function(){return t}):window.PMCHeimdall=t}),"undefined"!=typeof _&&_.noConflict(),i("export",function(){})}();